<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Portefeuille</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
    <link rel="icon" type="image/png" href="./media/icon.png">
</head>
<body>
    <header>
        <a href="start.html" class="logo-title-link">
            <img src="./media/logo-black.png" alt="Logo QualityInvest">
            <h1>QualityInvest</h1>
        </a>
        <div class="onglets">
            <a href="wallet.html">Portefeuille</a>
            <a href="strategy.html">Strat√©gie</a>
            <a href="selection.html">S√©lection</a>
        </div>
    </header>

    <h2 class="semititle">Portefeuille √† Dividende Quality üíé by QualityInvest</h2> <br>

    <table class="wallet-intro">
        <tr>
            <td>Investis</td>
            <td id="invested"></td>
            <td>Cash disponible</td>
            <td id="cash"></td>
            <td>Gain Total en ‚Ç¨</td>
            <td id="return-euro"></td>
        </tr>
        <tr>
            <td>Valeur Portefeuille</td>
            <td id="wallet-value"></td>
            <td>Valeur Totale</td>
            <td id="total-value"></td>
            <td>Gain Total en %</td>
            <td id="return-percent"></td>
        </tr>
    </table>

    <div class="donut-container">
        <canvas id="firstChart"></canvas>
        <canvas id="secondChart"></canvas>
    </div>


    <table class="stocks-header">
        <tr>
            <th>Logo</th>
            <th>Ticker</th>
            <th>Positions</th>
            <th>PRU</th>
            <th>Prix</th>
            <th>Valeur</th>
            <th>Retour en ‚Ç¨</th>
            <th>Retour en %</th>
        </tr>
    </table>

    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/AAPL.png" alt="" class="stocks-pic"></td>
                <td id="ticker">AAPL</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse a ante quis ipsum ultricies dapibus. Duis quis orci eget est tristique dignissim at at magna. Quisque fermentum mauris sed purus gravida feugiat. Nunc dictum pretium eleifend. Pellentesque id diam a ligula interdum sodales at vitae arcu. Nulla nec accumsan est, at faucibus nulla. Fusce molestie diam in congue tincidunt. Aenean vestibulum, nunc id interdum fermentum, dolor urna viverra mauris, egestas scelerisque est sem quis erat. Pellentesque venenatis interdum leo. Aliquam rhoncus rutrum augue accumsan hendrerit. Maecenas quis diam felis. Mauris augue dolor, fermentum molestie blandit eu, eleifend non sapien. Curabitur tempus tincidunt fringilla. Donec metus velit, facilisis ut viverra vitae, tincidunt non ipsum. Fusce fringilla mollis commodo. Ut quam dui, volutpat vel dui sed, varius ornare mi.

            Praesent dignissim aliquet metus a facilisis. Donec nec tellus neque. Nullam ac aliquam leo. Duis ac elementum libero, sit amet dignissim ipsum. Proin tristique tincidunt aliquam. Proin congue, erat a accumsan bibendum, nunc metus condimentum ligula, tempus vestibulum ligula purus sed orci. Maecenas bibendum quam eu metus iaculis placerat. Integer tincidunt urna sit amet pellentesque fermentum. Pellentesque ut lectus cursus, ultricies odio eget, ultrices massa.
            
            Integer scelerisque porta leo. Vivamus ac imperdiet risus, non vestibulum ligula. Proin est lectus, tincidunt at bibendum porttitor, mollis a felis. Maecenas ac nisl et justo placerat placerat a non orci. Nam volutpat pellentesque tellus, sed pretium odio tristique sit amet. Sed tempor sapien arcu, ornare rhoncus nibh accumsan nec. Integer euismod, ipsum ac viverra maximus, ipsum diam commodo arcu, ut dictum sem nulla ac magna. Nunc maximus, tellus eget consectetur eleifend, neque massa dignissim massa, non interdum ligula lorem nec lectus. Quisque tincidunt quam lacinia diam accumsan cursus.
            </p>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/MA.png" alt="" class="stocks-pic"></td>
                <td id="ticker">MA</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse a ante quis ipsum ultricies dapibus. Duis quis orci eget est tristique dignissim at at magna. Quisque fermentum mauris sed purus gravida feugiat. Nunc dictum pretium eleifend. Pellentesque id diam a ligula interdum sodales at vitae arcu. Nulla nec accumsan est, at faucibus nulla. Fusce molestie diam in congue tincidunt. Aenean vestibulum, nunc id interdum fermentum, dolor urna viverra mauris, egestas scelerisque est sem quis erat. Pellentesque venenatis interdum leo. Aliquam rhoncus rutrum augue accumsan hendrerit. Maecenas quis diam felis. Mauris augue dolor, fermentum molestie blandit eu, eleifend non sapien. Curabitur tempus tincidunt fringilla. Donec metus velit, facilisis ut viverra vitae, tincidunt non ipsum. Fusce fringilla mollis commodo. Ut quam dui, volutpat vel dui sed, varius ornare mi.

            Praesent dignissim aliquet metus a facilisis. Donec nec tellus neque. Nullam ac aliquam leo. Duis ac elementum libero, sit amet dignissim ipsum. Proin tristique tincidunt aliquam. Proin congue, erat a accumsan bibendum, nunc metus condimentum ligula, tempus vestibulum ligula purus sed orci. Maecenas bibendum quam eu metus iaculis placerat. Integer tincidunt urna sit amet pellentesque fermentum. Pellentesque ut lectus cursus, ultricies odio eget, ultrices massa.
            
            Integer scelerisque porta leo. Vivamus ac imperdiet risus, non vestibulum ligula. Proin est lectus, tincidunt at bibendum porttitor, mollis a felis. Maecenas ac nisl et justo placerat placerat a non orci. Nam volutpat pellentesque tellus, sed pretium odio tristique sit amet. Sed tempor sapien arcu, ornare rhoncus nibh accumsan nec. Integer euismod, ipsum ac viverra maximus, ipsum diam commodo arcu, ut dictum sem nulla ac magna. Nunc maximus, tellus eget consectetur eleifend, neque massa dignissim massa, non interdum ligula lorem nec lectus. Quisque tincidunt quam lacinia diam accumsan cursus.
            </p>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/MSFT.png" alt="" class="stocks-pic"></td>
                <td id="ticker">MSFT</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse a ante quis ipsum ultricies dapibus. Duis quis orci eget est tristique dignissim at at magna. Quisque fermentum mauris sed purus gravida feugiat. Nunc dictum pretium eleifend. Pellentesque id diam a ligula interdum sodales at vitae arcu. Nulla nec accumsan est, at faucibus nulla. Fusce molestie diam in congue tincidunt. Aenean vestibulum, nunc id interdum fermentum, dolor urna viverra mauris, egestas scelerisque est sem quis erat. Pellentesque venenatis interdum leo. Aliquam rhoncus rutrum augue accumsan hendrerit. Maecenas quis diam felis. Mauris augue dolor, fermentum molestie blandit eu, eleifend non sapien. Curabitur tempus tincidunt fringilla. Donec metus velit, facilisis ut viverra vitae, tincidunt non ipsum. Fusce fringilla mollis commodo. Ut quam dui, volutpat vel dui sed, varius ornare mi.

            Praesent dignissim aliquet metus a facilisis. Donec nec tellus neque. Nullam ac aliquam leo. Duis ac elementum libero, sit amet dignissim ipsum. Proin tristique tincidunt aliquam. Proin congue, erat a accumsan bibendum, nunc metus condimentum ligula, tempus vestibulum ligula purus sed orci. Maecenas bibendum quam eu metus iaculis placerat. Integer tincidunt urna sit amet pellentesque fermentum. Pellentesque ut lectus cursus, ultricies odio eget, ultrices massa.
            
            Integer scelerisque porta leo. Vivamus ac imperdiet risus, non vestibulum ligula. Proin est lectus, tincidunt at bibendum porttitor, mollis a felis. Maecenas ac nisl et justo placerat placerat a non orci. Nam volutpat pellentesque tellus, sed pretium odio tristique sit amet. Sed tempor sapien arcu, ornare rhoncus nibh accumsan nec. Integer euismod, ipsum ac viverra maximus, ipsum diam commodo arcu, ut dictum sem nulla ac magna. Nunc maximus, tellus eget consectetur eleifend, neque massa dignissim massa, non interdum ligula lorem nec lectus. Quisque tincidunt quam lacinia diam accumsan cursus.
            </p>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/V.png" alt="" class="stocks-pic"></td>
                <td id="ticker">V</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse a ante quis ipsum ultricies dapibus. Duis quis orci eget est tristique dignissim at at magna. Quisque fermentum mauris sed purus gravida feugiat. Nunc dictum pretium eleifend. Pellentesque id diam a ligula interdum sodales at vitae arcu. Nulla nec accumsan est, at faucibus nulla. Fusce molestie diam in congue tincidunt. Aenean vestibulum, nunc id interdum fermentum, dolor urna viverra mauris, egestas scelerisque est sem quis erat. Pellentesque venenatis interdum leo. Aliquam rhoncus rutrum augue accumsan hendrerit. Maecenas quis diam felis. Mauris augue dolor, fermentum molestie blandit eu, eleifend non sapien. Curabitur tempus tincidunt fringilla. Donec metus velit, facilisis ut viverra vitae, tincidunt non ipsum. Fusce fringilla mollis commodo. Ut quam dui, volutpat vel dui sed, varius ornare mi.

            Praesent dignissim aliquet metus a facilisis. Donec nec tellus neque. Nullam ac aliquam leo. Duis ac elementum libero, sit amet dignissim ipsum. Proin tristique tincidunt aliquam. Proin congue, erat a accumsan bibendum, nunc metus condimentum ligula, tempus vestibulum ligula purus sed orci. Maecenas bibendum quam eu metus iaculis placerat. Integer tincidunt urna sit amet pellentesque fermentum. Pellentesque ut lectus cursus, ultricies odio eget, ultrices massa.
            
            Integer scelerisque porta leo. Vivamus ac imperdiet risus, non vestibulum ligula. Proin est lectus, tincidunt at bibendum porttitor, mollis a felis. Maecenas ac nisl et justo placerat placerat a non orci. Nam volutpat pellentesque tellus, sed pretium odio tristique sit amet. Sed tempor sapien arcu, ornare rhoncus nibh accumsan nec. Integer euismod, ipsum ac viverra maximus, ipsum diam commodo arcu, ut dictum sem nulla ac magna. Nunc maximus, tellus eget consectetur eleifend, neque massa dignissim massa, non interdum ligula lorem nec lectus. Quisque tincidunt quam lacinia diam accumsan cursus.
            </p>
    </div>
    <div class="bar-container">
        <canvas id="thirdChart"></canvas>
        <canvas id="fourthChart"></canvas>
    </div>

    <div class="footer">
        <div class="copyright">
            <img src="./media/logo-black.png" alt="Logo QualityInvest">
            <span id="copyright">QualityInvest &copy; 2024</span>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>





//G√âRER L'ACCORD√âON
var accordions = document.getElementsByClassName("accordion");

for (var i = 0; i < accordions.length; i++) {
    accordions[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    });
}

//CHANGER COULEUR BACKGROUND SI POSITIF/N√âGATIF
function changeBackgroundColor(diffEuro,diffPercent){
    const returnEuroCell = document.getElementById('return-euro');
    const returnPercentCell = document.getElementById('return-percent');

    diffEuro = parseFloat(diffEuro);
    diffPercent = parseFloat(diffPercent);

    if (diffEuro > 0){
        returnEuroCell.style.backgroundColor = 'lightgreen';
    } 
    else if (value < 0) {
        returnEuroCell.style.backgroundColor = 'lightcoral';
    }
    else {
        returnEuroCell.style.backgroundColor = '';
    }

    if (diffPercent > 0){
        returnPercentCell.style.backgroundColor = 'lightgreen';
    } 
    else if (value < 0) {
        returnPercentCell.style.backgroundColor = 'lightcoral';
    }
    else {
        returnPercentCell.style.backgroundColor = '';
    }
}

//TOUTES LES VARIABLES UTILIS√âES
var totalInvested = 5600; // montant total investi
var totalInvestedCell = document.getElementById("invested");
totalInvestedCell.textContent = totalInvested;

var CashOnHand = 222.09; // cash disponible
var cashCell = document.getElementById("cash");
cashCell.textContent = CashOnHand.toFixed(2);

var tickerOfShares = ["AAPL", "MA", "MSFT", "V"]; // tickers
var numberOfShares = [9, 4, 5, 5]; // nombres d'actions
var pruOfShares = [176.6352, 411.6737, 321.36, 229.595]; // PRU des 4 actions


var stocksPrice = []; // prix actuels des 4 actions, en $
let totalPRU = 0;
const valueOfStocks = []; // liste pour stocker les valeurs des actions, en $
let totalValue = 0; // valeur actuelle du portefeuille, en $

var finalValueOfStocks = []; // liste pour stocker les valeurs des actions, en ‚Ç¨
var finalValue = 0; // valeur actuelle du portefeuille, en ‚Ç¨

var diffList = [];
var diffPercentList = [];

var totalGain = 0;


//FONCTIONS 

//Obtenir le taux de change Dollar-Euro
const apiKeyCurrency = 'e5075f23dc192ea91c92c824';

async function getExchangeRate() {
    try {
        const response = await fetch(`https://api.exchangerate-api.com/v4/latest/USD`);
        const data = await response.json();
        
        if (data && data.rates && data.rates.EUR) {
            const exchangeRate = data.rates.EUR;
            return exchangeRate
        } else {
            console.log("Impossible de r√©cup√©rer le taux de change pour le moment.");
        }
    } catch (error) {
        console.error('Erreur lors de la r√©cup√©ration du taux de change :', error);
    }
}


/// Remplacez 'YOUR_API_KEY' par votre cl√© API Finnhub
const apiKey = 'cfeip41r01qoicaf4hk0cfeip41r01qoicaf4hkg';

// Fonction pour r√©cup√©rer le prix de l'action
async function getStockPrice(symbol, index) {
    try {
        const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`);
        const data = await response.json();

        // V√©rifier si les donn√©es ont √©t√© r√©cup√©r√©es avec succ√®s
        if (data.c) {
            const price = data.c;
            stocksPrice[index] = price; // Stocker le prix dans l'indice correspondant de stocksPrice
        } else {
            console.log(`Erreur: Impossible de r√©cup√©rer les donn√©es pour ${symbol}.`);
        }
    } catch (error) {
        console.log('Erreur:', error);
    }
}

// Obtenir le prix de toutes les actions
async function getAllStockPrices() {
    for (let i = 0; i < tickerOfShares.length; i++) {
        await getStockPrice(tickerOfShares[i], i);
    }

    // Appel de la fonction pour calculer le co√ªt total de chaque action
    calculateTotalCostOfShares();
}

// Fonction pour calculer le co√ªt total de chaque action
function calculateTotalCostOfShares() {
    totalValue = 0; // R√©initialiser la valeur totale du portefeuille
    totalPRU = 0; // R√©initialiser le PRU total
    valueOfStocks.length = 0; // R√©initialiser la liste de valeurs

    for (let i = 0; i < numberOfShares.length; i++) {
        const totalCost = numberOfShares[i] * stocksPrice[i]; // Multiplication
        totalValue += totalCost; // Accumuler la valeur totale du portefeuille
        totalPRU += Number((pruOfShares[i] * numberOfShares[i]).toFixed(2)); // Accumuler le PRU total
        
        // Ajouter la valeur totale de chaque action au tableau valueOfStocks
        valueOfStocks.push(totalCost);
    }
}

// Fonction pour calculer la performance en euro et % de chaque action
function calculatePerformanceForAllStocks(currentPrices, pruList, numberOfSharesList) {
    for (let i = 0; i < pruList.length; i++) {
        const currentPrice = currentPrices[i];
        const pru = pruList[i];
        const numberOfShares = numberOfSharesList[i];
        const diffEuro = ((currentPrice - pru) * numberOfShares).toFixed(2);
        const diffPercent = (((currentPrice - pru) / pru) * 100).toFixed(2);
        diffList.push(Number(diffEuro));
        diffPercentList.push(Number(diffPercent));
    }
    return {
        diffList: diffList,
        diffPercentList: diffPercentList
    };
}

// Fonction pour remplir le tableau des prix actuels des actions
function fillStockPrices() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#price');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = stocksPrice[index];
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau des PRU
function fillAveragePrices() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#average-price');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (pruOfShares[index]).toFixed(2);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau des nombres de positions par action
function fillNumberOfShares() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#shares');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (numberOfShares[index]);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau de la valeur totale par action
function fillValueOfStocks(stockPrices,exchangeRate) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#value');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        console.log(index,valueOfStocks[index])
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            toAdd = Number((valueOfStocks[index] * exchangeRate).toFixed(2));
            cell.textContent = toAdd;
            finalValueOfStocks.push(toAdd);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau du retour sur investissement en euro par action
function fillReturnInEuros(diffListEuro) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#perf-euro');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = diffListEuro[index];
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau du retour sur investissement en % par action
function fillReturnInPercent(diffListEuro) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#perf-percent');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = diffPercentList[index];
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// GRAPHIQUES
// Donn√©es pour le premier graphique
function drawFirst(CashOnHand,finalValue) {
    var ctx = document.getElementById('firstChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Cash Dispo', 'Placements'],
            datasets: [{
                data: [CashOnHand, finalValue],
                backgroundColor: [
                    'rgba(128, 0, 128, 0.5)', // Couleur pour Cash On Hand
                    'rgba(54, 162, 235, 0.5)'  // Couleur pour Final Value
                ],
                borderColor: [
                    'rgba(128, 0, 128, 1)', // Couleur de bordure pour Cash On Hand
                    'rgba(54, 162, 235, 1)'  // Couleur de bordure pour Final Value
                ],
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                title : {
                    display:true,
                    text:'Cash Disponible VS Placements en Actions',
                    position : 'bottom'
                }
            }
        }
    });
}
function drawSecond(totalInvested,diffEuro) {
    var ctx = document.getElementById('secondChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Argent Investi', 'Gain Total'],
            datasets: [{
                data: [totalInvested, diffEuro],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.5)', // Couleur pour totalInvested
                    'rgba(75, 192, 192, 0.5)'  // Couleur pour Gain
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)', // Couleur de bordure pour totalInvested
                    'rgba(75, 192, 192, 1)'  // Couleur de bordure pour Gain
                ],
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                title : {
                    display:true,
                    text:'Source de la valeur actuelle du Portefeuille',
                    position : 'bottom'
                }
            }
        }
    });
}

function drawThird(finalValueOfStocks) {
    var ctx = document.getElementById('thirdChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [{
                data: finalValueOfStocks,
                backgroundColor: [
                    'rgba(54, 162, 235, 0.5)', // Bleu pour la premi√®re valeur de stocks
                    'rgba(75, 192, 192, 0.5)', // Vert pour le premier gain
                    'rgba(255, 99, 132, 0.5)', // Rouge pour la deuxi√®me valeur de stocks
                    'rgba(255, 205, 86, 0.5)'  // Jaune pour le deuxi√®me gain
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                    'rgba(75, 192, 192, 1)', // Bordure verte pour le premier gain
                    'rgba(255, 99, 132, 1)', // Bordure rouge pour la deuxi√®me valeur de stocks
                    'rgba(255, 205, 86, 1)'  // Bordure jaune pour le deuxi√®me gain
                ],
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                title : {
                    display:true,
                    text:'Valeur Totale par Actions',
                    position : 'bottom'
                }
            }
        }
    });
}


function drawFourth(diffListEuro) {
    var ctx = document.getElementById('fourthChart').getContext('2d');

    var backgroundColors = [];
    var borderColors = [];

    for (var i = 0; i < diffListEuro.length; i++) {
        if (diffListEuro[i] >= 0) {
            // Si la valeur est positive, utiliser la couleur verte
            backgroundColors.push('rgba(75, 192, 192, 0.5)'); // Vert
            borderColors.push('rgba(75, 192, 192, 1)'); // Bordure verte
        } else {
            // Si la valeur est n√©gative, utiliser la couleur rouge
            backgroundColors.push('rgba(255, 99, 132, 0.5)'); // Rouge
            borderColors.push('rgba(255, 99, 132, 1)'); // Bordure rouge
        }
    }

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares, // Assurez-vous que tickerOfShares est d√©fini quelque part
            datasets: [{
                data: diffListEuro,
                backgroundColor: backgroundColors,
                borderColor: borderColors,
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                title : {
                    display:true,
                    text:'Retour sur Investissement par Actions',
                    position : 'bottom'
                }
            }
        }
    });
}

// Appel de la fonction pour r√©cup√©rer les prix de toutes les actions
async function main() {
    await getAllStockPrices();
    const exchangeRate = await getExchangeRate();

    finalValue = totalValue * exchangeRate;
    document.getElementById("wallet-value").textContent = finalValue.toFixed(2);

    totalWallet = finalValue + CashOnHand;
    document.getElementById("total-value").textContent = totalWallet.toFixed(2);

    diffEuro = totalWallet - totalInvested;
    document.getElementById("return-euro").textContent = diffEuro.toFixed(2);

    diffPercent = (diffEuro / totalInvested) * 100;
    document.getElementById("return-percent").textContent = diffPercent.toFixed(2);

    diffPerformance = calculatePerformanceForAllStocks(stocksPrice, pruOfShares, numberOfShares);

    const diffListEuro = diffPerformance.diffList.map(diff => Number((diff * exchangeRate).toFixed(2)));

    //CHANGER COULEURS
    changeBackgroundColor(diffEuro,diffPercent);

    //REMPLIR TABLEAUX
    fillStockPrices();

    fillAveragePrices();

    fillNumberOfShares();

    fillValueOfStocks(stocksPrice,exchangeRate);

    fillReturnInEuros(diffListEuro);

    fillReturnInPercent(diffPercentList);

    console.log(diffListEuro);


    //DESSINER GRAPHES
    drawFirst(CashOnHand,finalValue);
    drawSecond(totalInvested,diffEuro);
    drawThird(finalValueOfStocks);
    drawFourth(diffListEuro);

}

main();

    </script>
</body>
</html>