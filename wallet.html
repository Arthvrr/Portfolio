<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Portefeuille</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="./media/icon.png">
</head>
<body>
    <header>
        <a href="start.html" class="logo-title-link">
            <img src="./media/logo-black.png" alt="Logo QualityInvest">
            <h1>QualityInvest</h1>
        </a>
        <div class="onglets">
            <a href="wallet.html">Portefeuille</a>
            <a href="strategy.html">Strat√©gie</a>
            <a href="selection.html">S√©lection</a>
        </div>
    </header>

    <h2 class="semititle">Portefeuille √† Dividende Quality üíé by QualityInvest</h2>

    <div class="link-page">
        <h3><a href="#intro">Performance Globale</a></h3>
        <h3><a href="#stocks-detail">D√©tails du Portefeuille</a></h3>
        <h3><a href="#dividend">Dividendes</a></h3>
        <h3><a href="#annual-perf">Retours Annuels</a></h3>
    </div>

    <table class="wallet-intro" id="intro">
        <tr>
            <td>Investis</td>
            <td id="invested"></td>
            <td>Cash disponible</td>
            <td id="cash"></td>
            <td>Gain Total en ‚Ç¨</td>
            <td id="return-euro"></td>
        </tr>
        <tr>
            <td>Valeur Portefeuille</td>
            <td id="wallet-value"></td>
            <td>Valeur Totale</td>
            <td id="total-value"></td>
            <td>Gain Total en %</td>
            <td id="return-percent"></td>
        </tr>
    </table>

    <div class="donut-container">
        <canvas id="firstChart"></canvas>
        <canvas id="secondChart"></canvas>
    </div>


    <table class="stocks-header" id="stocks-detail">
        <tr>
            <th>Logo</th>
            <th>Ticker</th>
            <th>Positions</th>
            <th>PRU</th>
            <th>Prix</th>
            <th>Valeur</th>
            <th>Retour ‚Ç¨</th>
            <th>Retour %</th>
        </tr>
    </table>

    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/AAPL.png" alt="" class="stocks-pic"></td>
                <td id="ticker">AAPL</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Fond√©e en 1976 par Steve Jobs, Steve Wozniak et Ronald Wayne, Apple Inc. est une multinationale am√©ricaine dont le si√®ge social se trouve √† Cupertino, en Californie. Apple est r√©put√©e pour ses innovations dans le domaine de la technologie grand public, notamment ses produits embl√©matiques tels que l'iPhone, l'iPad, le Mac et l'Apple Watch. L'entreprise con√ßoit, fabrique et commercialise √©galement des logiciels comme iOS, macOS, watchOS et tvOS, ainsi que des services tels que l'iTunes Store, l'App Store, Apple Music et iCloud. Gr√¢ce √† son approche ax√©e sur le design, l'innovation et l'int√©gration verticale, Apple a acquis une base de clients fid√®les √† travers le monde et reste l'une des entreprises les plus valoris√©es au monde. <br><br>
            L'avantage comp√©titif principal d'Apple r√©side dans son √©cosyst√®me int√©gr√© de produits, logiciels et services. L'entreprise b√©n√©ficie d'une base de clients tr√®s fid√®les, attir√©s par le design innovant, la qualit√© des produits et l'exp√©rience utilisateur coh√©rente offerts par les produits Apple. De plus, Apple dispose d'une forte capacit√© √† g√©n√©rer des revenus r√©currents gr√¢ce √† ses services tels que l'App Store, Apple Music et iCloud. Cette combinaison d'innovation, de fid√©lit√© √† la marque et de revenus r√©currents cr√©e un moat √©conomique significatif pour Apple.</p>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/MA.png" alt="" class="stocks-pic"></td>
                <td id="ticker">MA</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Fond√©e en 1966 sous le nom de Interbank Card Association, Mastercard est une entreprise am√©ricaine sp√©cialis√©e dans les services financiers, en particulier dans les syst√®mes de paiement √©lectronique. Mastercard fournit des solutions de paiement, y compris des cartes de cr√©dit, de d√©bit et pr√©pay√©es, ainsi que des services de traitement des transactions pour les institutions financi√®res, les commer√ßants et les consommateurs √† travers le monde. En tant que r√©seau de paiement mondial, Mastercard facilite les transactions financi√®res s√©curis√©es dans plus de 210 pays et territoires, offrant une connectivit√© entre les banques √©mettrices et les commer√ßants. <br><br>
            En tant que l'un des principaux r√©seaux de paiement au monde, Mastercard b√©n√©ficie d'un avantage comp√©titif consid√©rable gr√¢ce √† son r√©seau mondial √©tendu et √† sa marque bien √©tablie. La soci√©t√© est largement accept√©e par les commer√ßants et les institutions financi√®res √† travers le monde, ce qui lui conf√®re une position dominante dans l'industrie des paiements √©lectroniques. De plus, Mastercard investit continuellement dans l'innovation technologique pour am√©liorer la s√©curit√© et l'efficacit√© des transactions, renfor√ßant ainsi son moat √©conomique.</p>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/MSFT.png" alt="" class="stocks-pic"></td>
                <td id="ticker">MSFT</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Fond√©e en 1975 par Bill Gates et Paul Allen, Microsoft Corporation est une multinationale am√©ricaine dont le si√®ge social est situ√© √† Redmond, dans l'√âtat de Washington. Microsoft est un leader mondial dans le d√©veloppement de logiciels, de mat√©riels et de services informatiques. La soci√©t√© est surtout connue pour son syst√®me d'exploitation Windows, sa suite bureautique Microsoft Office, la console de jeu Xbox, ainsi que pour ses services cloud tels que Microsoft Azure. Avec une pr√©sence dans de nombreux secteurs de l'industrie technologique, Microsoft s'efforce de cr√©er des produits et des solutions innovants qui am√©liorent la productivit√© des entreprises et la vie quotidienne des consommateurs. <br><br>
            Microsoft b√©n√©ficie d'un avantage comp√©titif durable dans plusieurs domaines cl√©s. Tout d'abord, sa position dominante dans les syst√®mes d'exploitation avec Windows et dans les suites logicielles avec Microsoft Office lui conf√®re une part de march√© consid√©rable et des flux de revenus r√©currents. De plus, Microsoft est un leader dans le domaine du cloud computing avec sa plateforme Azure, b√©n√©ficiant ainsi de la croissance rapide du cloud. Son √©cosyst√®me int√©gr√© de produits, de services et de plateformes offre √©galement des opportunit√©s d'expansion et de synergie, renfor√ßant ainsi son moat √©conomique. </p>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Logo/V.png" alt="" class="stocks-pic"></td>
                <td id="ticker">V</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <p>Fond√©e en 1958 sous le nom de BankAmericard, Visa Inc. est une entreprise am√©ricaine sp√©cialis√©e dans les services de paiement √©lectronique. Visa propose une gamme de produits et services de paiement, y compris des cartes de cr√©dit, de d√©bit et pr√©pay√©es, ainsi que des solutions de paiement √©lectronique pour les particuliers, les commer√ßants et les institutions financi√®res dans le monde entier. La soci√©t√© facilite les transactions financi√®res s√©curis√©es √† l'√©chelle mondiale gr√¢ce √† son r√©seau de traitement des paiements, qui relie les √©metteurs de cartes, les acqu√©reurs de transactions, les commer√ßants et les consommateurs. En tant que leader mondial des paiements √©lectroniques, Visa joue un r√¥le crucial dans l'√©conomie mondiale en facilitant le commerce et les √©changes financiers. <br><br>
            Visa poss√®de l'un des r√©seaux de paiement les plus √©tendus au monde, ce qui constitue son principal avantage comp√©titif. La marque Visa est largement reconnue et accept√©e par les commer√ßants et les consommateurs √† travers le monde, ce qui lui conf√®re une position dominante dans l'industrie des paiements √©lectroniques. De plus, Visa investit dans l'innovation technologique pour am√©liorer la s√©curit√©, la commodit√© et l'efficacit√© des transactions, renfor√ßant ainsi son moat √©conomique. </p>
    </div>
    <div class="bar-container">
        <canvas id="thirdChart"></canvas>
        <canvas id="fourthChart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="eighthChart"></canvas>
    </div>
    <div class="big-chart-container" id="dividend">
        <canvas id="seventhChart"></canvas>
    </div>
    <div class="bar-container">
        <canvas id="sixthChart"></canvas>
        <canvas id="fifthChart"></canvas>
    </div>

    <div class="big-chart-container" id="annual-perf">
        <canvas id="ninethChart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="tenthChart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="eleventhChart"></canvas>
    </div>

    <div class="footer">
        <div class="copyright">
            <img src="./media/logo-black.png" alt="Logo QualityInvest">
            <span id="copyright">QualityInvest &copy; 2024</span>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>


//TRANSITION FLUIDE POUR ALLER √Ä ENDROITS DE LA PAGE
document.querySelectorAll('.link-page a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});

//G√âRER L'ACCORD√âON
var accordions = document.getElementsByClassName("accordion");
for (var i = 0; i < accordions.length; i++) {
    accordions[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    });
}

//CHANGER COULEUR BACKGROUND SI POSITIF/N√âGATIF
function changeBackgroundColor(diffEuro,diffPercent){
    const returnEuroCell = document.getElementById('return-euro');
    const returnPercentCell = document.getElementById('return-percent');

    diffEuro = parseFloat(diffEuro);
    diffPercent = parseFloat(diffPercent);

    if (diffEuro > 0){
        returnEuroCell.style.backgroundColor = 'lightgreen';
    } 
    else if (value < 0) {
        returnEuroCell.style.backgroundColor = 'lightcoral';
    }
    else {
        returnEuroCell.style.backgroundColor = '';
    }

    if (diffPercent > 0){
        returnPercentCell.style.backgroundColor = 'lightgreen';
    } 
    else if (value < 0) {
        returnPercentCell.style.backgroundColor = 'lightcoral';
    }
    else {
        returnPercentCell.style.backgroundColor = '';
    }
}


//TOUTES LES VARIABLES UTILIS√âES
var totalInvested = 5600; // montant total investi
var totalInvestedCell = document.getElementById("invested");
totalInvestedCell.textContent = totalInvested;

var CashOnHand = 222.09; // cash disponible
var cashCell = document.getElementById("cash");
cashCell.textContent = CashOnHand.toFixed(2);

var tickerOfShares = ["AAPL", "MA", "MSFT", "V"]; // tickers
var numberOfShares = [9, 4, 5, 5]; // nombres d'actions
var pruOfShares = [176.6352, 411.6737, 321.36, 229.595]; // PRU des 4 actions


var stocksPrice = []; // prix actuels des 4 actions, en $
let totalPRU = 0;
const valueOfStocks = []; // liste pour stocker les valeurs des actions, en $
let totalValue = 0; // valeur actuelle du portefeuille, en $

var finalValueOfStocks = []; // liste pour stocker les valeurs des actions, en ‚Ç¨
var finalValue = 0; // valeur actuelle du portefeuille, en ‚Ç¨

var diffList = [];
var diffPercentList = [];

var dividendPerShares = [0.96,2.64,3.00,2.08]; // liste pour stocker les dividendes vers√©s par actions

var totalDividendPerShares = [];

var yieldOfShares = [];

var years = [2022,2023]; // liste des ann√©es, pour les graphes de retours annuels et invested vs wallet value

var months = ['Janvier','F√©vrier','Mars','Avril','Mai','Juin','Juillet','Ao√ªt','Septembre','Octobre','Novembre','D√©cembre'];

var dividendPerMonth = [];

var annualReturnEuro = [0,442.03]; // liste des retours annuels, en euro

var annualReturnPercent = [0,8.26]; //liste des retours annuels, en pourcent

var annualDividendReceived = [12.35, 41.31]; //liste des dividendes annuels nets re√ßus

var annualInvested = [0,5350]; //liste qui stocke le nombres d'euros investi par an

var walletEndYear = [0,5792.03] //liste qui stocke la valeur du portefeuille √† la fin de chaque ann√©e



//FONCTIONS 

//Obtenir le taux de change Dollar-Euro
const apiKeyCurrency = 'e5075f23dc192ea91c92c824';

async function getExchangeRate() {
    try {
        const response = await fetch(`https://api.exchangerate-api.com/v4/latest/USD`);
        const data = await response.json();
        
        if (data && data.rates && data.rates.EUR) {
            const exchangeRate = data.rates.EUR;
            return exchangeRate
        } else {
            console.log("Impossible de r√©cup√©rer le taux de change pour le moment.");
        }
    } catch (error) {
        console.error('Erreur lors de la r√©cup√©ration du taux de change :', error);
    }
}


/// Remplacez 'YOUR_API_KEY' par votre cl√© API Finnhub
const apiKey = 'cfeip41r01qoicaf4hk0cfeip41r01qoicaf4hkg';

// Fonction pour r√©cup√©rer le prix de l'action
async function getStockPrice(symbol, index) {
    try {
        const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`);
        const data = await response.json();

        // V√©rifier si les donn√©es ont √©t√© r√©cup√©r√©es avec succ√®s
        if (data.c) {
            const price = data.c;
            stocksPrice[index] = price; // Stocker le prix dans l'indice correspondant de stocksPrice
        } else {
            console.log(`Erreur: Impossible de r√©cup√©rer les donn√©es pour ${symbol}.`);
        }
    } catch (error) {
        console.log('Erreur:', error);
    }
}

// Obtenir le prix de toutes les actions
async function getAllStockPrices() {
    for (let i = 0; i < tickerOfShares.length; i++) {
        await getStockPrice(tickerOfShares[i], i);
    }

    // Appel de la fonction pour calculer le co√ªt total de chaque action
    calculateTotalCostOfShares();
}

// Fonction pour calculer le co√ªt total de chaque action
function calculateTotalCostOfShares() {
    totalValue = 0; // R√©initialiser la valeur totale du portefeuille
    totalPRU = 0; // R√©initialiser le PRU total
    valueOfStocks.length = 0; // R√©initialiser la liste de valeurs

    for (let i = 0; i < numberOfShares.length; i++) {
        const totalCost = numberOfShares[i] * stocksPrice[i]; // Multiplication
        totalValue += totalCost; // Accumuler la valeur totale du portefeuille
        totalPRU += Number((pruOfShares[i] * numberOfShares[i]).toFixed(2)); // Accumuler le PRU total
        
        // Ajouter la valeur totale de chaque action au tableau valueOfStocks
        valueOfStocks.push(totalCost);
    }
}

// Fonction pour calculer la performance en euro et % de chaque action
function calculatePerformanceForAllStocks(currentPrices, pruList, numberOfSharesList) {
    for (let i = 0; i < pruList.length; i++) {
        const currentPrice = currentPrices[i];
        const pru = pruList[i];
        const numberOfShares = numberOfSharesList[i];
        const diffEuro = ((currentPrice - pru) * numberOfShares).toFixed(2);
        const diffPercent = (((currentPrice - pru) / pru) * 100).toFixed(2);
        diffList.push(Number(diffEuro));
        diffPercentList.push(Number(diffPercent));
    }
    return {
        diffList: diffList,
        diffPercentList: diffPercentList
    };
}


function calculateTotalDividendPerShare(exchangeRate) {
    totalDividendPerShares.length = 0; // R√©initialiser le tableau des totaux de dividendes par action
    
    for (let i = 0; i < numberOfShares.length; i++) {
        const totalDividend = Number(((numberOfShares[i] * dividendPerShares[i]) * exchangeRate).toFixed(2)); // Calculer le total des dividendes pour cette action
        totalDividendPerShares.push(totalDividend); // Ajouter le total des dividendes au tableau
    }
}

// Fonction pour calculer le rendement de chaque action
function calculateYieldOfShares() {
    yieldOfShares.length = 0; // R√©initialiser le tableau des rendements par action
    
    for (let i = 0; i < numberOfShares.length; i++) {
        const yield = Number((100 * (dividendPerShares[i] / stocksPrice[i])).toFixed(2)); // Calculer le rendement pour cette action
        yieldOfShares.push(yield); // Ajouter le rendement au tableau
    }
}

function calculateDividendPerMonth() {
    var monthAAPL = ["F√©vrier","Mai","Ao√ªt","Novembre"];
    var monthMA = ["F√©vrier","Mai","Ao√ªt","Novembre"];
    var monthMSFT = ["Mars","Juin","Septembre","D√©cembre"];
    var monthV = ["Mars","Juin","Septembre","D√©cembre"];

    for (let i = 0; i < months.length; i++) {
        var currentMonth = months[i];

        // Initialiser le dividende pour ce mois
        var monthlyDividend = 0;

        // V√©rifie pour chaque entreprise si le mois actuel correspond √† un mois de paiement de dividende
        if (monthAAPL.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[0] / 4;
        }
        if (monthMA.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[1] / 4;
        }
        if (monthMSFT.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[2] / 4;
        }
        if (monthV.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[3] / 4;
        }
        toAdd = Number(monthlyDividend.toFixed(2));
        // Stocker le dividende total pour ce mois
        dividendPerMonth.push(toAdd);
    }
}






// Fonction pour remplir le tableau des prix actuels des actions
function fillStockPrices() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#price');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = stocksPrice[index];
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau des PRU
function fillAveragePrices() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#average-price');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (pruOfShares[index]).toFixed(2);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau des nombres de positions par action
function fillNumberOfShares() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#shares');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (numberOfShares[index]);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau de la valeur totale par action
function fillValueOfStocks(stockPrices,exchangeRate) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#value');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            toAdd = Number((valueOfStocks[index] * exchangeRate).toFixed(2));
            cell.textContent = toAdd;
            finalValueOfStocks.push(toAdd);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau du retour sur investissement en euro par action
function fillReturnInEuros(diffListEuro) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#perf-euro');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = diffListEuro[index];
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau du retour sur investissement en % par action
function fillReturnInPercent(diffListEuro) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#perf-percent');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = diffPercentList[index];
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// GRAPHIQUES
// Donn√©es pour le premier graphique
function drawFirst(CashOnHand,finalValue) {
    var ctx = document.getElementById('firstChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Cash Dispo', 'Placements'],
            datasets: [{
                data: [CashOnHand, finalValue],
                backgroundColor: [
                    'rgba(128, 0, 128, 0.5)', // Couleur pour Cash On Hand
                    'rgba(54, 162, 235, 0.5)'  // Couleur pour Final Value
                ],
                borderColor: [
                    'rgba(128, 0, 128, 1)', // Couleur de bordure pour Cash On Hand
                    'rgba(54, 162, 235, 1)'  // Couleur de bordure pour Final Value
                ],
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                legend : {
                    display:true,
                    position:'bottom'
                },
                title : {
                    display:true,
                    text:'Cash Disponible VS Placements en Actions',
                    position : 'top'
                }
            }
        }
    });
}

function drawSecond(totalInvested,diffEuro) {
    var ctx = document.getElementById('secondChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Argent Investi', 'Gain Total'],
            datasets: [{
                data: [totalInvested, diffEuro],
                backgroundColor: [
                    'rgba(200, 200, 200, 0.5)', // Couleur pour totalInvested
                    'rgba(75, 192, 192, 0.5)'  // Couleur pour Gain
                ],
                borderColor: [
                    'rgba(200, 200, 200, 1)', // Couleur de bordure pour totalInvested
                    'rgba(75, 192, 192, 1)'  // Couleur de bordure pour Gain
                ],
                borderWidth: 1
            }]
        },
        options: {
            plugins: {
                legend : {
                    display:true,
                    position:'bottom'
                },
                title : {
                    display:true,
                    text:'Source de la valeur actuelle du Portefeuille',
                    position : 'top'
                }
            }
        }
    });
}

function drawThird(finalValueOfStocks) {
    var ctx = document.getElementById('thirdChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label:'Valeur par action en ‚Ç¨',
                data: finalValueOfStocks,
                backgroundColor: [
                    'rgba(54, 162, 235, 0.5)', // Bleu pour la premi√®re valeur de stocks
                    'rgba(128, 0, 128, 0.5)', // Violet pour le premier gain
                    'rgba(255, 143, 0, 0.5)', // Orange pour la deuxi√®me valeur de stocks
                    'rgba(255, 205, 86, 0.5)'  // Jaune pour le deuxi√®me gain
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                    'rgba(128, 0, 128, 1)', // Bordure violete pour le premier gain
                    'rgba(255, 143, 0, 1)', // Bordure orange pour la deuxi√®me valeur de stocks
                    'rgba(255, 205, 86, 1)'  // Bordure jaune pour le deuxi√®me gain
                ],
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Valeur Totale par Actions',
                    position : 'top'
                }
            }
        }
    });
}

function drawFourth(diffListEuro) {
    var ctx = document.getElementById('fourthChart').getContext('2d');

    var backgroundColors = [];
    var borderColors = [];

    for (var i = 0; i < diffListEuro.length; i++) {
        if (diffListEuro[i] >= 0) {
            // Si la valeur est positive, utiliser la couleur verte
            backgroundColors.push('rgba(75, 192, 192, 0.5)'); // Vert
            borderColors.push('rgba(75, 192, 192, 1)'); // Bordure verte
        } else {
            // Si la valeur est n√©gative, utiliser la couleur rouge
            backgroundColors.push('rgba(255, 99, 132, 0.5)'); // Rouge
            borderColors.push('rgba(255, 99, 132, 1)'); // Bordure rouge
        }
    }

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares, // Assurez-vous que tickerOfShares est d√©fini quelque part
            datasets: [{
                label:'Performance par action en ‚Ç¨',
                data: diffListEuro,
                backgroundColor: backgroundColors,
                borderColor: borderColors,
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Retour sur Investissement par Actions',
                    position : 'top'
                }
            }
        }
    });
}

function drawFifth(totalDividendPerShares) {
    var ctx = document.getElementById('fifthChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label:'Dividende par action',
                data: totalDividendPerShares,
                backgroundColor: [
                    'rgba(51, 70, 79,0.5)'
                ],
                borderColor: [
                    'rgba(51, 70, 79, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Dividendes re√ßus par Actions',
                    position : 'top'
                }
            }
        }
    });
}

function drawSixth(yieldOfShares) {
    var ctx = document.getElementById('sixthChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label:'Rendement du dividende en %',
                data: yieldOfShares,
                backgroundColor: [
                    'rgba(54, 162, 235, 0.5)', // Bleu pour la premi√®re valeur de stocks
                    'rgba(128, 0, 128, 0.5)', // Violet pour le premier gain
                    'rgba(255, 143, 0, 0.5)', // Orange pour la deuxi√®me valeur de stocks
                    'rgba(255, 205, 86, 0.5)'  // Jaune pour le deuxi√®me gain
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                    'rgba(128, 0, 128, 1)', // Bordure violete pour le premier gain
                    'rgba(255, 143, 0, 1)', // Bordure orange pour la deuxi√®me valeur de stocks
                    'rgba(255, 205, 86, 1)'  // Bordure jaune pour le deuxi√®me gain
                ],
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Rendement par Actions',
                    position : 'top'
                }
            }
        }
    });
}

function drawSeventh(dividendPerMonth) {
    var ctx = document.getElementById('seventhChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: months,
            datasets: [{
                label:'Dividende par mois',
                data: dividendPerMonth,
                backgroundColor: [
                    'rgba(0, 17, 255, 0.5)', // Bleu pour la premi√®re valeur de stocks
                ],
                borderColor: [
                    'rgba(0, 17, 255, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                ],
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Dividendes Mensuels',
                    position : 'top'
                }
            }
        }
    });
}

function drawEighth(stocksPrice) {
    var ctx = document.getElementById('eighthChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label : 'PRU',
                data: pruOfShares,
                backgroundColor: [
                    'rgba(214, 0, 0, 0.5)', // Bleu pour la premi√®re valeur de stocks
                ],
                borderColor: [
                    'rgba(214, 0, 0, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                ],
                borderWidth: 1
            },{
                label : 'Stocks Price',
                data: stocksPrice,
                backgroundColor: [
                    'rgba(0, 214, 207, 0.5)', // Violet pour la premi√®re valeur de stocks
                ],
                borderColor: [
                    'rgba(0, 214, 207, 1)', // Bordure violette pour la premi√®re valeur de stocks
                ],
                borderWidth: 1
            }
            
        ]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Prix des actions VS PRU',
                    position : 'top'
                }
            }
        }
    });
}

function drawNineth() {
    var ctx = document.getElementById('ninethChart').getContext('2d');

    // D√©finition des couleurs en fonction de la valeur
    var backgroundColors = annualReturnEuro.map(value => value >= 0 ? 'rgba(75, 192, 192, 0.5)' : 'rgba(255, 99, 132, 0.5)');
    var borderColors = annualReturnEuro.map(value => value >= 0 ? 'rgba(75, 192, 192, 1)' : 'rgba(255, 99, 132, 1)');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: years, // Utilisation de la liste "years" pour l'axe x
            datasets: [{
                label: 'Retour Annuels en ‚Ç¨',
                data: annualReturnEuro,
                backgroundColor: backgroundColors, // Utilisation des couleurs d√©finies
                borderColor: borderColors, // Utilisation des couleurs de bordure d√©finies
                borderWidth: 1
            },
            {
                label: 'Retour Annuels en %',
                data: annualReturnPercent,
                type: 'line', // Type de graphique en ligne pour les pourcentages
                fill: false, // Pas de remplissage sous la ligne
                borderColor: 'rgba(255, 99, 132, 1)', // Couleur de la ligne pour les pourcentages
                borderWidth: 2,
                yAxisID: 'y-axis-1' // Utilisation de l'axe y de droite pour les pourcentages
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: 'Retours Annuels en Euro et en Pourcentage', // Modification du titre du graphique
                    position: 'top'
                }
            }            
        }
    });
}

function drawTenth(annualInvested,walletEndYear) {
    var ctx = document.getElementById('tenthChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: years,
            datasets: [{
                label : 'Montant Investi',
                data: annualInvested,
                backgroundColor: [
                    'rgba(47, 0, 255, 0.5)', // Bleu pour la premi√®re valeur de stocks
                ],
                borderColor: [
                    'rgba(47, 0, 255, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                ],
                borderWidth: 1
            },{
                label : 'Value du Portefeuille',
                data: walletEndYear,
                backgroundColor: [
                    'rgba(0, 214, 207, 0.5)', // Violet pour la premi√®re valeur de stocks
                ],
                borderColor: [
                    'rgba(0, 214, 207, 1)', // Bordure violette pour la premi√®re valeur de stocks
                ],
                borderWidth: 1
            }
            
        ]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Montant Investi VS Valeur du Portefeuille par an',
                    position : 'top'
                }
            }
        }
    });
}

function drawEleventh(annualDividendReceived) {
    var ctx = document.getElementById('eleventhChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: years,
            datasets: [{
                label:'Dividende Nets re√ßus en ‚Ç¨',
                data: annualDividendReceived,
                backgroundColor: [
                    'rgba(0, 17, 255, 0.5)', // Bleu pour la premi√®re valeur de stocks
                ],
                borderColor: [
                    'rgba(0, 17, 255, 1)', // Bordure bleue pour la premi√®re valeur de stocks
                ],
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Dividendes Nets re√ßus par an',
                    position : 'top'
                }
            }
        }
    });
}




// Appel de la fonction pour r√©cup√©rer les prix de toutes les actions
async function main() {
    await getAllStockPrices();
    const exchangeRate = await getExchangeRate();

    finalValue = totalValue * exchangeRate;
    document.getElementById("wallet-value").textContent = finalValue.toFixed(2);

    totalWallet = finalValue + CashOnHand;
    document.getElementById("total-value").textContent = totalWallet.toFixed(2);

    diffEuro = totalWallet - totalInvested;
    document.getElementById("return-euro").textContent = diffEuro.toFixed(2);

    diffPercent = (diffEuro / totalInvested) * 100;
    document.getElementById("return-percent").textContent = diffPercent.toFixed(2);

    diffPerformance = calculatePerformanceForAllStocks(stocksPrice, pruOfShares, numberOfShares);

    const diffListEuro = diffPerformance.diffList.map(diff => Number((diff * exchangeRate).toFixed(2)));

    calculateTotalDividendPerShare(exchangeRate);
    calculateYieldOfShares();

    calculateDividendPerMonth();




    //CHANGER COULEURS
    changeBackgroundColor(diffEuro,diffPercent);

    //REMPLIR TABLEAUX
    fillStockPrices();

    fillAveragePrices();

    fillNumberOfShares();

    fillValueOfStocks(stocksPrice,exchangeRate);

    fillReturnInEuros(diffListEuro);

    fillReturnInPercent(diffPercentList);



    //DESSINER GRAPHES
    drawFirst(CashOnHand,finalValue);
    drawSecond(totalInvested,diffEuro);
    drawThird(finalValueOfStocks);
    drawFourth(diffListEuro);
    drawFifth(totalDividendPerShares);
    drawSixth(yieldOfShares);
    drawSeventh(dividendPerMonth);
    drawEighth(stocksPrice);
    drawNineth(annualReturnEuro,annualReturnPercent);
    drawTenth(annualInvested,walletEndYear);
    drawEleventh(annualDividendReceived);

}

main();

    </script>
</body>
</html>