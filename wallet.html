<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Portefeuille üöÄ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="./media/Logo/Logo-Blue.png">
</head>
<body>
    <header>
        <a href="index.html" class="logo-title-link">
            <img src="./media/Logo/Logo-White.png" alt="Logo QualityInvest">
            <h1>StocksPickeur</h1>
        </a>
        <!-- MAX 3 ONGLETS -->
        <div class="onglets">
            <a href="calculator.html">Calculateur</a>
            <a href="wallet.html">Portefeuille</a>

        </div>
    </header>

    <h2 class="semititle">PORTEFEUILLE DIVIDEND-QUALITY</h2>

    <div class="link-page">
        <h3><a href="#intro">Performance</a></h3>
        <h3><a href="#stocks-detail">Composition</a></h3>
        <h3><a href="#dividend">Dividendes</a></h3>
        <h3><a href="#annual-perf">Retours Annuel</a></h3>
        <h3><a href="#quality">Qualit√©</a></h3>
        <h3><a href="#valuation">Valorisation</a></h3>
    </div>

    <table class="wallet-intro" id="intro">
        <tr>
            <td>Total Investi</td>
            <td id="invested"></td>
            <td>Cash Disponible</td>
            <td id="cash"></td>
            <td>Dividendes Annuel</td>
            <td id="total-div"></td>
            <td>Gain Total ‚Ç¨</td>
            <td id="return-euro"></td>
        </tr>
        <tr>
            <td>Valeur Portefeuille</td>
            <td id="wallet-value"></td>
            <td>Valeur Totale</td>
            <td id="total-value"></td>
            <td>Rendement Portefeuille</td>
            <td id="yield-wallet"></td>
            <td>Gain Total %</td>
            <td id="return-percent"></td>
        </tr>
    </table>
    <div class="progress-container">
        <h2 class="progress-title">Atteindre les 25 000‚Ç¨ de Valeur du Portefeuille : <span id="firstProgressText">0%</span></h2>
        <progress id="firstProgressBar" value="0" max="0" class="progress-bar"></progress>  
        <h2 class="progress-title">Recevoir 60‚Ç¨ de dividendes nets en 2025 : <span id="secondProgressText">0%</span></h2>
        <progress id="secondProgressBar" value="0" max="0" class="progress-bar"></progress>
    </div>
    
    <div class="donut-container">
        <canvas id="1Chart"></canvas>
        <canvas id="2Chart"></canvas>
        <canvas id="18Chart"></canvas>
    </div>

    <table class="stocks-header" id="stocks-detail">
        <tr>
            <th>Logo</th>
            <th>Ticker</th>
            <th>Positions</th>
            <th>PRU</th>
            <th>Prix</th>
            <th>Valeur</th>
            <th>Retour ‚Ç¨</th>
            <th>Retour %</th>
        </tr>
    </table>

    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Stocks-Logo/ASML.png" alt="" class="stocks-pic"></td>
                <td id="ticker">ASML</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <div class="link-page-asml">
            <h3><a href="#presentation-asml">Pr√©sentation</a></h3>
            <h3><a href="#personnal-notice-asml">Avis Personnel</a></h3>
            <h3><a href="#asset-risk-asml">Atouts et Risques</a></h3>
            <h3><a href="#quality-score-asml">Score de Qualit√©</a></h3>
        </div>
        <h3 class="panel-subtitle" id="presentation-asml">Pr√©sentation</h3>
        <p>
            Fond√©e en 1984 aux Pays-Bas, ASML Holding est une entreprise leader dans la fabrication d'√©quipements pour la lithographie, un proc√©d√© crucial dans la production de semi-conducteurs. Avec son si√®ge social √† Veldhoven, ASML est un acteur cl√© de l'industrie technologique mondiale. La soci√©t√© est particuli√®rement connue pour ses machines de lithographie ultraviolette extr√™me (EUV), une technologie de pointe permettant de graver des circuits toujours plus fins sur les puces √©lectroniques. ASML collabore avec les plus grands fabricants de semi-conducteurs, tels que TSMC, Intel et Samsung, pour fournir des solutions qui permettent de produire des composants essentiels √† des secteurs vari√©s comme l'informatique, l'automobile et l'intelligence artificielle. <br><br>
            L'avantage comp√©titif d'ASML repose sur son avance technologique significative et sa position quasi-monopolistique sur le march√© des √©quipements de lithographie EUV. La complexit√© de cette technologie, combin√©e aux barri√®res √† l'entr√©e √©lev√©es, assure √† ASML une domination durable. De plus, la forte demande pour des puces toujours plus performantes garantit une croissance soutenue de ses revenus. L'int√©gration verticale d'ASML et sa capacit√© d'innovation en font un acteur strat√©gique dans la cha√Æne d'approvisionnement des semi-conducteurs.
        </p>
        <h3 class="panel-subtitle" id="personnal-notice-asml">Avis Personnel</h3>
        <p>
            ASML est une p√©pite technologique europ√©enne qui se distingue par sa contribution essentielle √† l‚Äôindustrie des semi-conducteurs. En tant qu‚Äôinvestisseur, il est difficile de ne pas admirer sa position dominante dans un secteur si strat√©gique et en constante expansion. Les semi-conducteurs √©tant pr√©sents dans presque tous les objets connect√©s modernes, la demande pour les machines d‚ÄôASML ne peut qu‚Äôaugmenter √† mesure que l‚ÄôInternet des objets, l‚Äôintelligence artificielle et les v√©hicules √©lectriques se g√©n√©ralisent. <br><br>
            Ce qui impressionne particuli√®rement chez ASML, c'est son monopole de facto sur la technologie EUV, un segment dans lequel la concurrence est inexistante √† court terme. Cela offre une marge de man≈ìuvre confortable pour fixer ses prix et g√©n√©rer des marges b√©n√©ficiaires exceptionnelles. L‚Äôentreprise b√©n√©ficie √©galement d‚Äôune visibilit√© remarquable sur ses revenus futurs, gr√¢ce √† des carnets de commandes bien remplis provenant des g√©ants des semi-conducteurs. <br><br>
            Toutefois, certains d√©fis m√©ritent attention. La d√©pendance envers un petit nombre de clients cl√©s, tels que TSMC, Samsung et Intel, peut poser des risques si ces derniers r√©duisent leurs investissements ou rencontrent des difficult√©s. De plus, les tensions g√©opolitiques, notamment autour de l'acc√®s √† la technologie EUV, pourraient impacter les ventes √† certaines r√©gions comme la Chine. Enfin, l‚Äôindustrie des semi-conducteurs est cyclique, ce qui peut provoquer des fluctuations importantes des revenus d‚ÄôASML en p√©riode de ralentissement. <br><br>
            Malgr√© ces risques, je consid√®re ASML comme une entreprise exceptionnelle, et elle figure parmi les valeurs les plus qualitatives de mon portefeuille avec une note de 25/30. L'√©quipe dirigeante a su d√©montrer une expertise sans faille dans l'ex√©cution de sa strat√©gie. En tant qu'investisseur, je suis confiant dans la capacit√© d'ASML √† maintenir son leadership et √† continuer de cro√Ætre dans un secteur critique pour l‚Äôavenir. Si vous cherchez une action combinant innovation, monopole technologique et perspectives de croissance solides, ASML est incontournable.
        </p>
        <h3 class="panel-subtitle" id="asset-risk-asml">Atouts et Risques</h3>
        <table class="panel-table">
            <tr>
                <th id="panel-table-title">Atouts</th>
                <th id="panel-table-title">Risques</th> 
            </tr>
            <tr>
                <td id="asset">Monopole sur la technologie EUV</td>
                <td id="risk">D√©pendance √† un petit nombre de clients cl√©s</td>
            </tr>
            <tr>
                <td id="asset">Avance technologique significative</td>
                <td id="risk">Cyclicit√© de l'industrie des semi-conducteurs</td>
            </tr>
            <tr>
                <td id="asset">Demande soutenue pour les semi-conducteurs</td>
                <td id="risk">Tensions g√©opolitiques</td>
            </tr>
        </table>
        <h3 class="panel-subtitle" id="quality-score-asml">Score de Qualit√©</h3>
        <div class="radar-container">
            <canvas id="25Chart"></canvas>
        </div>
        <h4 class="held-since">Action d√©tenue depuis le : 5 mai 2025</h4>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Stocks-Logo/GOOGL.png" alt="" class="stocks-pic"></td>
                <td id="ticker">GOOGL</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <div class="link-page-googl">
            <h3><a href="#presentation-googl">Pr√©sentation</a></h3>
            <h3><a href="#personnal-notice-googl">Avis Personnel</a></h3>
            <h3><a href="#asset-risk-googl">Atouts et Risques</a></h3>
            <h3><a href="#quality-score-googl">Score de Qualit√©</a></h3>
        </div>
        <h3 class="panel-subtitle" id="presentation-googl">Pr√©sentation</h3>
        <p>Fond√©e en 1998 par Larry Page et Sergey Brin, Google Inc., filiale d‚ÄôAlphabet Inc., est une multinationale am√©ricaine bas√©e √† Mountain View, Californie. Google est c√©l√®bre pour son moteur de recherche, mais aussi pour des produits et services phares comme YouTube, Android, Google Maps, et Google Chrome. L‚Äôentreprise d√©veloppe √©galement des outils de productivit√© (Google Workspace), des solutions cloud (Google Cloud Platform) et des technologies d‚Äôintelligence artificielle. <br><br>
            Le principal atout de Google r√©side dans son √©cosyst√®me int√©gr√© de produits et services soutenu par des technologies avanc√©es et une domination dans la publicit√© num√©rique via Google Ads. Gr√¢ce √† sa capacit√© d‚Äôinnovation, sa base mondiale d‚Äôutilisateurs fid√®les et son r√¥le cl√© dans la gestion de donn√©es √† grande √©chelle, Google reste l‚Äôune des entreprises les plus influentes et valoris√©es au monde.</p>
        <h3 class="panel-subtitle" id="personnal-notice-googl">Avis Personnel</h3>
        <p>√âtant l‚Äôune des entreprises les plus influentes et valoris√©es au monde, Google (via Alphabet) reste un acteur incontournable de la tech. Le g√©ant am√©ricain est l‚Äôun des leaders mondiaux en mati√®re de revenus publicitaires et domine √©galement des secteurs cl√©s comme la recherche en ligne et les syst√®mes d‚Äôexploitation mobiles gr√¢ce √† Android. Cette place dominante est justifi√©e par un √©cosyst√®me solide et une capacit√© √† innover continuellement. L‚Äôint√©gration coh√©rente entre ses services (Google Search, Gmail, Google Maps, YouTube, etc.) permet de fid√©liser une base d‚Äôutilisateurs immense et d‚Äôattirer de nouveaux clients. Bien que la concurrence soit rude, notamment dans le cloud et l‚ÄôIA, Google parvient √† maintenir sa part de march√© gr√¢ce √† des technologies de pointe et une exp√©rience utilisateur sans faille. <br><br>
            Un point fort ind√©niable de Google est sa diversification des revenus. Outre la publicit√©, qui repr√©sente une majeure partie de ses revenus, l‚Äôentreprise b√©n√©ficie de revenus croissants gr√¢ce √† Google Cloud et aux abonnements (YouTube Premium, Google Workspace, etc.). Ces sources de revenus r√©currents sont un atout strat√©gique pour l‚Äôavenir. La gestion du capital d‚ÄôAlphabet reste prudente et efficace : un bilan solide, des investissements massifs dans l‚Äôinnovation, et une strat√©gie de d√©veloppement orient√©e sur les secteurs cl√©s de demain (cloud computing, intelligence artificielle, v√©hicules autonomes avec Waymo, etc.). <br><br>
            Cependant, il faut surveiller certains aspects. La d√©pendance de Google √† ses revenus publicitaires reste √©lev√©e, et tout changement dans ce march√© (comme les restrictions li√©es √† la confidentialit√© des donn√©es ou l‚Äô√©mergence de nouveaux acteurs) pourrait avoir un impact significatif. La pression r√©glementaire, notamment sur la confidentialit√© et les enqu√™tes antitrust, est un autre point de vigilance. Enfin, la concurrence dans des secteurs comme le cloud (face √† AWS et Microsoft Azure) ou l‚ÄôIA est de plus en plus f√©roce. <br><br>
            En tant qu‚Äôutilisateur fid√®le des produits Google (de Gmail √† Android en passant par Google Drive), il m‚Äôest difficile d‚Äôimaginer un quotidien sans leurs services. L‚Äôentreprise combine innovation, accessibilit√© et efficacit√©, ce qui me pousse √† rester confiant dans ses perspectives futures. Avec une note personnelle de 25/30, Google reste l‚Äôune des actions les plus qualitatives de mon portefeuille, gr√¢ce √† son leadership technologique et sa capacit√© √† √©voluer dans un monde en constante transformation.</p>
        <h3 class="panel-subtitle" id="asset-risk-googl">Atouts et Risques</h3>
        <table class="panel-table">
            <tr>
               <th id="panel-table-title">Atouts</th>
               <th id="panel-table-title">Risques</th> 
            </tr>
            <tr>
                <td id="asset">Domination publicitaire</td>
                <td id="risk">D√©pendance √† la publicit√©</td>
            </tr>
            <tr>
                <td id="asset">√âcosyst√®me int√©gr√©</td>
                <td id="risk">Concurrence croissante</td>
            </tr>
            <tr>
                <td id="asset">Innovation technologique</td>
                <td id="risk">R√©gulations strictes</td>
            </tr>
        </table>
        <h3 class="panel-subtitle" id="quality-score-googl">Score de Qualit√©</h3>
        <div class="radar-container">
            <canvas id="24Chart"></canvas>
        </div>
        <h4 class="held-since">Action d√©tenue depuis le : 13 mars 2025</h4>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Stocks-Logo/MA.png" alt="" class="stocks-pic"></td>
                <td id="ticker">MA</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <div class="link-page-ma">
            <h3><a href="#presentation-ma">Pr√©sentation</a></h3>
            <h3><a href="#personnal-notice-ma">Avis Personnel</a></h3>
            <h3><a href="#asset-risk-ma">Atouts et Risques</a></h3>
            <h3><a href="#quality-score-ma">Score de Qualit√©</a></h3>
        </div>
        <h3 class="panel-subtitle" id="presentation-ma">Pr√©sentation</h3>
        <p>Fond√©e en 1966 sous le nom de Interbank Card Association, Mastercard est une entreprise am√©ricaine sp√©cialis√©e dans les services financiers, en particulier dans les syst√®mes de paiement √©lectronique. Mastercard fournit des solutions de paiement, y compris des cartes de cr√©dit, de d√©bit et pr√©pay√©es, ainsi que des services de traitement des transactions pour les institutions financi√®res, les commer√ßants et les consommateurs √† travers le monde. En tant que r√©seau de paiement mondial, Mastercard facilite les transactions financi√®res s√©curis√©es dans plus de 210 pays et territoires, offrant une connectivit√© entre les banques √©mettrices et les commer√ßants. <br><br>
            En tant que l'un des principaux r√©seaux de paiement au monde, Mastercard b√©n√©ficie d'un avantage comp√©titif consid√©rable gr√¢ce √† son r√©seau mondial √©tendu et √† sa marque bien √©tablie. La soci√©t√© est largement accept√©e par les commer√ßants et les institutions financi√®res √† travers le monde, ce qui lui conf√®re une position dominante dans l'industrie des paiements √©lectroniques. De plus, Mastercard investit continuellement dans l'innovation technologique pour am√©liorer la s√©curit√© et l'efficacit√© des transactions, renfor√ßant ainsi son moat √©conomique.</p>
        <h3 class="panel-subtitle" id="personnal-notice-ma">Avis Personnel</h3>
        <p>
            Mastercard, comme pour son concurrent Visa, joue le r√¥le d‚Äôinterm√©diaire entre les banques, institutions financi√®res et les consommateurs.  De nombreux points me poussent √† √™tre et rester actionnaire de la soci√©t√© Mastercard. L‚Äôun de ses plus gros points fort est sa rentabilit√© stratosph√©rique :  la marge nette moyenne des soci√©t√©s du S&P 500 √©tait de 10,7% fin 2023, celle de Mastercard est de 46% !! Des marges 4x plus √©lev√©e que celle du march√©, cela t√©moigne directement d‚Äôun MOAT extr√™mement puissant. En effet, le business-model de Mastercard est tr√®s solide, il se repose sur les frais de transaction qu‚Äôelle facture aux commer√ßants chaque fois qu‚Äôune carte Mastercard est utilis√©e pour effectuer un achat. <br><br>
            Un avantage comp√©titif plus que confortable qui ne risque pas de dispara√Ætre du jour au lendemain, car avec ses +2,5 milliards de carte en circulation, le g√©ant du paiement continue d‚Äôasseoir sa position dominante. Le volume de paiement et le nombre de cartes en circulation continue de grimper d‚Äôann√©es en ann√©es, tout comme le revenu et le Free-Cash-Flow de la boite. Tout les signaux de croissance sont au vert. Mastercard dispose donc d‚Äôun puissant effet de r√©seau, qui pousse les consommateurs √† rejoindre son r√©seau. Les commer√ßants sont aussi entrain√© √† autoriser les paiements par Mastercard afin de ne pas perdre de pr√©cieux clients qui comptaient payer par ce moyen r√©pandu sur le globe. <br><br>
            Il est n√©cessaire de suivre de pr√®s l'√©volution des cryptomonnaies dans l'opinion publique, mais il faudra encore un certain temps avant que ce mode de monnaie soit largement adopt√© : les habitudes de paiement ne changent pas du jour au lendemain. Cette transition demande du temps, ainsi que la cr√©ation de nouveaux comptes et le remplissage de formulaires, entre autres d√©marches. √Ä voir comment Mastercard va r√©agir face √† √ßa, et pourquoi pas en tirer profit elle aussi ! Autre petit point √† surveiller : l‚Äô√©volution de la dette. Dans l‚Äôanalyse qualitative de l‚Äôaction, c‚Äôest son plus gros point faible. Le Debt-to-Equity est pour l‚Äôinstant au dessus de 2, ce n‚Äôest clairement pas alarmiste mais je souhaiterai qu‚Äôil passe en dessous de la barre des 2. Le ratio de couverture des int√©r√™ts est tr√®s bon mais pas parfait. Ce sont de petit d√©tail mais nous devons rester ferme et exigeant : nous voulons les plus belles soci√©t√©s de la plan√®te. <br><br>
            Rien √† dire sur la gestion du dividende qui est parfaite : payout ratio extr√™mement bas et un dividende qui cro√Æt √† 2 chiffres, que demander de plus ? Mastercard est une grosse conviction pour moi, l‚Äôaction est d‚Äôexcellente qualit√© et je la conserverait tant que je ne vois pas une nette d√©gradation de ses fondamentaux (tr√®s peu probable disons-le).
        </p>
        <h3 class="panel-subtitle" id="asset-risk-ma">Atouts et Risques</h3>
        <table class="panel-table">
            <tr>
               <th id="panel-table-title">Atouts</th>
               <th id="panel-table-title">Risques</th> 
            </tr>
            <tr>
                <td id="asset">Duopole avec Visa</td>
                <td id="risk">Cryptomonnaies</td>
            </tr>
            <tr>
                <td id="asset">Marges stratosph√©riques</td>
                <td id="risk">Dette non n√©gligeable</td>
            </tr>
            <tr>
                <td id="asset">Business-Model solide</td>
                <td id="risk">Parts de March√©s</td>
            </tr>
        </table>
        <h3 class="panel-subtitle" id="quality-score-ma">Score de Qualit√©</h3>
        <div class="radar-container">
            <canvas id="13Chart"></canvas>
        </div>
        <h4 class="held-since">Action d√©tenue depuis le : 28 avril 2023</h4>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Stocks-Logo/MSFT.png" alt="" class="stocks-pic"></td>
                <td id="ticker">MSFT</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <div class="link-page-msft">
            <h3><a href="#presentation-msft">Pr√©sentation</a></h3>
            <h3><a href="#personnal-notice-msft">Avis Personnel</a></h3>
            <h3><a href="#asset-risk-msft">Atouts et Risques</a></h3>
            <h3><a href="#quality-score-msft">Score de Qualit√©</a></h3>
        </div>
        <h3 class="panel-subtitle" id="presentation-msft">Pr√©sentation</h3>
        <p>Fond√©e en 1975 par Bill Gates et Paul Allen, Microsoft Corporation est une multinationale am√©ricaine dont le si√®ge social est situ√© √† Redmond, dans l'√âtat de Washington. Microsoft est un leader mondial dans le d√©veloppement de logiciels, de mat√©riels et de services informatiques. La soci√©t√© est surtout connue pour son syst√®me d'exploitation Windows, sa suite bureautique Microsoft Office, la console de jeu Xbox, ainsi que pour ses services cloud tels que Microsoft Azure. Avec une pr√©sence dans de nombreux secteurs de l'industrie technologique, Microsoft s'efforce de cr√©er des produits et des solutions innovants qui am√©liorent la productivit√© des entreprises et la vie quotidienne des consommateurs. <br><br>
            Microsoft b√©n√©ficie d'un avantage comp√©titif durable dans plusieurs domaines cl√©s. Tout d'abord, sa position dominante dans les syst√®mes d'exploitation avec Windows et dans les suites logicielles avec Microsoft Office lui conf√®re une part de march√© consid√©rable et des flux de revenus r√©currents. De plus, Microsoft est un leader dans le domaine du cloud computing avec sa plateforme Azure, b√©n√©ficiant ainsi de la croissance rapide du cloud. Son √©cosyst√®me int√©gr√© de produits, de services et de plateformes offre √©galement des opportunit√©s d'expansion et de synergie, renfor√ßant ainsi son moat √©conomique. </p>
        <h3 class="panel-subtitle" id="personnal-notice-msft">Avis Personnel</h3>
        <p>
            Microsoft a √©t√© la toute premi√®re action que j‚Äôai achet√©e en Bourse, sur un n√©o-courtier sur mon t√©l√©phone le 10 janvier 2022. C‚Äôest en quelque sorte la plus vieille position de mon Portefeuille, et je ne suis clairement pas pr√™t de couper mes positions sur ce joyau. Si je ne devais plus que garder une seule action pour le restant de mes jours, mon choix se porterait sur Microsoft sans h√©siter. Voici pourquoi :  Niveau fondamentaux, l‚Äôaction est la plus qualitative de mon Portefeuille avec un score de 27/30. C‚Äôest bien simple : je ne lui trouve pas de point faible, l‚Äôaction est quasiment parfaite, et coche tout les crit√®res de qualit√©. Rachat d‚Äôactions √† tout va, prix de l‚Äôaction qui s‚Äôenvole, croissance √† tout les niveaux, rentabilit√© plus que correcte, dette g√©r√©e parfaitement, et dividende plus que safe, voil√† la situation de Microsoft. La firme am√©ricaine bat √† chaque fois les estimations des analystes de trimestres en trimestres. Microsoft est extr√™mement bien g√©r√© et c‚Äôest tout ce dont nous attendons, nous actionnaires. √áa va √™tre difficile de trouver 3 points faibles, croyez-moi. <br><br>
            La quasi-perfection de cette action ne repose pas que sur ses fondamentaux sublimes. Une grande force de Microsoft est la diversit√© de ses revenus. L‚Äôentreprise gagne de l‚Äôargent sur de nombreux march√©s tout aussi profitable les uns que les autres : licences offices, hardware, jeux-vid√©o, cloud, publicit√©s,‚Ä¶ Cela fait une grande force pour le groupe de Bill Gates, qui ne se repose pas sur une seule source de revenu comme c‚Äôest le cas pour maintes soci√©t√©s am√©ricaines. Qui peut se targuer d‚Äôavoir 9 sources de revenu diff√©rentes toute autant diversifi√©e les unes que les autres ? Le revenu est aussi diversifi√© g√©ographiquement en ayant 50% pour les USA et 50% pour le reste du monde. <br><br>
            Microsoft est en fait omnipr√©sent dans tout les secteurs de la technologie moderne. La suite office, utilis√©e par des centaines de millions d‚Äôutilisateurs dans le monde, est pratiquement devenue indispensable pour de nombreuses entreprises. Des chiffres de comptabilit√© depuis des d√©cennies sont inscrits sur Excel pour ces entreprises, est-ce que vous verrez ces soci√©t√©s changer leur outil du jour au lendemain ? pas certain. Cela conf√®re √† la soci√©t√© c√¥t√©e au NASDAQ un moat plus qu‚Äôint√©ressant, en raison du co√ªt de changement √©lev√© associ√© √† la migration vers une nouvelle plateforme. En plein essor actuellement, l'Intelligence Artificielle n'a √©videmment pas √©chapp√© √† l'attention de la compagnie am√©ricaine. Microsoft s'est solidement positionn√© dans la course √† l'IA gr√¢ce √† ChatGPT, d√©velopp√© par OpenAI, dont Microsoft d√©tient 49% des parts. C‚Äôest un secteur en plein essor dans lequel tout va tr√®s vite, donc √† voir si Microsoft va r√©ussir √† garder son avance sur ses concurrents. <br><br>
            Concernant les risques de la soci√©t√© √† ce jour, je pense que le principal est la concurrence f√©roce qu‚Äôa Microsoft dans les diff√©rents march√© dans laquelle la soci√©t√© op√®re. En effet, la n√©cessit√© pour Microsoft de rester en t√™te de l'innovation tout en rivalisant avec des concurrents agressifs. La firme am√©ricaine a r√©alis√© de nombreux rachats tr√®s int√©ressants par le pass√© (LinkedIn, GitHub,..), il faut garder en t√™te que de potentielles futures acquisitions ne seront pas b√©n√©fiques pour elle. Attention √† ce que la soci√©t√© ne se dilue pas dans trop de march√©s diff√©rents, et que cela lui fasse perdre en comp√©titivit√©.
        </p>
        <h3 class="panel-subtitle" id="asset-risk-msft">Atouts et Risques</h3>
        <table class="panel-table">
            <tr>
               <th id="panel-table-title">Atouts</th>
               <th id="panel-table-title">Risques</th> 
            </tr>
            <tr>
                <td id="asset">Diversit√© des Revenus</td>
                <td id="risk">Concurrence F√©roce</td>
            </tr>
            <tr>
                <td id="asset">Fondamentaux Exceptionnels</td>
                <td id="risk">Acquisitions Douteuses</td>
            </tr>
            <tr>
                <td id="asset">Position Strat√©gie dans l'IA</td>
                <td id="risk">Sur-Diversification</td>
            </tr>
        </table>
        <h3 class="panel-subtitle" id="quality-score-msft">Score de Qualit√©</h3>
        <div class="radar-container">
            <canvas id="14Chart"></canvas>
        </div>
        <h4 class="held-since">Action d√©tenue depuis le : 27 mars 2023</h4>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Stocks-Logo/SPGI.png" class="stocks-pic"></td>
                <td id="ticker">SPGI</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <div class="link-page-spgi">
            <h3><a href="#presentation-spgi">Pr√©sentation</a></h3>
            <h3><a href="#personnal-notice-spgi">Avis Personnel</a></h3>
            <h3><a href="#asset-risk-spgi">Atouts et Risques</a></h3>
            <h3><a href="#quality-score-spgi">Score de Qualit√©</a></h3>
        </div>
        <h3 class="panel-subtitle" id="presentation-spgi">Pr√©sentation</h3>
        <p>Fond√©e en 1860, S&P Global est une entreprise am√©ricaine sp√©cialis√©e dans la fourniture d‚Äôinformations financi√®res et d‚Äôanalyses √©conomiques. S&P Global propose une gamme de produits et services, notamment des notations de cr√©dit, des indices boursiers, des donn√©es de march√© et des analyses √©conomiques approfondies pour les entreprises, les investisseurs et les institutions financi√®res √† travers le monde. La soci√©t√© joue un r√¥le cl√© dans la transparence des march√©s financiers en fournissant des informations essentielles pour la prise de d√©cisions d‚Äôinvestissement. Ses activit√©s sont ax√©es sur la facilitation des d√©cisions √©conomiques strat√©giques, soutenues par des donn√©es fiables et des analyses pr√©cises. <br><br>
            S&P Global est l‚Äôun des principaux acteurs du secteur de l‚Äôinformation financi√®re, avec une large reconnaissance internationale gr√¢ce √† ses indices phares, tels que le S&P 500. Sa position dominante dans les notations de cr√©dit et les indices de r√©f√©rence constitue son avantage comp√©titif. La soci√©t√© continue d‚Äôinvestir dans l‚Äôinnovation num√©rique et l‚Äôanalyse de donn√©es pour offrir des solutions plus rapides et plus intelligentes √† ses clients, tout en renfor√ßant sa position de leader dans le secteur de l‚Äôinformation financi√®re.</p>
        <h3 class="panel-subtitle" id="personnal-notice-spgi">Avis Personnel</h3>
        <p>En situation de quasi-duopole avec Moody‚Äôs, S&P Global est le principal fournisseur de donn√©es financi√®res au monde. La firme fournit des donn√©es √† des banques, gestionnaires de fonds, particuliers sous forme d‚Äôabonnement via son outil S&P Capital IQ. Cet outil est reconnu pour sa fiabilit√© par les investisseurs du monde entier, b√©n√©ficiant ainsi d'un puissant effet de r√©seau. S&P Global vend √©galement des donn√©es financi√®res sur l‚Äôindustrie automobile (secteur Mobility) ainsi que sur les mati√®res premi√®res (Commodity Insight), les 2 √©tant √©galement des syst√®mes par abonnement comme l‚Äôest leur premi√®re activit√© de donn√©es financi√®res, Market Intelligence. C‚Äôest tout bon pour nous investisseurs, le syst√®me par abonnement √©tant des revenus r√©currents et stable dans le temps. <br><br>
           Ce n‚Äôest clairement pas le seul secteur d‚Äôactivit√© de l‚Äôentreprise. Son secteur d‚Äôactivit√© le plus connu est sans conteste la partie Ratings : S&P note la capacit√© d‚Äôun √©tat ou soci√©t√© √† rembourser sa dette en temps voulu. Ces notations sont cruciales pour les investisseurs, car elles influencent leurs d√©cisions d‚Äôinvestissement, ainsi que pour les emprunteurs, car une meilleure notation leur permet d‚Äôemprunter √† des taux plus bas. De nombreuses agences de notation existent dans le monde entier, mais S&P Global est celle qui t√©moigne de la meilleure r√©putation dans le monde. <br><br>
           Autre secteur d‚Äôactivit√© au combien int√©ressant : la partie Indice. C‚Äôest S&P qui a fond√© en 1957 le c√©l√®bre indice du S&P 500. La boite am√©ricaine poss√®de des centaines d‚Äôautres indices sur tout les th√®mes possibles et inimaginables. Avec cela, S&P Global profite de la tendance de l‚Äôinvestissement passif via les ETFs : Chaque fois qu'un ETF est bas√© sur un indice S&P, S&P Global per√ßoit r√©guli√®rement une part des frais de gestion. L‚Äôindice S&P 500 √©tant l‚Äôindice le plus populaire aupr√®s des investisseurs particuliers, S&P dispose d‚Äôun oligopole naturel. <br><br>
           Ce sont ces diff√©rents secteurs d‚Äôactivit√©s et sa position dominante sur l‚Äôensemble d‚Äôentre eux qui m‚Äôa pouss√© √† investir dans S&P Global. Ce sont des secteurs d‚Äôavenir, tant les donn√©es financi√®res prennent une place importante dans le quotidien de millions de personnes sur terre. Le taux de r√©tention des abonnements de donn√©es financi√®res est extr√™mement √©lev√©, ce qui peut traduire le fait que les investisseurs ne savent pas se passer de ces donn√©es pour investir (et c‚Äôest totalement logique ! pour bien investir il faut des donn√©es justes).
        </p>
        <h3 class="panel-subtitle" id="asset-risk-spgi">Atouts et Risques</h3>
        <table class="panel-table">
            <tr>
               <th id="panel-table-title">Atouts</th>
               <th id="panel-table-title">Risques</th> 
            </tr>
            <tr>
                <td id="asset">Duopole avec Moody's</td>
                <td id="risk">D√©pendance aux march√©s</td>
            </tr>
            <tr>
                <td id="asset">D√©tenteur du S&P 500</td>
                <td id="risk">R√©putation √† tenir</td>
            </tr>
            <tr>
                <td id="asset">Effet de R√©seau</td>
                <td id="risk">R√©glementations</td>
            </tr>
        </table>
        <h3 class="panel-subtitle" id="quality-score-spgi">Score de Qualit√©</h3>
        <div class="radar-container">
            <canvas id="21Chart"></canvas>
        </div>
        <h4 class="held-since">Action d√©tenue depuis le : 24 octobre 2024</h4>
    </div>
    <div class="accordion">
        <table class="stocks-info">
            <tr>
                <td><img src="./media/Stocks-Logo/V.png" class="stocks-pic"></td>
                <td id="ticker">V</td>
                <td id="shares"></td>
                <td id="average-price"></td>
                <td id="price"></td>
                <td id="value"></td>
                <td id="perf-euro"></td>
                <td id="perf-percent"></td>
            </tr>
        </table>
    </div>
    <div class="panel">
        <div class="link-page-v">
            <h3><a href="#presentation-v">Pr√©sentation</a></h3>
            <h3><a href="#personnal-notice-v">Avis Personnel</a></h3>
            <h3><a href="#asset-risk-v">Atouts et Risques</a></h3>
            <h3><a href="#quality-score-v">Score de Qualit√©</a></h3>
        </div>
        <h3 class="panel-subtitle" id="presentation-v">Pr√©sentation</h3>
        <p>Fond√©e en 1958 sous le nom de BankAmericard, Visa Inc. est une entreprise am√©ricaine sp√©cialis√©e dans les services de paiement √©lectronique. Visa propose une gamme de produits et services de paiement, y compris des cartes de cr√©dit, de d√©bit et pr√©pay√©es, ainsi que des solutions de paiement √©lectronique pour les particuliers, les commer√ßants et les institutions financi√®res dans le monde entier. La soci√©t√© facilite les transactions financi√®res s√©curis√©es √† l'√©chelle mondiale gr√¢ce √† son r√©seau de traitement des paiements, qui relie les √©metteurs de cartes, les acqu√©reurs de transactions, les commer√ßants et les consommateurs. En tant que leader mondial des paiements √©lectroniques, Visa joue un r√¥le crucial dans l'√©conomie mondiale en facilitant le commerce et les √©changes financiers. <br><br>
            Visa poss√®de l'un des r√©seaux de paiement les plus √©tendus au monde, ce qui constitue son principal avantage comp√©titif. La marque Visa est largement reconnue et accept√©e par les commer√ßants et les consommateurs √† travers le monde, ce qui lui conf√®re une position dominante dans l'industrie des paiements √©lectroniques. De plus, Visa investit dans l'innovation technologique pour am√©liorer la s√©curit√©, la commodit√© et l'efficacit√© des transactions, renfor√ßant ainsi son moat √©conomique. </p>
        <h3 class="panel-subtitle" id="personnal-notice-v">Avis Personnel</h3>
        <p>Visa est la quatri√®me action le plus d√©tenue par les supers-investisseurs, et est une action qui revient souvent quand on parle de Quality Investing. D√©couvrons pourquoi. Tout comme son petit fr√®re Mastercard, Visa joue le r√¥le d‚Äôinterm√©diaire de confiance entre deux acteurs financiers, comme les banque, des commer√ßants ou des clients. Visa gagne de l‚Äôargent sur les frais de transaction qu‚Äôelle facture pour l‚Äôutilisation de son r√©seau de payement. C‚Äôest un tr√®s bon business puisqu‚Äôil est solide, r√©gulier et scalable. <br><br>
            En plus d‚Äô√™tre excellent business, celui-ci est extr√™mement bien prot√©g√© de plusieurs MOAT : Effet de R√©seau, co√ªt de transfert, actif intangible du r√©seau VisaNet,‚Ä¶ L‚Äôentreprise domine litt√©ralement son march√© avec pas moins de 61% des parts de march√© des cartes de cr√©dits en 2021. Mastercard vient compl√©ter la seconde place, ce qui donne aux 2 g√©ants 87% des parts de march√© √† deux, leur laissant un march√© en duopole. Le march√© des cartes bancaires est un secteur d‚Äôavenir, ayant un volume de transaction qui grossit d‚Äôann√©es en ann√©es, laissant pr√©dire de belles ann√©es de croissance pour Visa. <br><br>
            En europe le paiement en esp√®ce reste encore tr√®s pr√©sent avec l‚ÄôItalie, l‚ÄôEspagne et l‚ÄôAllemagne qui ont plus de 80% des paiements totaux effectu√©s en cash en 2018. Visa n‚Äôa donc pas encore atteint le plafond de son march√© et de nombreux clients potentiels restent √† conqu√©rir. Comme pour Mastercard, la soci√©t√© b√©n√©ficie √©galement d‚Äôune notori√©t√© mondiale et d‚Äôune confiance envers son r√©seau de paiement. <br><br>
            Maintenant que vous connaissez le statut de Visa, venons aux fondamentaux. Vous vous doutez bien, si cette action se retrouve ici c‚Äôest que c‚Äôest (quasi) excellent. Visa poss√®de toutes les caract√©ristique d‚Äôune action √† dividendes de tr√®s haute qualit√© : croissance √† 2 chiffres, rentabilit√© colossale, dividende de qualit√©,‚Ä¶ L‚Äôentreprise perd quelques points au niveau de la croissance de son Free-Cash-Flow, de son ROIC √©lev√© mais plus bas compar√© √† celui de Mastercard. Comme pour Mastercard attention aux cryptomonnaies qui pourrait remplacer les monnaies que l‚Äôon utilise actuellement, mais on a encore un peu de temps avant nous avant que l‚Äô√©cosyst√®me crypto soit adopt√© par la majorit√©. Surtout que Visa et Mastercard pourrait tirer parti de cette technologie, √† voir ! <br><br>
        </p>
        <h3 class="panel-subtitle" id="asset-risk-v">Atouts et Risques</h3>
        <table class="panel-table">
            <tr>
               <th id="panel-table-title">Atouts</th>
               <th id="panel-table-title">Risques</th> 
            </tr>
            <tr>
                <td id="asset">Num√©ro 1 sur son march√©</td>
                <td id="risk">R√©gulation</td>
            </tr>
            <tr>
                <td id="asset">Duopole avec Mastercard</td>
                <td id="risk">Cryptomonnaies</td>
            </tr>
            <tr>
                <td id="asset">Effet de R√©seau</td>
                <td id="risk">Cyberattaques</td>
            </tr>
        </table>
        <h3 class="panel-subtitle" id="quality-score-v">Score de Qualit√©</h3>
        <div class="radar-container">
            <canvas id="15Chart"></canvas>
        </div>
        <h4 class="held-since">Action d√©tenue depuis le : 27 mars 2023</h4>
    </div>
    <div class="bar-container" id="last-accordion">
        <canvas id="3Chart"></canvas>
        <canvas id="4Chart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="8Chart"></canvas>
    </div>

    <div class="big-chart-container" id="dividend">
        <canvas id="23Chart"></canvas>
    </div>

    <div class="big-chart-container">
        <canvas id="7Chart"></canvas>
    </div>
    <div class="bar-container">
        <canvas id="6Chart"></canvas>
        <canvas id="5Chart"></canvas>
    </div>

    <div class="big-chart-container">
        <canvas id="29Chart"></canvas>
    </div>

    <div class="big-chart-container" id="annual-perf">
        <canvas id="9Chart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="19Chart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="10Chart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="11Chart"></canvas>
    </div>

    <div class="big-chart-container" id="quality">
        <canvas id="22Chart"></canvas>
    </div>

    <div class="big-chart-container">
        <canvas id="16Chart"></canvas>
    </div>
    <div class="big-chart-container">
        <canvas id="17Chart"></canvas>
    </div>
    <div class="big-radar-container">
        <canvas id="20Chart"></canvas>
    </div>
    <div class="big-chart-container" id="valuation">
        <canvas id="26Chart"></canvas>
    </div>
        <div class="big-chart-container">
        <canvas id="27Chart"></canvas>
    </div>
    </div>
        <div class="big-chart-container">
        <canvas id="28Chart"></canvas>
    </div>

    <div class="footer">
        <div class="copyright">
            <img src="./media/Logo/Logo-Black.png" alt="Logo QualityInvest">
            <span id="copyright-text" ><a href="https://x.com/StocksPickeur" class="reset-link">StocksPickeur &copy; 2025</a></span>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
    
    <script>

//TRANSITION FLUIDE POUR ALLER √Ä ENDROITS DE LA PAGE
document.querySelectorAll('.link-page a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
document.querySelectorAll('.link-page-asml a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
document.querySelectorAll('.link-page-googl a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
document.querySelectorAll('.link-page-ma a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
document.querySelectorAll('.link-page-msft a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
document.querySelectorAll('.link-page-v a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();

        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});

//G√âRER L'ACCORD√âON + DEPLIEMENT SMOOTH
document.addEventListener("DOMContentLoaded", function() {
  var accordions = document.getElementsByClassName("accordion");
  
  for (var i = 0; i < accordions.length; i++) {
    accordions[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var panel = this.nextElementSibling;
      
      if (panel.style.display === "block") {
        panel.style.maxHeight = "0";
        setTimeout(function() {
          panel.style.display = "none";
        }, 300); // Temps de la transition en millisecondes
      } else {
        panel.style.display = "block";
        setTimeout(function() {
          panel.style.maxHeight = panel.scrollHeight + "px";
        }, 10); // Petit d√©lai pour permettre l'animation
      }
    });
  }
});


//CHANGER COULEUR BACKGROUND SI POSITIF/N√âGATIF
function changeBackgroundColor(diffEuro,diffPercent){
    const returnEuroCell = document.getElementById('return-euro');
    const returnPercentCell = document.getElementById('return-percent');

    diffEuro = parseFloat(diffEuro);
    diffPercent = parseFloat(diffPercent);

    if (diffEuro > 0){
        returnEuroCell.style.backgroundColor = 'rgba(0, 99, 27,0.5)';
    } 
    else if (value < 0) {
        returnEuroCell.style.backgroundColor = 'rgba(255, 99, 132, 0.5)';
    }
    else {
        returnEuroCell.style.backgroundColor = '';
    }

    if (diffPercent > 0){
        returnPercentCell.style.backgroundColor = 'rgba(0, 99, 27,0.5)';
    } 
    else if (value < 0) {
        returnPercentCell.style.backgroundColor = 'rgba(255, 99, 132, 0.5)';
    }
    else {
        returnPercentCell.style.backgroundColor = '';
    }
}





//TOUTES LES VARIABLES UTILIS√âES

var totalInvested = 16500; // montant total investi
var totalInvestedCell = document.getElementById("invested");
totalInvestedCell.textContent = totalInvested;

var CashOnHand = 1873.32; // cash disponible
var cashCell = document.getElementById("cash");
cashCell.textContent = CashOnHand.toFixed(2);

var tickerOfShares = ["ASML", "GOOGL","MA", "MSFT","SPGI", "V"]; // tickers
var numberOfShares = [6, 20, 4, 8, 4, 10]; // nombres d'actions
var pruOfShares = [689.615, 166.19625, 411.6737, 364.5375, 499.1, 274.796]; // PRU des actions

var stocksPrice = []; // prix actuels des actions, en $
let totalPRU = 0;
const valueOfStocks = []; // liste pour stocker les valeurs des actions, en $
let totalValue = 0; // valeur actuelle du portefeuille, en $

var finalValueOfStocks = []; // liste pour stocker les valeurs des actions, en ‚Ç¨
var finalValue = 0; // valeur actuelle du portefeuille, en ‚Ç¨

var averageValuePerStocks //valeur moyenne par action

var diffList = [];
var diffPercentList = [];

var stocksPERatio = []; // PE Ratio de toutes les actions
var tenyearsPERatio = [34.99,28.33,37.75,33.43,32.61,33.41] // PE Ratio m√©dian des 10 derni√®res ann√©es
var gurufocusPrice = [1059.26,186.18,574.21,481.96,525.02,314.72]
var tipsrankPrice = [886.82,240.53,629.13,625.78,625.5,394.95]
var stocksFairPrice = []; // Liste des scores de prix juste
var valuationScore = []; // Score de valorisation de chaque actions

var dividendPerShares = [7.42, 0.84, 3.04, 3.32, 3.84, 2.36]; // liste pour stocker les dividendes vers√©s par actions en $

var totalDividendPerShares = []; //liste pour stocker les dividendes vers√©s par action en ‚Ç¨

var totalDividend = 0; //motant total des dividendes touch√©s par an

var yieldOfShares = [];

var yieldOfWallet = 0; //Rendement total du portefeuille

var years = [2022,2023,2024,2025]; // liste des ann√©es, pour les graphes de retours annuels et invested vs wallet value

var months = ['Janvier','F√©vrier','Mars','Avril','Mai','Juin','Juillet','Ao√ªt','Septembre','Octobre','Novembre','D√©cembre'];

var dividendPerMonth = [];

var dividendPerMonthNet = [];

var annualReturnEuro = [0,442.03,2104.53]; // liste des retours annuels, en euro

var annualReturnPercent = [0,8.26,30.76]; //liste des retours annuels, en pourcent

var annualDividendReceived = [12.35, 41.31,42.4]; //liste des dividendes annuels nets re√ßus

var totalGainWithoutDividend = 0; //gain total en bourse des plus-value (sans dividendes re√ßus)

var annualInvested = [0,5350,6400]; //liste qui stocke le nombres d'euros investi par an

var walletEndYear = [0,5792.03,8946.56]; //liste qui stocke la valeur du portefeuille √† la fin de chaque ann√©e

var ASMLCotation = [100,67,50,100,100];
var GOOGLCotation = [100,67,50,100,67];
var MACotation = [67,100,100,33,100];
var MSFTCotation = [100,100,67,100,67];
var SPGICotation = [100,100,50,67,100];
var VCotation = [67,67,83,100,100];
var stocksCotation = [ASMLCotation,GOOGLCotation,MACotation,MSFTCotation,SPGICotation,VCotation];

var ASMLScore = 25;
var GOOGLScore = 23;
var MAScore = 24;
var MSFTScore = 26;
var SPGIScore = 23;
var VScore = 25;
var stocksScore = [ASMLScore, GOOGLScore, MAScore,MSFTScore,SPGIScore,VScore];

var annualMarketReturnPercent = [-19.44,24.23,23.31]; //retour annuels du S&P500 en pourcent (source : https://www.macrotrends.net/2526/sp-500-historical-annual-returns)

var weightOfStocks = []; //liste qui repr√©sente le poids de chaque action du Portefeuille en % (valeurs : [0.24,0.26,0.3,0.2])
var weightedAverages = [];


var dividendData = Array(months.length).fill(0).map(() => Array(4).fill(0)); //Matrice qui repr√©sente qui pour chaque action le montant vers√© en dividende pour tout les mois


var stocksDividendGrowth = [15, 0, 15, 10, 10, 15]; //Tableau repr√©sentant les pourcentages d'augmentation du dividende sur 5 ans des actions du portefeuille
var futureYears = []; //Tableau qui va contenir le nombre des 11 prochaines ann√©es (2025,2026,2027,...,2035)
var futureDividendsReceived = []; //Tableau qui va contenir le montant brut estim√© des dividendes re√ßu lors des 11 prochaines ann√©es


//FONCTIONS 

//Obtenir le taux de change Dollar-Euro avec ExchangeRate
const apiKeyCurrency = 'e5075f23dc192ea91c92c824';

async function getExchangeRate() {
    try {
        const response = await fetch(`https://api.exchangerate-api.com/v4/latest/USD`);
        const data = await response.json();
        
        if (data && data.rates && data.rates.EUR) {
            const exchangeRate = data.rates.EUR;
            return exchangeRate
        } else {
            console.log("Impossible de r√©cup√©rer le taux de change pour le moment.");
        }
    } catch (error) {
        console.error('Erreur lors de la r√©cup√©ration du taux de change :', error);
    }
}


/// Remplacez 'YOUR_API_KEY' par votre cl√© API Finnhub
const apiKey = 'cfeip41r01qoicaf4hk0cfeip41r01qoicaf4hkg';

// Fonction pour r√©cup√©rer le prix de l'action
async function getStockPrice(symbol, index) {
    try {
        const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`);
        const data = await response.json();

        // V√©rifier si les donn√©es ont √©t√© r√©cup√©r√©es avec succ√®s
        if (data.c) {
            const price = data.c;
            stocksPrice[index] = price; // Stocker le prix dans l'indice correspondant de stocksPrice
        } else {
            console.log(`Erreur: Impossible de r√©cup√©rer les donn√©es pour ${symbol}.`);
        }
    } catch (error) {
        console.log('Erreur:', error);
    }
}


// Cl√© API Twelve Data (√† stocker de mani√®re s√©curis√©e en production)
const TWELVE_DATA_API_KEY = '402fb2cdc8714fa4a45593cfe8108cae';

// Fonction pour r√©cup√©rer le prix actuel du SPY avec Twelve Data
async function getCurrentSPYPrice() {
    try {
        const response = await fetch(`https://api.twelvedata.com/price?symbol=SPY&apikey=${TWELVE_DATA_API_KEY}`);
        if (!response.ok) {
            throw new Error(`Erreur HTTP: ${response.status}`);
        }
        const data = await response.json();
        
        if (data.code === 429) {
            console.error('Limite de requ√™tes API atteinte pour Twelve Data');
            return null;
        }
        
        if (data.price) {
            return parseFloat(data.price);
        }
        
        console.error('Format de r√©ponse inattendu de Twelve Data (prix actuel):', data);
        return null;
    } catch (error) {
        console.error('Erreur avec Twelve Data (prix actuel):', error);
        return null;
    }
}

// Fonction pour r√©cup√©rer le prix du SPY au d√©but de l'ann√©e avec Twelve Data
async function getStartSPYPrice() {
    try {
        const currentYear = new Date().getFullYear();
        const startDate = `${currentYear}-01-01`;
        const endDate = new Date().toISOString().split('T')[0]; // Date d'aujourd'hui
        
        const response = await fetch(
            `https://api.twelvedata.com/time_series?symbol=SPY&interval=1day&start_date=${startDate}&end_date=${endDate}&apikey=${TWELVE_DATA_API_KEY}`
        );
        
        if (!response.ok) {
            throw new Error(`Erreur HTTP: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.code === 429) {
            console.error('Limite de requ√™tes API atteinte pour Twelve Data');
            return null;
        }
        
        if (data.values && data.values.length > 0) {
            // Le premier jour de bourse de l'ann√©e est le dernier √©l√©ment du tableau
            const firstTradingDay = data.values[data.values.length - 1];
            return parseFloat(firstTradingDay.close);
        }
        
        console.error('Aucune donn√©e historique trouv√©e pour le d√©but d\'ann√©e');
        return null;
    } catch (error) {
        console.error('Erreur avec Twelve Data (prix d√©but ann√©e):', error);
        return null;
    }
}

// Ancien code supprim√© et remplac√© par la version avec proxy CORS

// Fonction pour r√©cup√©rer le PE ratio de l'action
async function getPERatio(symbol, index) {
    try {
        const response = await fetch(`https://finnhub.io/api/v1/stock/metric?symbol=${symbol}&metric=valuation&token=${apiKey}`);
        const data = await response.json();

        // V√©rifier si les donn√©es ont √©t√© r√©cup√©r√©es avec succ√®s
        if (data.metric && data.metric.peNormalizedAnnual) {
            const peRatio = data.metric.peNormalizedAnnual;
            stocksPERatio[index] = parseFloat(peRatio.toFixed(2)); // Stocker le PE ratio dans l'indice correspondant
        } else {
            console.log(`Erreur: Impossible de r√©cup√©rer les donn√©es du PE ratio pour ${symbol}.`);
        }
    } catch (error) {
        console.log('Erreur:', error);
    }
}

// Obtenir le P/E ratio de toutes les actions
async function getAllPERatios() {
    for (let i = 0; i < tickerOfShares.length; i++) {
        await getPERatio(tickerOfShares[i], i);
    }
}

// Obtenir le prix de toutes les actions
async function getAllStockPrices() {
    for (let i = 0; i < tickerOfShares.length; i++) {
        await getStockPrice(tickerOfShares[i], i);
    }

    // Appel de la fonction pour calculer le co√ªt total de chaque action
    calculateTotalCostOfShares();
}

// Fonction pour calculer le co√ªt total de chaque action
function calculateTotalCostOfShares() {
    totalValue = 0; // R√©initialiser la valeur totale du portefeuille
    totalPRU = 0; // R√©initialiser le PRU total
    valueOfStocks.length = 0; // R√©initialiser la liste de valeurs

    for (let i = 0; i < numberOfShares.length; i++) {
        const totalCost = numberOfShares[i] * stocksPrice[i]; // Multiplication
        totalValue += totalCost; // Accumuler la valeur totale du portefeuille
        totalPRU += Number((pruOfShares[i] * numberOfShares[i]).toFixed(2)); // Accumuler le PRU total
        
        // Ajouter la valeur totale de chaque action au tableau valueOfStocks
        valueOfStocks.push(totalCost);
    }
}

// Fonction pour calculer la performance en euro et % de chaque action
function calculatePerformanceForAllStocks(currentPrices, pruList, numberOfSharesList) {
    for (let i = 0; i < pruList.length; i++) {
        const currentPrice = currentPrices[i];
        const pru = pruList[i];
        const numberOfShares = numberOfSharesList[i];
        const diffEuro = ((currentPrice - pru) * numberOfShares).toFixed(2);
        const diffPercent = (((currentPrice - pru) / pru) * 100).toFixed(2);
        diffList.push(Number(diffEuro));
        diffPercentList.push(Number(diffPercent));
    }
    return {
        diffList: diffList,
        diffPercentList: diffPercentList
    };
}


function calculateTotalDividendPerShare(exchangeRate) {
    totalDividendPerShares.length = 0; // R√©initialiser le tableau des totaux de dividendes par action
    
    for (let i = 0; i < numberOfShares.length; i++) {
        const toPush = Number(((numberOfShares[i] * dividendPerShares[i]) * exchangeRate).toFixed(2)); // Calculer le total des dividendes pour cette action
        totalDividendPerShares.push(toPush); // Ajouter le total des dividendes au tableau
        totalDividend += toPush;
        
    }
}

// Fonction pour calculer le rendement de chaque action
function calculateYieldOfShares() {
    yieldOfShares.length = 0; // R√©initialiser le tableau des rendements par action
    
    for (let i = 0; i < numberOfShares.length; i++) {
        const yield = Number((100 * (dividendPerShares[i] / stocksPrice[i])).toFixed(2)); // Calculer le rendement pour cette action
        yieldOfShares.push(yield); // Ajouter le rendement au tableau
    }
}

// fonction pour calculer le montant en dividende brut par mois re√ßus
function calculateDividendPerMonth() {
    var monthASML = ["F√©vrier","Mai","Ao√ªt","Novembre"];
    var monthGOOGL = ["Mars","Juin","Septembre","D√©cembre"];
    var monthMA = ["F√©vrier","Mai","Ao√ªt","Novembre"];
    var monthMSFT = ["Mars","Juin","Septembre","D√©cembre"];
    var monthSPGI = ["Mars","Juin","Septembre","D√©cembre"];
    var monthV = ["Mars","Juin","Septembre","D√©cembre"];

    for (let i = 0; i < months.length; i++) {
        var currentMonth = months[i];

        // Initialiser le dividende pour ce mois
        var monthlyDividend = 0;

        // V√©rifie pour chaque entreprise si le mois actuel correspond √† un mois de paiement de dividende
        if (monthASML.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[0] / 4;
        }
        if (monthGOOGL.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[1] / 4;
        }
        if (monthMA.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[2] / 4;
        }
        if (monthMSFT.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[3] / 4;
        }
        if (monthSPGI.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[4] / 4;
        }
        if (monthV.includes(currentMonth)) {
            monthlyDividend += totalDividendPerShares[5] / 4;
        }
        toAdd = Number(monthlyDividend.toFixed(2));
        // Stocker le dividende total pour ce mois
        dividendPerMonth.push(toAdd);
    }
}

//fonction pour calculer le montant en dividende net par mois re√ßu
function calculateNetDividendPerMonth() {

    //var dividendPerMonthNet = [];

    var ratio = 0.85;

    for (let i = 0; i < dividendPerMonth.length; i++) {
        var netDividend = dividendPerMonth[i] * ratio;
        dividendPerMonthNet.push(Number(netDividend.toFixed(2)));
    }
    return dividendPerMonthNet;
}

function calculateStackedDividendPerMonth() {
    var monthASML = ["F√©vrier","Mai","Ao√ªt","Novembre"];
    var monthGOOGL = ["Mars","Juin","Septembre","D√©cembre"];
    var monthMA = ["F√©vrier", "Mai", "Ao√ªt", "Novembre"];
    var monthMSFT = ["Mars", "Juin", "Septembre", "D√©cembre"];
    var monthSPGI = ["Mars", "Juin", "Septembre", "D√©cembre"];
    var monthV = ["Mars", "Juin", "Septembre", "D√©cembre"];

    for (let i = 0; i < months.length; i++) {
        var currentMonth = months[i];

        // Stocker les dividendes dans la matrice pour chaque action
        dividendData[i][0] = monthASML.includes(currentMonth) ? Number((totalDividendPerShares[0]/4).toFixed(2)) : 0;
        dividendData[i][1] = monthGOOGL.includes(currentMonth) ? Number((totalDividendPerShares[1]/4).toFixed(2)) : 0;
        dividendData[i][2] = monthMA.includes(currentMonth) ? Number((totalDividendPerShares[2]/4).toFixed(2)) : 0;
        dividendData[i][3] = monthMSFT.includes(currentMonth) ? Number((totalDividendPerShares[3]/4).toFixed(2)) : 0;
        dividendData[i][4] = monthSPGI.includes(currentMonth) ? Number((totalDividendPerShares[4]/4).toFixed(2)) : 0;
        dividendData[i][5] = monthV.includes(currentMonth) ? Number((totalDividendPerShares[5]/4).toFixed(2)) : 0;
    }
    return dividendData;
}



// Fonction pour remplir le tableau des prix actuels des actions
function fillStockPrices() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#price');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (stocksPrice[index]).toFixed(2);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau des PRU
function fillAveragePrices() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#average-price');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (pruOfShares[index]).toFixed(2);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau des nombres de positions par action
function fillNumberOfShares() {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#shares');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = (numberOfShares[index]);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau de la valeur totale par action
function fillValueOfStocks(stockPrices,exchangeRate) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#value');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            toAdd = Number((valueOfStocks[index] * exchangeRate).toFixed(2));
            cell.textContent = toAdd;
            finalValueOfStocks.push(toAdd);
        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau du retour sur investissement en euro par action
function fillReturnInEuros(diffListEuro) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#perf-euro');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = diffListEuro[index];

            const diffEuro = parseFloat(diffListEuro[index]);
            if (diffEuro > 0) {
                cell.style.color = 'green'; // Vert
            } else if (diffEuro < 0) {
                cell.style.color = 'red'; // Rouge
            } else {
                cell.style.color = ''; // Couleur par d√©faut (g√©n√©ralement noire)
            }


        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// Fonction pour remplir le tableau du retour sur investissement en % par action
function fillReturnInPercent(diffPercentList) {
    // S√©lectionner tous les √©l√©ments <td> avec l'ID "price"
    var priceCells = document.querySelectorAll('#perf-percent');

    // Parcourir chaque √©l√©ment <td> et mettre √† jour son contenu avec le prix correspondant
    priceCells.forEach(function(cell, index) {
        // V√©rifier si l'index est valide dans le tableau stockPrices
        if (index < stocksPrice.length) {
            // Mettre √† jour le contenu de la cellule avec le prix correspondant
            cell.textContent = diffPercentList[index];

            // Changer la couleur du texte en fonction de la valeur
            const diffPercent = parseFloat(diffPercentList[index]);
            if (diffPercent > 0) {
                cell.style.color = 'green'; // Vert
            } else if (diffPercent < 0) {
                cell.style.color = 'red'; // Rouge
            } else {
                cell.style.color = ''; // Couleur par d√©faut (g√©n√©ralement noire)
            }

        } else {
            // Afficher un message d'erreur si l'index est en dehors des limites du tableau
            console.error('Index out of range for stock prices array.');
        }
    });
}

// fonction pour calculer le poids en pourcentage de chaque action du portefeuille
function calculateWeightOfStocks(finalValueOfStocks,finalValue) {

    for (let i = 0; i < tickerOfShares.length; i++){
        var toAdd = Number((finalValueOfStocks[i] / finalValue).toFixed(3));
        weightOfStocks.push(toAdd);
    }
}

// fonction pour calculer le score pond√©r√© de chaque crit√®re de mon portefeuille
function calculateWeightedAverage(stocksCotation) {
        const numberOfStocks = stocksCotation.length;
        const numberOfSectors = stocksCotation[0].length;

        for (let i = 0; i < numberOfSectors; i++) {
            let totalWeightedSum = 0;
            let totalWeight = 0;

            for (let j = 0; j < numberOfStocks; j++) {
                totalWeightedSum += stocksCotation[j][i] * weightOfStocks[j];
                totalWeight += weightOfStocks[j];
            }
            weightedAverages.push(Number((totalWeightedSum / totalWeight).toFixed(2)));
        }
    }

// fonction permettant de remplir le tableau futureYears (du nombre des 10 prochaines ann√©es)
function calculateFutureYears() {

    var currentYear = years[(years.length)-1];

    for (let i = 0; i < 10; i++){
        futureYears.push(currentYear);
        currentYear++;
    }
}

// Fonction pour calculer le pourcentage pond√©r√© d'augmentation des dividendes
function calculateWeightedDividendGrowth(stocksDividendGrowth, weightOfStocks) {
    let weightedDividendGrowth = 0; // Initialisation locale

    for (let i = 0; i < stocksDividendGrowth.length; i++) {
        weightedDividendGrowth += stocksDividendGrowth[i] * weightOfStocks[i];
    }

    weightedDividendGrowth = parseFloat(weightedDividendGrowth.toFixed(2));

    return weightedDividendGrowth; // Retourne la valeur calcul√©e
}

// fonction permettant de calculer le montant en dividende re√ßu estim√© lors des 10 prochaines ann√©es
function calculateFutureDividends() {

    var growth = calculateWeightedDividendGrowth(stocksDividendGrowth,weightOfStocks);

    var tempDividendReceived  = totalDividend;
    futureDividendsReceived.push(tempDividendReceived); //dividendes bruts actuels la premi√®re ann√©e

    for (let i = 0; i < 10; i++){
        var toFill = tempDividendReceived + (tempDividendReceived * (growth/100));
        toFill = parseFloat(toFill.toFixed(2));
        tempDividendReceived = toFill;
        futureDividendsReceived.push(toFill);
    }
}


// GRAPHIQUES
// Donn√©es pour le premier graphique
function draw1(CashOnHand,finalValue) {
    var ctx = document.getElementById('1Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Cash dispo en ‚Ç¨', 'Placements en ‚Ç¨'],
            datasets: [{
                data: [CashOnHand, finalValue],
                backgroundColor: [
                    'rgba(255, 215, 0, 0.5)', // Couleur pour Cash On Hand
                    'rgba(54, 162, 235, 0.5)'  // Couleur pour Final Value
                ],
                borderColor: [
                    'rgba(255, 215, 0, 1)', // Couleur de bordure pour Cash On Hand
                    'rgba(54, 162, 235, 1)'  // Couleur de bordure pour Final Value
                ],
                borderWidth: 1
            }]
        },
        options: {
            cutout: '60%',
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display:true,
                    position:'bottom'
                },
                title : {
                    display:true,
                    text:'Cash disponible VS placement en actions',
                    position : 'top',
                    font: {
                        size: 12
                    }
                }
            }
        }
    });
}

function draw2(totalInvested,diffEuro) {
    var ctx = document.getElementById('2Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Argent Investi en ‚Ç¨', 'Gain Total en ‚Ç¨'],
            datasets: [{
                data: [totalInvested, diffEuro],
                backgroundColor: [
                    'rgba(200, 200, 200, 0.5)', // Couleur pour totalInvested
                    'rgba(0,99,27, 0.5)'  // Couleur pour Gain
                ],
                borderColor: [
                    'rgba(200, 200, 200, 1)', // Couleur de bordure pour totalInvested
                    'rgba(0,99,27, 1)'  // Couleur de bordure pour Gain
                ],
                borderWidth: 1
            }]
        },
        options: {
            cutout: '60%',
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display:true,
                    position:'bottom'
                },
                title : {
                    display:true,
                    text:'Source de la valeur actuelle du Portefeuille',
                    position : 'top',
                    font: {
                        size: 12
                    }
                }
            }
        }
    });
}

function draw3(finalValueOfStocks) {
    var ctx = document.getElementById('3Chart').getContext('2d');

    var averageData = Array(tickerOfShares.length).fill(averageValuePerStocks);

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label:'Valeur par action',
                data: finalValueOfStocks,
                backgroundColor: [
                    // 'rgba(54, 162, 235, 0.5)',
                    'rgba(0, 128, 128, 0.5)',
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(128, 0, 128, 0.5)',
                    'rgba(255, 143, 0, 0.5)',
                    'rgba(210, 180, 140, 0.5)',
                    'rgba(255, 205, 86, 0.5)'
                ],
                borderColor: [
                    // 'rgba(54, 162, 235, 1)',
                    'rgba(0, 128, 128, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(128, 0, 128, 1)',
                    'rgba(255, 143, 0, 1)',
                    'rgba(210, 180, 140, 1)',
                    'rgba(255, 205, 86, 1)'
                ],
                borderWidth: 2
            },
            {
                type: 'line',
                label: 'Valeur Moyenne',
                data: averageData,
                backgroundColor: 'rgba(255, 99, 132, 0.2)', // Couleur de fond pour la ligne
                borderColor: 'rgba(255, 99, 132, 1)', // Couleur de la bordure pour la ligne
                borderWidth: 3,
                borderDash: [5, 5], // Utilisez un trait pointill√©
                fill: false, // Ne pas remplir l'espace sous la ligne
                spanGaps:true,
                pointRadius: 0, // Aucun point pour la ligne constante
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Valeur Totale par action en ‚Ç¨',
                    position : 'top',
                    font: {
                        size: 14
                    }
                }
            },
            scales: {
                x: {
                    type: 'category',
                    labels: tickerOfShares,
                    offset: true // Pour que la ligne commence et se termine aux bords du graphique
                }
            }
        }
    });
}

function draw4(diffListEuro) {
    var ctx = document.getElementById('4Chart').getContext('2d');

    var backgroundColors = [];
    var borderColors = [];

    for (var i = 0; i < diffListEuro.length; i++) {
        if (diffListEuro[i] >= 0) {
            // Si la valeur est positive, utiliser la couleur verte
            backgroundColors.push('rgba(0, 99, 27,0.5)'); // Vert
            borderColors.push('rgba(0, 99, 27, 1)'); // Bordure verte
        } else {
            // Si la valeur est n√©gative, utiliser la couleur rouge
            backgroundColors.push('rgba(255, 99, 132, 0.5)'); // Rouge
            borderColors.push('rgba(255, 99, 132, 1)'); // Bordure rouge
        }
    }

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares, // Assurez-vous que tickerOfShares est d√©fini quelque part
            datasets: [{
                label:'Retour en ‚Ç¨',
                data: diffListEuro,
                backgroundColor: backgroundColors,
                borderColor: borderColors,
                borderWidth: 2,
                yAxisID:'euro-y-axis'
            },
            {
                label: 'Retour en %',
                data: diffPercentList,
                backgroundColor: 'rgba(0, 128, 128,0.25)', // Bleu
                borderColor: 'rgba(0, 128, 128, 1)', // Bordure bleue
                borderWidth: 2,
                type: 'line', // Utiliser un graphique de type ligne
                fill:true,
                yAxisID:'percent-y-axis',
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Retour sur investissement par action',
                    position : 'top',
                    font: {
                        size: 14
                    }
                }
            }
            ,scales: {
                'euro-y-axis': {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    ticks: {
                        beginAtZero: true
                    }
                },
                'percent-y-axis': {
                    type: 'linear',
                    display: true, // Cacher l'axe Y des pourcentages
                    position: 'right',
                    ticks: {
                        beginAtZero: true
                    },
                    grid: {
                        drawOnChartArea: false // Emp√™cher les lignes de la grille sur le graphique
                    }
                }
            },
        }
    });
}


function draw5(totalDividendPerShares) {
    var ctx = document.getElementById('5Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label:'Dividende par action',
                data: totalDividendPerShares,
                backgroundColor: [
                    'rgba(51, 70, 79,0.5)'
                ],
                borderColor: [
                    'rgba(51, 70, 79, 1)'
                ],
                borderWidth: 2
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Dividendes re√ßu par action en ‚Ç¨',
                    position : 'top',
                    font: {
                        size: 14
                    }
                }
            }
        }
    });
}


function draw6(yieldOfShares) {

    var averageYieldOfWallet = Array(yieldOfShares.length).fill(yieldOfWallet);

    var ctx = document.getElementById('6Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label:'Rendement',
                data: yieldOfShares,
                backgroundColor: [
                    'rgba(54, 162, 235, 0.5)',
                    'rgba(0, 128, 128, 0.5)', // Nouvelle couleur
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(128, 0, 128, 0.5)',
                    'rgba(255, 143, 0, 0.5)',
                    'rgba(210, 180, 140, 0.5)',
                    'rgba(255, 205, 86, 0.5)'
                ],
                borderColor: [
                    'rgba(54, 162, 235, 1)',
                    'rgba(0, 128, 128, 1)', // Nouvelle couleur
                    'rgba(255, 99, 132, 1)',
                    'rgba(128, 0, 128, 1)',
                    'rgba(255, 143, 0, 1)',
                    'rgba(210, 180, 140, 1)',
                    'rgba(255, 205, 86, 1)'
                ],
                borderWidth: 3,
                fill:true
            }, {
                type: 'line',
                label: 'Rendement Portefeuille',
                data: averageYieldOfWallet,
                
                borderColor: 'rgba(255, 99, 132, 1)', // Rouge pour la ligne moyenne
                borderWidth: 3,
                borderDash: [5, 5], // Style de la ligne en pointill√©
                fill:false,
                pointRadius: 0, // Aucun point pour la ligne constante
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Rendement par action en %',
                    position : 'top',
                    font: {
                        size: 14
                    }
                }
            }
        }
    });
}


function draw7(dividendData) {
    var ctx = document.getElementById('7Chart').getContext('2d');

    var dividendASML = dividendData.map(data => data[0]);
    var dividendGOOGL = dividendData.map(data => data[1]);
    var dividendMA = dividendData.map(data => data[2]);
    var dividendMSFT = dividendData.map(data => data[3]);
    var dividendSPGI = dividendData.map(data => data[4]);
    var dividendV = dividendData.map(data => data[5]);

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: months,
            datasets: [
                {
                    label: 'ASML',
                    data: dividendASML,
                    backgroundColor: 'rgba(0, 128, 128, 0.5)', // Couleur pour ASML
                    borderColor: 'rgba(0, 128, 128, 1)',
                    borderWidth: 2
                },
                {
                    label: 'GOOGL',
                    data: dividendGOOGL,
                    backgroundColor: 'rgba(255, 99, 132, 0.5)', // Couleur pour GOOGL
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2
                },
                {
                    label: 'MA',
                    data: dividendMA,
                    backgroundColor: 'rgba(128, 0, 128, 0.5)', // Couleur pour MA
                    borderColor: 'rgba(128, 0, 128, 1)',
                    borderWidth: 2
                },
                {
                    label: 'MSFT',
                    data: dividendMSFT,
                    backgroundColor: 'rgba(255, 143, 0, 0.5)', // Couleur pour MSFT
                    borderColor: 'rgba(255, 143, 0, 1)',
                    borderWidth: 2
                },
                {
                    label: 'SPGI',
                    data: dividendSPGI,
                    backgroundColor: 'rgba(210, 180, 140, 0.5)', // Couleur pour SPGI
                    borderColor: 'rgba(210, 180, 140, 1)',
                    borderWidth: 2
                },
                {
                    label: 'V',
                    data: dividendV,
                    backgroundColor: 'rgba(255, 205, 86, 0.5)', // Couleur pour V
                    borderColor: 'rgba(255, 205, 86, 1)',
                    borderWidth: 2
                },

            ]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: 'Dividendes mensuels bruts par action en ‚Ç¨',
                    position: 'top',
                    font: {
                        size: 16
                    }
                },
            },
            scales: {
                x: {
                    stacked: true
                },
                y: {
                    stacked: true
                }
            },
        }
    });
}


function draw8(stocksPrice) {
    var ctx = document.getElementById('8Chart').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: tickerOfShares,
            datasets: [{
                label : 'PRU',
                data: pruOfShares,
                backgroundColor: [
                    'rgba(214, 0, 0, 0.5)',
                ],
                borderColor: [
                    'rgba(214, 0, 0, 1)',
                ],
                borderWidth: 2,
            },{
                label : "Prix de l'action",
                data: stocksPrice,
                fill: '-1',
                backgroundColor: [
                    'rgba(0, 99, 27, 0.5)',
                ],
                borderColor: [
                    'rgba(0, 99, 27, 1)',
                ],
                borderWidth: 2,
            }]
            
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Prix des actions VS PRU en $',
                    position : 'top',
                    font: {
                        size: 16
                    }
                }
            },
        }
    });
}


function draw9() {
    var ctx = document.getElementById('9Chart').getContext('2d');

    // D√©finition des couleurs en fonction de la valeur
    var backgroundColors = annualReturnEuro.map(value => value >= 0 ? 'rgba(0, 99, 27, 0.5)' : 'rgba(255, 99, 132, 0.5)');
    var borderColors = annualReturnEuro.map(value => value >= 0 ? 'rgba(0, 99, 27, 1)' : 'rgba(255, 99, 132, 1)');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: years, // Utilisation de la liste "years" pour l'axe x
            datasets: [{
                label: 'Retour Annuel en ‚Ç¨',
                data: annualReturnEuro,
                backgroundColor: backgroundColors, // Utilisation des couleurs d√©finies
                borderColor: borderColors, // Utilisation des couleurs de bordure d√©finies
                borderWidth: 2,
                yAxisID: 'euro-y-axis', // Utilisation de l'axe Y des euros
            },
            {
                label: 'Retour Annuel en %',
                data: annualReturnPercent,
                type: 'line', // Type de graphique en ligne pour les pourcentages
                fill: true, // Pas de remplissage sous la ligne
                borderColor: 'rgba(0, 10, 156, 1)', // Couleur de la ligne pour les pourcentages
                borderWidth: 2,
                yAxisID: 'percent-y-axis', // Utilisation de l'axe Y des pourcentages
                hidden:  false, // Cacher la ligne des pourcentages par d√©faut
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: 'Retours Annuel en Euros et Pourcentage par an', // Modification du titre du graphique
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                'euro-y-axis': {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    ticks: {
                        beginAtZero: true
                    }
                },
                'percent-y-axis': {
                    type: 'linear',
                    display: true,
                    position: 'right',
                    ticks: {
                        beginAtZero: true
                    },
                    grid: {
                        drawOnChartArea: false // Emp√™cher les lignes de la grille sur le graphique
                    }
                }
            },
        }
    });
}


function draw10(annualInvested,walletEndYear) {
    var ctx = document.getElementById('10Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: years,
            datasets: [{
                label : 'Montant Investi en ‚Ç¨',
                data: annualInvested,
                backgroundColor: [
                    'rgba(200, 200, 200, 0.5)',
                ],
                fill:true,
                borderColor: [
                    'rgba(200, 200, 200, 1)',
                ],
                borderWidth: 1,
            },{
                label : 'Valeur du Portefeuille en ‚Ç¨',
                data: walletEndYear,
                backgroundColor: [
                    'rgba(0, 99, 27, 0.5)',
                ],
                fill:true,
                borderColor: [
                    'rgba(0, 99, 27, 1)',
                ],
                borderWidth: 2,
                fill:'-1'
            }
            
        ]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display : true,
                    position : 'bottom'
                },
                title : {
                    display:true,
                    text:'Montant Investi VS Valeur du Portefeuille par an',
                    position : 'top',
                    font: {
                        size: 16
                    }
                }
            }
        }
    });
}


function draw11(annualDividendReceived) {
    var ctx = document.getElementById('11Chart').getContext('2d');

    // Calculer les pourcentages de variation d'une ann√©e √† l'autre
    var percentageChanges = [0];
    for (var i = 1; i < annualDividendReceived.length; i++) {
        var change = ((annualDividendReceived[i] - annualDividendReceived[i - 1]) / annualDividendReceived[i - 1]) * 100;
        percentageChanges.push(parseFloat(change.toFixed(2))); // Convertir la cha√Æne en nombre flottant
    }

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: years,
            datasets: [{
                label: 'Dividende Nets re√ßus en ‚Ç¨',
                data: annualDividendReceived,
                backgroundColor: 'rgba(0, 17, 255, 0.5)',
                borderColor: 'rgba(0, 17, 255, 1)',
                borderWidth: 2,
                yAxisID:'dividend-amount'
            }, {
                label: 'Variation en %',
                data: percentageChanges,
                type: 'line',
                fill: true,
                borderColor: 'rgba(102, 2, 60, 1)', // Rouge pour la ligne de variation
                borderWidth: 2,
                yAxisID:'percent-variation',
                hidden:true
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: 'Dividendes Nets re√ßus par an',
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                'dividend-amount': {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    ticks: {
                        beginAtZero: true
                    }
                },
                'percent-variation': {
                    type: 'linear',
                    display: true, // Cacher l'axe Y des pourcentages
                    position: 'right',
                    ticks: {
                        beginAtZero: true
                    },
                    grid: {
                        drawOnChartArea: false // Emp√™cher les lignes de la grille sur le graphique
                    }
                }
            }
        }
    });
}


function draw13(stocksCotation) {
    var ctx = document.getElementById('13Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'ScoreCard Mastercard',
                data: stocksCotation,
                backgroundColor: 'rgba(128, 0, 128, 0.5)',
                borderColor: 'rgba(128, 0, 128, 1)',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: "ScoreCard de l'Action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}


function draw14(stocksCotation) {
    var ctx = document.getElementById('14Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'ScoreCard Microsoft',
                data: stocksCotation,
                backgroundColor: 'rgba(255, 143, 0, 0.5)',
                borderColor: 'rgba(255, 143, 0, 1)',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: "ScoreCard de l'Action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}


function draw15(stocksCotation) {
    var ctx = document.getElementById('15Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'ScoreCard Visa',
                data: stocksCotation,
                backgroundColor: 'rgba(255, 205, 86, 0.5)',
                borderColor: 'rgba(255, 205, 86, 1)',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: "ScoreCard de l'Action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}


function draw16(stocksCotation) {
    var ctx = document.getElementById('16Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [
                {
                    label: 'Bases',
                    data: [stocksCotation[0][0], stocksCotation[1][0], stocksCotation[2][0], stocksCotation[3][0],stocksCotation[4][0], stocksCotation[5][0]],
                    backgroundColor: 'rgba(255, 99, 132, 0.5)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2
                },
                {
                    label: 'Croissance',
                    data: [stocksCotation[0][1], stocksCotation[1][1], stocksCotation[2][1], stocksCotation[3][1],stocksCotation[4][1], stocksCotation[5][1]],
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                },
                {
                    label: 'Rentabilit√©',
                    data: [stocksCotation[0][2], stocksCotation[1][2], stocksCotation[2][2], stocksCotation[3][2],stocksCotation[4][2], stocksCotation[5][2]],
                    backgroundColor: 'rgba(255, 205, 86, 0.5)',
                    borderColor: 'rgba(255, 205, 86, 1)',
                    borderWidth: 2
                },
                {
                    label: 'Solvabilit√©',
                    data: [stocksCotation[0][3], stocksCotation[1][3], stocksCotation[2][3], stocksCotation[3][3],stocksCotation[4][3], stocksCotation[5][3]],
                    backgroundColor: 'rgba(75, 192, 192, 0.5)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2
                },
                {
                    label: 'Dividende',
                    data: [stocksCotation[0][4], stocksCotation[1][4], stocksCotation[2][4], stocksCotation[3][4],stocksCotation[4][4], stocksCotation[5][4]],
                    backgroundColor: 'rgba(153, 102, 255, 0.5)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 2
                }
            ]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Qualit√© par segment de chaque action en %",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                x: {
                    stacked: true,
                },
                y: {
                    stacked: true,
                    // max:500
                }
            }
        }
    });
}


function draw17(stocksCotations) {
    var ctx = document.getElementById('17Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [
                {
                    label: 'ASML',
                    data: stocksCotations[0],
                    backgroundColor: 'rgba(0, 128, 128, 0.5)',
                    borderColor: 'rgba(0, 128, 128, 1)',
                    tension: 0.5,
                },
                {
                    label: 'GOOGL',
                    data: stocksCotations[1],
                    backgroundColor: 'rgba(255, 99, 132, 0.5)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    tension: 0.5,
                },
                {
                    label: 'MA',
                    data: stocksCotations[2],
                    backgroundColor: 'rgba(128, 0, 128, 0.5)',
                    borderColor: 'rgba(128, 0, 128, 1)',
                    tension: 0.5
                },
                {
                    label: 'MSFT',
                    data: stocksCotations[3],
                    backgroundColor: 'rgba(255, 143, 0, 0.5)',
                    borderColor: 'rgba(255, 143, 0, 1)',
                    tension: 0.5
                },
                {
                    label: 'SPGI',
                    data: stocksCotations[4],
                    backgroundColor: 'rgba(210, 180, 140, 0.5)',
                    borderColor: 'rgba(210, 180, 140, 1)',
                    tension: 0.5
                },
                {
                    label: 'V',
                    data: stocksCotations[5],
                    backgroundColor: 'rgba(255, 205, 86, 0.5)',
                    borderColor: 'rgba(255, 205, 86, 1)',
                    tension: 0.5
                }
            ]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Qualit√© des actions par segment en %",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 120,
                stepSize: 20
            }
        }
    });
}


function draw18(totalDividendReceived,totalGainWithoutDividend){
    var ctx = document.getElementById('18Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Dividendes en ‚Ç¨','Plus-Value en ‚Ç¨'],
            datasets: [{
                data: [totalDividendReceived, totalGainWithoutDividend],
                backgroundColor: [
                    'rgba(46, 204, 113, 0.5)',
                    'rgba(0, 128, 0, 0.5)'
                ],
                borderColor: [
                    'rgba(46, 204, 113, 1)',
                    'rgba(39, 174, 96, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            cutout: '60%',
            maintainAspectRatio: false,
            plugins: {
                legend : {
                    display:true,
                    position:'bottom'
                },
                title : {
                    display:true,
                    text:'Provenance des gains du Portefeuille',
                    position : 'top',
                    font: {
                        size: 12
                    }
                }
            }
        }
    });
}


function draw19(annualReturnPercent, annualMarketReturnPercent) {
    var ctx = document.getElementById('19Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: years, // Utiliser la liste des ann√©es comme √©tiquettes de l'axe X
            datasets: [{
                label: 'Performance du Portefeuille en %',
                data: annualReturnPercent,
                backgroundColor: 'rgba(255, 160, 122, 0.5)',
                borderColor: 'rgba(255, 160, 122, 1)',
                borderWidth: 2,
            }, {
                label: 'Performance du S&P500 en %',
                data: annualMarketReturnPercent,
                backgroundColor: 'rgba(176, 196, 222, 0.5)',
                borderColor: 'rgba(176, 196, 222, 1)',
                borderWidth: 2
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: 'Retours Annuel du Portefeuille et du S&P 500',
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                x: {
                    stacked: false
                },
                y: {
                    stacked: false
                }
            }
        }
    });
}


function draw20(weightedAverages) {
    var ctx = document.getElementById('20Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'polarArea',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'Score Pond√©r√©',
                data: weightedAverages,
                backgroundColor: [
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(54, 162, 235, 0.5)',
                    'rgba(255, 205, 86, 0.5)',
                    'rgba(75, 192, 192, 0.5)',
                    'rgba(153, 102, 255, 0.5)',
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 205, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                ],
                borderWidth: 2
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "ScoreCard pond√©r√© du Portefeuille",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}


function draw21(stocksCotation) {
    var ctx = document.getElementById('21Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'ScoreCard S&P Global',
                data: stocksCotation,
                backgroundColor: 'rgba(210, 180, 140, 0.5)',
                borderColor: 'rgba(210, 180, 140, 1)',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: "ScoreCard de l'Action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}


function draw22(StocksScore) {
    // Calcul de la moyenne des scores
    const averageScore = StocksScore.reduce((a, b) => a + b, 0) / StocksScore.length;

    // G√©n√©rer un tableau constant pour afficher la ligne moyenne
    const averageData = new Array(StocksScore.length).fill(averageScore);

    var ctx = document.getElementById('22Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: tickerOfShares,
            datasets: [
                {
                    label: "Score global de l'action",
                    data: StocksScore,
                    backgroundColor: 'rgba(50, 205, 50, 0.35)',
                    borderColor: 'rgba(50, 205, 50, 1)',        
                    borderWidth: 1
                },
                {
                    type: 'line', // Ajout de la ligne pour la moyenne
                    label: 'Score Moyen',
                    data: averageData,
                    backgroundColor: 'rgba(255, 99, 132, 0.2)', // Couleur de fond pour la ligne
                    borderColor: 'rgba(255, 99, 132, 1)', // Couleur de la bordure pour la ligne
                    borderWidth: 3,
                    borderDash: [5, 5], // Trait pointill√©
                    fill: false, // Pas de remplissage sous la ligne
                    spanGaps: true,
                    pointRadius: 0 // Aucun point sur la ligne
                }
            ]
        },
        options: {
            indexAxis: 'y', // D√©finit un graphique √† barres horizontal
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Score Global de Qualit√© de chaque action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                x: {
                    beginAtZero: true,
                    max: 30, //valeur maximale de l'axe X
                    title: {
                        display: false,
                        text: "Score Global"
                    }
                },
                y: {
                    title: {
                        display: false,
                        text: "Ticker"
                    }
                }
            }
        }
    });
}


function draw23(dividendPerMonth, dividendPerMonthNet) {

    var ctx = document.getElementById('23Chart').getContext('2d');
    
    // Cr√©er un graphique √† barres
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: months, // Axe X: les mois
            datasets: [
                {
                    label: 'Montant Brut', // L√©gende pour les dividendes bruts
                    data: dividendPerMonth, // Les valeurs des dividendes bruts
                    backgroundColor: 'rgba(0, 51, 204, 0.5)', // Bleu plus fonc√© pour le montant brut
                    borderColor: 'rgba(0, 51, 204, 1)', // Bordure du bleu plus fonc√©
                    borderWidth: 1
                },
                {
                    label: 'Montant Net', // L√©gende pour les dividendes nets
                    data: dividendPerMonthNet, // Les valeurs des dividendes nets
                    backgroundColor: 'rgba(0, 123, 255, 0.5)', // Utiliser la couleur actuelle du brut pour le net
                    borderColor: 'rgba(0, 123, 255, 1)', // Utiliser la couleur actuelle du brut pour le net
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Dividendes bruts & nets re√ßus par mois en ‚Ç¨",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                x: {
                    title: {
                        display: false,
                        text: "Mois"
                    }
                },
                y: {
                    beginAtZero: true,
                    title: {
                        display: false,
                        text: "Montant des Dividendes"
                    }
                }
            },
            // Espacement des barres
            // barPercentage: 0.4, // R√©duit la largeur des barres
            // categoryPercentage: 0.5 // Espacement entre les barres
        }
    });
}


function draw24(stocksCotation) {
    var ctx = document.getElementById('24Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'ScoreCard Google',
                data: stocksCotation,
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                borderColor: 'rgba(128, 0, 128, 1)',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: "ScoreCard de l'Action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}


function draw25(stocksCotation) {
    var ctx = document.getElementById('25Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Bases', 'Croissance', 'Rentabilit√©', 'Solvabilit√©', 'Dividende'],
            datasets: [{
                label: 'ScoreCard ASML',
                data: stocksCotation,
                backgroundColor: 'rgba(0, 128, 128, 0.5)',
                borderColor: 'rgba(0, 128, 128, 1)',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: "ScoreCard de l'Action",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scale: {
                ticks: {
                    beginAtZero: true,
                },
                min: 0,
                max: 100,
                stepSize: 20
            }
        }
    });
}

// Fonction pour calculer le prix juste de l'action
function calculateFairPrice(safetyMargin){
    for (var i = 0; i < stocksPERatio.length; i++) {
        var medianPrice = (gurufocusPrice[i] + tipsrankPrice[i]) / 2;
        var fairPrice = medianPrice * (1 - safetyMargin);
        fairPrice = parseFloat(fairPrice.toFixed(2));
        stocksFairPrice.push(fairPrice);
    }
}

// Fonction pour calculer le score de valorisation final
function calculateValuationScore(){

    for (var i = 0; i < stocksPERatio.length; i++) {
        var currentDiffPrice = - ((stocksFairPrice[i] - stocksPrice[i])/stocksPrice[i]);
        var currentDiffPERatio = (stocksPERatio[i] - tenyearsPERatio[i]) / tenyearsPERatio[i]; 

        var finalScore = ((currentDiffPERatio * 100) + (currentDiffPrice * 100));
        finalScore = parseFloat(finalScore.toFixed(2));
        valuationScore.push(finalScore);
    }
}

function draw26(tickerOfShares, stocksPrice, stocksFairPrice,gurufocusPrice,tipsrankPrice) {
    var ctx = document.getElementById('26Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'bar', // Type de graphique principal
        data: {
            labels: tickerOfShares,
            datasets: [
                {
                    label: "Prix Actuel de l'action",
                    type: 'bar', // Barres pour le prix actuel
                    data: stocksPrice,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                },
                {
                    label: "Prix Juste de l'action",
                    type: 'bar', // Ligne pour le prix juste
                    data: stocksFairPrice,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                },
                {
                label: "Prix GuruFocus",
                    type: 'line', // Ligne pour GuruFocus
                    data: gurufocusPrice,
                    borderColor: 'rgba(75, 192, 192, 1)', // Vert-bleu
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(75, 192, 192, 1)', // Couleur des points
                    fill: false, // Pas de remplissage sous la ligne
                    tension: 0.2 // Douceur de la courbe
                },
                {
                    label: "Prix TipsRank",
                    type: 'line', // Ligne pour TipsRank
                    data: tipsrankPrice,
                    borderColor: 'rgba(255, 159, 64, 1)', // Orange vif
                    borderWidth:2,
                    backgroundColor: 'rgba(255, 159, 64, 0.2)', // Couleur de remplissage sous la ligne
                    fill: false, // Pas de remplissage sous la ligne
                    tension: 0.2 // Douceur de la courbe
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true, // Affiche la l√©gende
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Prix actuel vs prix juste des actions (avec marge de s√©curit√©)",
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true // Commence l'axe Y √† 0
                }
            }
        }
    });
}


function draw27(tickerOfShares, stocksPERatio, tenyearsPERatio) {
    var ctx = document.getElementById('27Chart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line', // Type de graphique
        data: {
            labels: tickerOfShares, // Axe X : tickers des actions
            datasets: [
                {
                    label: "PE Ratio Actuel",
                    data: stocksPERatio,
                    borderColor: 'rgba(153, 102, 255, 1)', // Violet
                    backgroundColor: 'rgba(153, 102, 255, 0.2)', // Couleur de remplissage sous la ligne
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(153, 102, 255, 1)', // Couleur des points
                    tension: 0.2,
                    fill:true
                },
                {
                    label: "PE Ratio M√©dian (10 ans)",
                    data: tenyearsPERatio,
                    borderColor: 'rgba(255, 205, 86, 1)', // Jaune-orang√©
                    backgroundColor: 'rgba(255, 205, 86, 0.2)', // Couleur de remplissage sous la ligne
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(255, 205, 86, 1)', // Couleur des points
                    tension: 0.2,
                    fill:true
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "PE Ratio Actuel vs M√©dian (10 ans)",
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: false // Commence l'axe Y √† une valeur adapt√©e
                }
            }
        }
    });
}


function draw28(tickerOfShares, valuationScore) {
    var ctx = document.getElementById('28Chart').getContext('2d');

    // Fonction pour g√©n√©rer une couleur sombre en d√©grad√© du vert fonc√© au rouge fonc√©
    function getColor(value, min, max) {
        const ratio = (value - min) / (max - min);
        const red = Math.round(139 + 116 * ratio); // De 139 (vert fonc√©) √† 255 (rouge fonc√©)
        const green = Math.round(69 + 116 * (1 - ratio)); // De 69 (rouge fonc√©) √† 185 (vert fonc√©)
        return `rgba(${red}, ${green}, 64, 0.7)`; // Couleur avec une opacit√© mod√©r√©e (0.7)
    }

    // Trouver les valeurs minimale et maximale dans valuationScore
    const minValue = Math.min(...valuationScore);
    const maxValue = Math.max(...valuationScore);

    // G√©n√©rer les couleurs pour chaque barre
    const barColors = valuationScore.map(value => getColor(value, minValue, maxValue));

    var myChart = new Chart(ctx, {
        type: 'bar', // Type de graphique
        data: {
            labels: tickerOfShares, // Axe X : tickers des actions
            datasets: [
                {
                    label: "Score de Valorisation",
                    data: valuationScore,
                    backgroundColor: barColors, // Couleurs dynamiques
                    borderColor: barColors.map(color => color.replace('0.7', '1')), // Bordures opaques
                    borderWidth: 2
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Score de Valorisation par Action",
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}


function draw29(futureYears, futureDividendsReceived) {
    var ctx = document.getElementById('29Chart').getContext('2d');
    
    // Cr√©er les couleurs pour chaque barre
    var backgroundColors = futureYears.map((year, index) => 
        index === 0 ? 'rgba(0, 51, 204, 0.5)' : 'rgba(0, 51, 204, 0.25)'
    );

    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: futureYears,
            datasets: [
                {
                    label: 'Montant Brut Estim√©', 
                    data: futureDividendsReceived, 
                    backgroundColor: backgroundColors, 
                    borderColor: 'rgba(0, 51, 204, 1)', 
                    borderWidth: 1
                },
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Projection des dividendes re√ßus lors des 10 prochaines ann√©es",
                    position: 'top',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                x: {
                    title: {
                        display: false,
                        text: "Mois"
                    }
                },
                y: {
                    beginAtZero: true,
                    title: {
                        display: false,
                        text: "Montant des Dividendes"
                    }
                }
            },
        }
    });
}


function calculateSPYReturn(currentValue, startValue) {
    var returnPercent = ((currentValue - startValue) / startValue) * 100;
    return parseFloat(returnPercent.toFixed(2));
}


// Fonction d'interpolation qui ralentit sur les derniers pourcentages
function easeOutCubic(t) {
    return (--t) * t * t + 1;
}

// Fonction pour animer la barre de progression de mani√®re fluide avec une transition ralentie
function animateProgressBar(progressBar, finalValue, goal) {
    let startTime;
    const duration = 2000; // Dur√©e de l'animation en millisecondes

    // R√©cup√©rer la valeur actuelle de la barre de progression
    const currentValue = progressBar.value;

    // Calculer le pas de progression en fonction de la dur√©e et de la diff√©rence entre les valeurs actuelle et finale
    const step = (finalValue - currentValue) / 100;

    function updateProgress(timestamp) {
        // Initialiser le temps de d√©part au premier appel de la fonction
        if (!startTime) startTime = timestamp;

        // Calculer le temps √©coul√© depuis le d√©but de l'animation
        const elapsedTime = timestamp - startTime;

        // Calculer le pourcentage d'avancement en fonction du temps √©coul√©
        let progress = Math.min(elapsedTime / duration, 1); // Limiter le progr√®s √† 1

        // Appliquer une fonction d'interpolation pour ralentir sur les derniers pourcentages
        progress = easeOutCubic(progress);

        // Calculer la valeur interpol√©e entre la valeur actuelle et la valeur finale
        const interpolatedValue = currentValue + (finalValue - currentValue) * progress;

        // Mettre √† jour la valeur de la barre de progression
        progressBar.value = interpolatedValue;

        // V√©rifier si l'animation doit continuer
        if (elapsedTime < duration) {
            // Continuer l'animation en appelant la fonction de mise √† jour √† la prochaine trame d'animation
            requestAnimationFrame(updateProgress);
        }
    }

    // D√©marrer l'animation en appelant la fonction de mise √† jour pour la premi√®re fois
    requestAnimationFrame(updateProgress);
}


// Fonction pour remplir la premi√®re barre de progression
function fillFirstProgressBar(totalWallet, goal) {
    const firstProgressBar = document.getElementById('firstProgressBar');
    const progressText = document.getElementById('firstProgressText');
    firstProgressBar.max = goal;
    const percentage = ((totalWallet / goal) * 100).toFixed(2);
    progressText.textContent = percentage + "%";
    animateProgressBar(firstProgressBar, totalWallet, goal);
}

// Fonction pour remplir la deuxi√®me barre de progression
function fillSecondProgressBar(current, goal) {
    const secondProgressBar = document.getElementById('secondProgressBar');
    const progressText = document.getElementById('secondProgressText');
    secondProgressBar.max = goal;
    const percentage = ((current / goal) * 100).toFixed(2);

    progressText.textContent = percentage + "%";
    animateProgressBar(secondProgressBar, current, goal);
}


// Appel de la fonction pour r√©cup√©rer les prix de toutes les actions
async function main() {

    await getAllStockPrices();
    const exchangeRate = await getExchangeRate();
    await getAllPERatios();

    const currentPrice = await getCurrentSPYPrice("SPY");
    console.log("Current SPY price:", currentPrice);
    const startPrice = await getStartSPYPrice();
    console.log("Start SPY price:", startPrice);
    const spyReturn = calculateSPYReturn(currentPrice, startPrice);
    console.log("SPY return:", spyReturn);

    finalValue = totalValue * exchangeRate;
    document.getElementById("wallet-value").textContent = finalValue.toFixed(2);

    totalWallet = finalValue + CashOnHand;
    document.getElementById("total-value").textContent = totalWallet.toFixed(2);

    diffEuro = totalWallet - totalInvested;
    document.getElementById("return-euro").textContent = diffEuro.toFixed(2);

    diffPercent = (diffEuro / totalInvested) * 100;
    document.getElementById("return-percent").textContent = diffPercent.toFixed(2) + "%";

    diffPerformance = calculatePerformanceForAllStocks(stocksPrice, pruOfShares, numberOfShares);

    const diffListEuro = diffPerformance.diffList.map(diff => Number((diff * exchangeRate).toFixed(2)));

    calculateTotalDividendPerShare(exchangeRate);
    calculateYieldOfShares();

    calculateDividendPerMonth(); //calcul des dividendes bruts par mois
    calculateNetDividendPerMonth(); //calcul des dividendes nets par mois

    document.getElementById("total-div").textContent = totalDividend.toFixed(2);

    yieldOfWallet = Number((totalDividend/totalWallet)*100);

    document.getElementById("yield-wallet").textContent = yieldOfWallet.toFixed(2) + "%";

    averageValuePerStocks = finalValue / tickerOfShares.length;

    calculateStackedDividendPerMonth();

    calculateFairPrice(0.10);
    calculateValuationScore();


    // PERF ANN√âE EN COURS
    var tempStartYear = 8946.56;
    var tempInvested = 10100;
    tempReturnEuro = parseFloat((totalWallet - (tempInvested + tempStartYear)).toFixed(2));
    tempReturnPercent = parseFloat(((tempReturnEuro / (tempInvested + tempStartYear)) * 100).toFixed(2));
    var tempDividendReceived = 49.92;

    annualReturnEuro.push(tempReturnEuro);
    annualReturnPercent.push(tempReturnPercent);
    annualDividendReceived.push(tempDividendReceived);
    annualInvested.push(totalInvested);
    walletEndYear.push(parseFloat(totalWallet.toFixed(2)));
    console.log("before :" + annualMarketReturnPercent);
    annualMarketReturnPercent.push(spyReturn);
    console.log("after :" + annualMarketReturnPercent);


    var totalDividendReceived = ((annualDividendReceived.reduce((acc, val) => acc + val, 0))).toFixed(2); //somme de la liste annualDividendReceived
    totalGainWithoutDividend = (diffEuro - totalDividendReceived).toFixed(2); //le gain total en plus-value = gain total - dividendes nets re√ßus


    //CHANGER COULEURS
    changeBackgroundColor(diffEuro, diffPercent);


    //REMPLIR TABLEAUX
    fillStockPrices();
    fillAveragePrices();
    fillNumberOfShares();
    fillValueOfStocks(stocksPrice, exchangeRate);
    fillReturnInEuros(diffListEuro);
    fillReturnInPercent(diffPercentList);


    //OBTENIR POIDS DE CHAQUE ACTIONS
    calculateWeightOfStocks(finalValueOfStocks,finalValue);
    calculateWeightedAverage(stocksCotation);

    calculateFutureYears();
    calculateFutureDividends();


    //REMPLIR BARRES DE PROGRESSION
    fillFirstProgressBar(totalWallet, 25000);
    fillSecondProgressBar(tempDividendReceived, 60);


    //DESSINER GRAPHES
    draw1(CashOnHand, finalValue);
    draw2(totalInvested, diffEuro);
    draw3(finalValueOfStocks);
    draw4(diffListEuro);
    draw5(totalDividendPerShares);
    draw6(yieldOfShares);
    draw7(dividendData);
    draw8(stocksPrice,pruOfShares);
    draw9();
    draw10(annualInvested, walletEndYear);
    draw11(annualDividendReceived);
    draw13(MACotation);
    draw14(MSFTCotation);
    draw15(VCotation);
    draw16(stocksCotation);
    draw17(stocksCotation);
    draw18(totalDividendReceived,totalGainWithoutDividend);
    draw19(annualReturnPercent,annualMarketReturnPercent);
    draw20(weightedAverages);
    draw21(SPGICotation);
    draw22(stocksScore);
    draw23(dividendPerMonth,dividendPerMonthNet);
    draw24(GOOGLCotation);
    draw25(ASMLCotation);
    draw26(tickerOfShares, stocksPrice,stocksFairPrice,gurufocusPrice,tipsrankPrice);
    draw27(tickerOfShares,stocksPERatio,tenyearsPERatio);
    draw28(tickerOfShares,valuationScore);
    draw29(futureYears,futureDividendsReceived);

}

main();


    </script>
</body>
</html>