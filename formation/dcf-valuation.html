<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de Valeur Intrins√®que (DCF) | StocksPickeur</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet">
    
    <link rel="icon" href="../media/Logo/logo-black.ico" type="image/x-icon">

    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2, h3, h4, .font-heading { font-family: 'Plus Jakarta Sans', sans-serif; }
        
        /* Styles personnalis√©s pour les inputs (identique au pr√©c√©dent) */
        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
            background-color: #f8fafc;
            transition: all 0.2s;
            color: #1e293b;
            font-weight: 500;
        }
        .input-field:focus {
            outline: none;
            border-color: #10b981; /* Emerald-500 pour ce th√®me */
            background-color: #ffffff;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        .input-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        /* Slider vert pour ce th√®me */
        input[type=range] {
            accent-color: #059669; 
        }
    </style>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QFGNT3V2F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-5QFGNT3V2F');
    </script>
</head>
<body class="bg-slate-50 text-slate-600 antialiased">

    <header class="fixed w-full z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                
                <a href="../index.html" class="flex items-center gap-3 group">
                    <img src="../media/Logo/Logo-White.png" alt="Logo StocksPickeur" class="h-10 w-auto filter invert group-hover:opacity-80 transition"> 
                    <span class="font-heading font-bold text-xl text-slate-900 tracking-tight">StocksPickeur</span>
                </a>

                <div class="hidden md:flex items-center gap-8">
                    <nav class="flex gap-6">
                        <a href="../calculator.html" class="text-sm font-medium text-slate-600 hover:text-emerald-600 transition">Calculateur</a>
                        <a href="../portfolio.html" class="text-sm font-medium text-slate-600 hover:text-emerald-600 transition">Portefeuille</a>
                        <a href="../moatpicks.html" class="text-sm font-medium text-slate-600 hover:text-emerald-600 transition">Analyses</a>
                        <a href="../formation.html" class="text-sm font-medium text-slate-600 hover:text-emerald-600 transition">Formation</a>
                    </nav>

                    <div class="h-6 w-px bg-slate-200"></div>

                    <a href="#.html" class="bg-slate-900 text-white text-sm font-bold px-5 py-2.5 rounded-full hover:bg-slate-800 transition shadow-lg shadow-slate-900/20 flex items-center gap-2 transform hover:-translate-y-0.5">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                        </svg>
                        Connexion
                    </a>
                </div>

                <div class="md:hidden">
                    <button class="text-slate-500 hover:text-slate-900">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="pt-32 pb-24 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">

        <nav class="flex text-sm text-slate-400 mb-8" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2">
                <li><a href="../formation.html" class="hover:text-emerald-600 transition">Formation</a></li>
                <li>/</li>
                <li><a href="5.0.html" class="hover:text-emerald-600 transition">Module 5</a></li>
                <li>/</li>
                <li class="text-emerald-600 font-medium">Calculateur DCF</li>
            </ol>
        </nav>

        <div class="text-center mb-12">
            <h1 class="text-3xl md:text-4xl font-heading font-extrabold text-slate-900 mb-4">Calculateur de Valeur Intrins√®que üíé</h1>
            <p class="text-lg text-slate-500 max-w-2xl mx-auto">
                Combien vaut r√©ellement cette action ? Utilisez la m√©thode Discounted Cash Flow (DCF) pour trouver le "Juste Prix" et comparer avec le prix du march√©.
            </p>
        </div>

        <div class="grid lg:grid-cols-12 gap-8">
            
            <div class="lg:col-span-4 space-y-6">
                <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                    <h3 class="font-bold text-slate-900 text-lg mb-6 border-b border-slate-100 pb-4 flex items-center">
                        <span class="bg-emerald-100 text-emerald-600 w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs">1</span> 
                        Les Donn√©es
                    </h3>
                    
                    <div class="mb-4">
                        <label class="input-label">Prix Actuel de l'Action (‚Ç¨/$)</label>
                        <input type="number" id="currentPrice" class="input-field" placeholder="Ex: 150">
                    </div>

                    <div class="mb-4">
                        <label class="input-label">FCF par Action (Ann√©e 0)</label>
                        <input type="number" id="fcfShare" class="input-field" placeholder="Ex: 5.50">
                        <p class="text-xs text-slate-400 mt-1">Free Cash Flow divis√© par le nombre d'actions.</p>
                    </div>

                    <h3 class="font-bold text-slate-900 text-lg mt-8 mb-6 border-b border-slate-100 pb-4 flex items-center">
                        <span class="bg-emerald-100 text-emerald-600 w-6 h-6 rounded-full flex items-center justify-center mr-2 text-xs">2</span> 
                        Vos Hypoth√®ses
                    </h3>

                    <div class="mb-4">
                        <label class="input-label flex justify-between">
                            Croissance (Ann√©es 1-5)
                            <span class="text-emerald-600 font-bold" id="growthDisplay">10%</span>
                        </label>
                        <input type="range" id="growthRate" min="0" max="30" value="10" step="0.5" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <div class="mb-4">
                        <label class="input-label flex justify-between">
                            Taux d'Actualisation (WACC)
                            <span class="text-emerald-600 font-bold" id="discountDisplay">10%</span>
                        </label>
                        <input type="range" id="discountRate" min="5" max="20" value="10" step="0.5" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <div class="mb-6">
                        <label class="input-label flex justify-between">
                            Multiple de Sortie (An 5)
                            <span class="text-emerald-600 font-bold" id="exitMultipleDisplay">15x</span>
                        </label>
                        <input type="range" id="exitMultiple" min="5" max="40" value="15" step="1" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                        <p class="text-xs text-slate-400 mt-1">A combien de fois les b√©n√©fices revendrez-vous l'action dans 5 ans ?</p>
                    </div>

                    <button onclick="calculateDCF()" class="w-full bg-emerald-600 text-white font-bold py-3 px-4 rounded-xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-200 transform active:scale-95">
                        Calculer la Valeur üîç
                    </button>
                </div>
            </div>

            <div class="lg:col-span-8 space-y-6">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 shadow-lg text-center text-white relative overflow-hidden">
                        <div class="relative z-10">
                            <div class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Valeur Intrins√®que</div>
                            <div class="text-4xl font-heading font-bold text-white" id="resIntrinsic">--</div>
                            <div class="text-xs text-slate-400 mt-2">Le "Juste Prix" th√©orique</div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm text-center relative overflow-hidden" id="verdictCard">
                        <div class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Marge de S√©curit√©</div>
                        <div class="text-4xl font-heading font-bold text-slate-300" id="resMargin">--%</div>
                        <div class="text-sm font-bold mt-2 text-slate-400" id="resVerdict">En attente de donn√©es...</div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                    <h4 class="font-bold text-slate-900 mb-4 flex items-center">
                        <span class="mr-2">üìä</span> Projection des Flux
                    </h4>
                    <div class="h-[300px]">
                        <canvas id="dcfChart"></canvas>
                    </div>
                </div>

                <div class="bg-emerald-50 p-6 rounded-2xl border border-emerald-100">
                    <h4 class="font-bold text-emerald-900 mb-2">Analyse du calcul</h4>
                    <p class="text-sm text-emerald-800 text-justify leading-relaxed" id="analysisText">
                        Entrez les donn√©es √† gauche pour lancer l'analyse. Nous allons projeter les flux de tr√©sorerie sur 5 ans, les actualiser (les ramener √† leur valeur d'aujourd'hui) et ajouter la valeur de revente estim√©e.
                    </p>
                </div>

            </div>

        </div>

    </main>

    <footer class="bg-slate-950 py-12 border-t border-slate-900">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center gap-3 mb-6 opacity-60 filter grayscale hover:grayscale-0 transition duration-500">
                 <img src="../media/Logo/Logo-White.png" alt="Logo" class="h-8">
            </div>
            
            <div class="max-w-4xl mx-auto text-xs text-slate-500 leading-relaxed mb-8">
                <strong class="text-slate-400">Avertissement :</strong> Ce calculateur est un outil p√©dagogique. Il ne constitue pas un conseil en investissement. Les r√©sultats d√©pendent enti√®rement de vos hypoth√®ses. Faites vos propres recherches.
            </div>

            <p class="text-slate-600 text-sm font-medium">
                &copy; 2026 StocksPickeur. Fait avec passion en Belgique üáßüá™
            </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // Initialisation des variables DOM
        const currentPriceInput = document.getElementById('currentPrice');
        const fcfInput = document.getElementById('fcfShare');
        
        const growthInput = document.getElementById('growthRate');
        const growthDisplay = document.getElementById('growthDisplay');
        
        const discountInput = document.getElementById('discountRate');
        const discountDisplay = document.getElementById('discountDisplay');
        
        const exitInput = document.getElementById('exitMultiple');
        const exitDisplay = document.getElementById('exitMultipleDisplay');
        
        let dcfChart = null;

        // Synchronisation des sliders
        growthInput.addEventListener('input', function() { growthDisplay.textContent = this.value + "%"; });
        discountInput.addEventListener('input', function() { discountDisplay.textContent = this.value + "%"; });
        exitInput.addEventListener('input', function() { exitDisplay.textContent = this.value + "x"; });

        function calculateDCF() {
            // 1. R√©cup√©ration des valeurs
            const price = parseFloat(currentPriceInput.value);
            const fcfBase = parseFloat(fcfInput.value);
            const growth = parseFloat(growthInput.value) / 100;
            const discount = parseFloat(discountInput.value) / 100;
            const exitMult = parseFloat(exitInput.value);

            // Validation simple
            if (!fcfBase || fcfBase <= 0) {
                alert("Veuillez entrer un FCF par action valide.");
                return;
            }

            // 2. Le Calcul DCF
            let currentFCF = fcfBase;
            let sumPV = 0;
            
            // Tableaux pour le graphique
            const labels = [];
            const dataFuture = []; // Valeur nominale
            const dataPresent = []; // Valeur actualis√©e

            // Phase de croissance (5 ans)
            for(let year = 1; year <= 5; year++) {
                currentFCF = currentFCF * (1 + growth); // Croissance
                let pv = currentFCF / Math.pow(1 + discount, year); // Actualisation
                
                sumPV += pv;
                
                labels.push("Ann√©e " + year);
                dataFuture.push(currentFCF);
                dataPresent.push(pv);
            }

            // Valeur Terminale (Exit Multiple)
            // On revend √† la fin de l'ann√©e 5
            let terminalValue = currentFCF * exitMult; 
            let pvTerminal = terminalValue / Math.pow(1 + discount, 5); // On ram√®ne la revente √† aujourd'hui

            // Ajout au graphique (Barre sp√©ciale pour la revente)
            labels.push("Revente (An 5)");
            dataFuture.push(terminalValue); // C'est √©norme visuellement, peut √©craser le graphe, mais c'est la r√©alit√©
            dataPresent.push(pvTerminal);

            let intrinsicValue = sumPV + pvTerminal;

            // 3. Affichage des R√©sultats
            const formatter = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR', maximumFractionDigits: 2 });
            
            document.getElementById('resIntrinsic').textContent = formatter.format(intrinsicValue);

            // Marge de S√©curit√© & Verdict
            if (price > 0) {
                const margin = ((intrinsicValue - price) / intrinsicValue) * 100;
                const verdictCard = document.getElementById('verdictCard');
                const resVerdict = document.getElementById('resVerdict');
                const resMargin = document.getElementById('resMargin');

                resMargin.textContent = margin.toFixed(1) + "%";

                if (margin > 0) {
                    // Sous-√©valu√© (Bon)
                    resMargin.className = "text-4xl font-heading font-bold text-emerald-600";
                    resVerdict.textContent = "SOUS-√âVALU√âE (Opportunit√©)";
                    resVerdict.className = "text-sm font-bold mt-2 text-emerald-600 uppercase";
                    verdictCard.className = "bg-white p-6 rounded-xl border-2 border-emerald-100 shadow-sm text-center relative overflow-hidden";
                } else {
                    // Sur√©valu√© (Mauvais)
                    resMargin.className = "text-4xl font-heading font-bold text-red-500";
                    resVerdict.textContent = "SUR√âVALU√âE (Trop cher)";
                    resVerdict.className = "text-sm font-bold mt-2 text-red-500 uppercase";
                    verdictCard.className = "bg-white p-6 rounded-xl border-2 border-red-100 shadow-sm text-center relative overflow-hidden";
                }

                // Texte explicatif
                const sharePV = (sumPV / intrinsicValue * 100).toFixed(0);
                const shareTerminal = (pvTerminal / intrinsicValue * 100).toFixed(0);
                
                document.getElementById('analysisText').innerHTML = `
                    Selon vos hypoth√®ses, l'action vaut <strong>${formatter.format(intrinsicValue)}</strong>.<br><br>
                    Notez que <strong>${shareTerminal}%</strong> de cette valeur provient de la revente finale (Terminal Value), et seulement <strong>${sharePV}%</strong> provient des cash flows des 5 prochaines ann√©es.<br>
                    Cela montre √† quel point votre estimation du "Multiple de Sortie" (actuellement ${exitMult}x) est cruciale.
                `;

            } else {
                document.getElementById('resMargin').textContent = "--%";
                document.getElementById('resVerdict').textContent = "Entrez un prix actuel";
            }

            // 4. Mise √† jour Graphique
            updateChart(labels, dataFuture, dataPresent);
        }

        function updateChart(labels, future, present) {
            const ctx = document.getElementById('dcfChart').getContext('2d');

            if (dcfChart) {
                dcfChart.destroy();
            }

            dcfChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Valeur Actualis√©e (Ce que √ßa vaut aujourd\'hui)',
                            data: present,
                            backgroundColor: '#059669', // Emerald-600
                            borderRadius: 6,
                            order: 1
                        },
                        {
                            label: 'Valeur Nominale (Montant Futur)',
                            data: future,
                            backgroundColor: '#cbd5e1', // Slate-300
                            borderRadius: 6,
                            hidden: true // On le cache par d√©faut car la Terminal Value √©crase tout, mais dispo au clic
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Un petit calcul par d√©faut pour l'exemple au chargement
        // On attend que Chart.js soit charg√©
        // Pas de calcul auto pour laisser l'utilisateur le faire, mais on initialise les displays
    </script>
</body>
</html>