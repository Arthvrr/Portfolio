<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Score de Qualit√© & Int√©r√™ts Compos√©s üìä</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="media/Logo/logo.ico" type="image/x-icon">
</head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5QFGNT3V2F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5QFGNT3V2F');
</script>
<body>
    <header>
        <a href="index.html" class="logo-title-link">
            <img src="./media/Logo/Logo-White.png" alt="Logo QualityInvest">
            <h1>StocksPickeur</h1>
        </a>
        <div class="onglets">
            <a href="calculator.html">Calculateur</a>
            <a href="resources.html">Ressources</a>
            <a href="wallet.html">Portefeuille</a>
        </div>
    </header>

    <div class="calculator-home">

        <h2 class="title-home">Score de Qualit√© üìä</h2>
        <p class="calculator-text-home">Bienvenue sur mon outil de calcul du score de qualit√© d‚Äôune action ! Ce calcul repose sur une analyse approfondie de 15 crit√®res financiers et strat√©giques sp√©cifiques, qui permettent d‚Äô√©valuer solidit√©,croissance et rentabilit√© d‚Äôune action. Chaque crit√®re est pond√©r√© et contribue √† un score global sur 30 points. <br> Ce score vous permettra de mieux comprendre les forces et faiblesses d‚Äôune action afin de prendre des d√©cisions d‚Äôinvestissement plus √©clair√©es. Ce sont les 15 crit√®res que j'utilise √† l'heure actuelle pour analyser mes propres actions. Vous pouvez retrouver le score des actions de mon portefeuille ici : <a class="link-to-wallet" href="./wallet.html#quality">Score de qualit√© des actions de mon Portefeuille ‚öîÔ∏è</a> </p>
        <div class="ticker-input-container">
            <input type="text" id="stockTicker" class="ticker-input" placeholder="Entrez le ticker (ex: AAPL)" autocomplete="off">
            <div class="safety-margin-container">
                <label>Marge de s√©curit√©: <span id="safetyMarginValue">10</span>%</label>
                <div class="slider-container">
                    <div class="slider-track">
                        <div class="slider-fill"></div>
                        <input type="range" min="0" max="6" value="2" step="1" class="slider" list="markers" id="safetyMarginSlider">
                        <div class="slider-marks">
                            <span class="mark" style="left: 0%">0%</span>
                            <span class="mark" style="left: 16.66%">5%</span>
                            <span class="mark" style="left: 33.33%">10%</span>
                            <span class="mark" style="left: 50%">15%</span>
                            <span class="mark" style="left: 66.66%">20%</span>
                            <span class="mark" style="left: 83.33%">30%</span>
                            <span class="mark" style="left: 100%">50%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section" id="bases">
            <h3 class="calculator-section">BASES</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text" data-tooltip="V√©rifie si l'action a perform√© mieux que l'indice S&P 500 sur les 5 derni√®res ann√©es.">COURS DE L'ACTION BATS LE S&P500 SUR 5 ANS</p>
                    <input type="text" class="calc-input" placeholder="Oui/Non">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="L'entreprise rach√®te-t-elle ses propres actions ?">L'ENTREPRISE EFFECTUE DES RACHATS D'ACTIONS</p>
                    <input type="text" class="calc-input" placeholder="Oui/Non">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="L'entreprise d√©pend-elle d'un seul produit ou client ?">LE CHIFFRE D'AFFAIRES DE LA SOCI√âT√â EST DIVERSIFI√â</p>
                    <input type="text" class="calc-input" placeholder="Oui/Non">
                </div>
            </div>
        </div>
    
        <div class="section" id="croissance">
            <h3 class="calculator-section">CROISSANCE</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text" data-tooltip="Moyenne de croissance annuelle du chiffre d'affaires sur 10 ans.">CROISSANCE DU CHIFFRE D'AFFAIRES SUR 10 ANS</p>
                    <input type="number" class="calc-input" placeholder="Nombre d'ann√©es" min="0" max="10">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Croissance du B√©n√©fice Par Action (EPS).">CROISSANCE DU B√âN√âFICE PAR ACTION SUR 10 ANS</p>
                    <input type="number" class="calc-input" placeholder="Nombre d'ann√©es" min="0" max="10">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Le Free Cash Flow est l'argent r√©el qui reste dans la poche.">CROISSANCE DU FREE CASH FLOW SUR 10 ANS</p>
                    <input type="number" class="calc-input" placeholder="Nombre d'ann√©es" min="0" max="10">
                </div>
            </div>
        </div>

        <div class="section" id="rentabilit√©">
            <h3 class="calculator-section">RENTABILIT√â</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text" data-tooltip="Pourcentage de chiffre d'affaires transform√© en b√©n√©fice net.">MARGE NETTE</p>
                    <input type="number" class="calc-input" placeholder="En pourcentage (%)" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Pourcentage de chiffre d'affaires transform√© en cash flow libre.">FCF MARGIN</p>
                    <input type="number" class="calc-input" placeholder="En pourcentage (%)" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Return on Invested Capital.">ROIC</p>
                    <input type="number" class="calc-input" placeholder="En pourcentage (%)" step="0.01">
                </div>
            </div>
        </div>

        <div class="section" id="solvabilit√©">
            <h3 class="calculator-section">SOLVABILIT√â</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text" data-tooltip="Ratio dette/EBITDA.">DEBT-TO-EBITDA</p>
                    <input type="number" class="calc-input" placeholder="En nombre flottant" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Ratio dette/capitaux propres.">DEBT-TO-EQUITY</p>
                    <input type="number" class="calc-input" placeholder="En nombre flottant" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Couverture des int√©r√™ts.">COUVERTURE DES INT√âR√äTS</p>
                    <input type="number" class="calc-input" placeholder="En nombre flottant" step="0.01">
                </div>
            </div>
        </div>

        <div class="section" id="dividende">
            <h3 class="calculator-section">DIVIDENDE</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text" data-tooltip="Part des b√©n√©fices revers√©e en dividende.">PAYOUT RATIO</p>
                    <input type="number" class="calc-input" placeholder="En pourcentage (%)" min="0"  step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Part du Free Cash Flow utilis√©e pour payer le dividende.">PAYOUT RATIO DU FCF</p>
                    <input type="number" class="calc-input" placeholder="En pourcentage (%)" min="0" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Croissance moyenne du dividende sur 5 ans.">CROISSANCE SUR 5 ANS</p>
                    <input type="number" class="calc-input" placeholder="En pourcentage (%)" min="0" step="0.01">
                </div>
            </div>
        </div>

        <div class="section" id="valorisation">
            <h3 class="calculator-section">VALORISATION</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">PRIX JUSTE GURUFOCUS</p>
                    <input type="number" id="gurufocusPrice" placeholder="En nombre flottant" min="0" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">PRIX JUSTE TIPSRANKS</p>
                    <input type="number" id="tipsrankPrice" placeholder="En nombre flottant" min="0" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">PER HISTORIQUE 10 ANS</p>
                    <input type="number" id="historicalPER" placeholder="En nombre flottant" min="0" step="0.01">
                </div>
            </div>
        </div>

        <button class="calculator-button">G√©n√©rer l'Analyse</button>

        <div id="progress-container-circle" style="display: none;">
            <circle-progress id="circular-progress" max="30" value="0"></circle-progress>
            <p class="score-text" id="score-text">Le score total de votre action est de 0 sur 30 !</p>
        </div>

        <div id="radar-chart-container" style="display: none; align-items: center;">
            <canvas id="radarChart"></canvas>
        </div>

        <div id="bar-chart-container" style="display: none; align-items: center;">
            <canvas id="priceChart"></canvas>
        </div>

        <div class="separator-line"></div>

        <h2 class="title-home">Int√©r√™ts Compos√©s üöÄ</h2>
        <p class="calculator-text-home" style="margin-bottom: 30px;">Projetez vos gains futurs ! Voyez comment votre √©pargne fructifie ann√©e apr√®s ann√©e gr√¢ce √† la magie des int√©r√™ts compos√©s.</p>

        <div class="section" id="compound-calculator">
            <h3 class="calculator-section">PARAM√àTRES DE L'INVESTISSEMENT</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text" data-tooltip="Combien comptez-vous investir chaque ann√©e ?">MONTANT ANNUEL D√âPOS√â (‚Ç¨/$)</p>
                    <input type="number" id="compound-deposit" class="compound-input" placeholder="Ex: 12000" min="0">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Pendant combien d'ann√©es allez-vous investir ?">DUR√âE (ANN√âES)</p>
                    <input type="number" id="compound-years" class="compound-input" placeholder="Ex: 20" min="1" max="100">
                </div>
                <div class="input-group">
                    <p class="label-text" data-tooltip="Quel rendement annuel moyen esp√©rez-vous ? (La bourse fait ~8-10% historiquement)">RENDEMENT ANNUEL (%)</p>
                    <input type="number" id="compound-rate" class="compound-input" placeholder="Ex: 8" step="0.1">
                </div>
            </div>
        </div>

        <button class="calculator-button" id="btn-compound-calc">Calculer les Int√©r√™ts</button>

        <div id="compound-results-container" style="display:none;">
            <div class="result-box">
                Dans <span id="res-years" style="font-weight:bold;">0</span> ans, vous aurez : <br>
                <span id="res-total" class="result-highlight">0 ‚Ç¨</span> <br>
                <span style="font-size: 0.9rem; color: #7f8c8d;">Dont <span id="res-invested" style="font-weight:bold;">0 ‚Ç¨</span> de votre poche et <span id="res-interests" style="font-weight:bold; color: #f39c12;">0 ‚Ç¨</span> d'int√©r√™ts gagn√©s.</span>
            </div>

            <div id="compound-chart-container" style="display: flex; align-items: center; margin-top: 30px; height: 400px;">
                <canvas id="compoundChart"></canvas>
            </div>
        </div>

    </div>

    <div class="footer">
        <div class="copyright">
            <img src="./media/Logo/Logo-Black.png" alt="Logo QualityInvest">
            <span id="copyright-text" ><a href="https://x.com/StocksPickeur" class="reset-link">StocksPickeur &copy; 2025</a></span>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-circle-progress/dist/circle-progress.min.js" type="module"></script>

<script>

    // --- VARIABLES GLOBALES ---
    var totalScore = 0;
    var basisScore = 0;
    var growthScore = 0;
    var profitabilityScore = 0;
    var solvencyScore = 0;
    var dividendScore = 0;

    var currentTicker = "AAPL"; 
    var currentStockPrice = null;
    var fairPrice = 0;
    var currentPERatio = null;
    var gurufocusPrice = 0;
    var tipsrankPrice = 0;
    var safetyMargin = 0.1;

    // Cl√© API Finnhub
    const FINNHUB_API_KEY = 'cfeip41r01qoicaf4hk0cfeip41r01qoicaf4hkg';

    var sectionName = ["Bases","Croissance","Rentabilit√©","Solvabilit√©","Dividende"];
    let radarChartInstance = null;
    let priceChartInstance = null;

    // --- UTILITAIRES ---
    function isValidNumber(value) {
        return !isNaN(value) && value !== null && value !== '';
    }

    function updatePrices() {
        gurufocusPrice = parseFloat(document.getElementById('gurufocusPrice').value) || 0;
        tipsrankPrice = parseFloat(document.getElementById('tipsrankPrice').value) || 0;
    }

    function updateSafetyMarginDisplay(value) {
        const marginValues = [0, 5, 10, 15, 20, 30, 50]; 
        const marginValue = marginValues[value];
        document.getElementById('safetyMarginValue').textContent = marginValue;
        return marginValue / 100;
    }

    // --- API ---
    async function getStockPrice(symbol) {
        try {
            const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${FINNHUB_API_KEY}`);
            const data = await response.json();
            if (data && data.c) { return data.c; }
            return null;
        } catch (error) {
            console.error('Erreur API Prix:', error);
            return null;
        }
    }

    async function getPERatio(symbol) {
        try {
            const response = await fetch(`https://finnhub.io/api/v1/stock/metric?symbol=${symbol}&metric=valuation&token=${FINNHUB_API_KEY}`);
            const data = await response.json();
            if (data.metric && data.metric.peNormalizedAnnual) {
                return parseFloat(data.metric.peNormalizedAnnual.toFixed(2));
            }
            return null;
        } catch (error) {
            console.error('Erreur API PE:', error);
            return null;
        }
    }

    // --- CALCULS SCORE ---
    function getData() {
        const inputs = document.querySelectorAll('.calc-input');
        const inputValues = [];
        inputs.forEach(input => inputValues.push(input.value.trim()));
        return inputValues;
    }

    function calculateBasis(inputValues){
        var beatsINX = inputValues[0].toLowerCase();
        var shareBuyback = inputValues[1].toLowerCase();
        var diversifiedCA = inputValues[2].toLowerCase();
        if (beatsINX == 'oui') { totalScore += 2; basisScore += 2; }
        if (shareBuyback == 'oui') { totalScore += 2; basisScore += 2; }
        if (diversifiedCA == 'oui') { totalScore += 2; basisScore += 2; }
        return basisScore;
    }

    function calculateGrowth(inputValues){
        var CAGrowth = parseFloat(inputValues[3]);
        var EPSGrowth = parseFloat(inputValues[4]);
        var FCFGrowth = parseFloat(inputValues[5]);
        if (CAGrowth > 7) { totalScore += 2; growthScore += 2; }
        if (EPSGrowth > 7) { totalScore += 2; growthScore += 2; }
        if (FCFGrowth > 7) { totalScore += 2; growthScore += 2; }
        return growthScore;
    }

    function calculateProfitability(inputValues){
        var netMargin = parseFloat(inputValues[6]);
        var fcfMargin = parseFloat(inputValues[7]);
        var roic = parseFloat(inputValues[8]);
        if (netMargin >= 35) { totalScore += 2; profitabilityScore += 2; }
        else if (netMargin >= 20) { totalScore += 1; profitabilityScore += 1; }
        if (fcfMargin >= 35) { totalScore += 2; profitabilityScore += 2; }
        else if (fcfMargin >= 20) { totalScore += 1; profitabilityScore += 1; }
        if (roic >= 30) { totalScore += 2; profitabilityScore += 2; }
        else if (roic >= 15) { totalScore += 1; profitabilityScore += 1; }
        return profitabilityScore;
    }

    function calculateSolvency(inputValues) {
        var debtToEBITDA = parseFloat(inputValues[9]);
        var debtToEquity = parseFloat(inputValues[10]);
        var interestCoverageRatio = parseFloat(inputValues[11]);
        if (isValidNumber(debtToEBITDA)) {
            if (debtToEBITDA < 1) { totalScore += 2; solvencyScore += 2; }
            else if (debtToEBITDA < 2) { totalScore += 1; solvencyScore += 1; }
        }
        if (isValidNumber(debtToEquity)) {
            if (debtToEquity < 1) { totalScore += 2; solvencyScore += 2; }
            else if (debtToEquity < 2) { totalScore += 1; solvencyScore += 1; }
        }
        if (isValidNumber(interestCoverageRatio)) {
            if (interestCoverageRatio >= 30) { totalScore += 2; solvencyScore += 2; }
            else if (interestCoverageRatio >= 15) { totalScore += 1; solvencyScore += 1; }
        }
        return solvencyScore;
    }

    function calculateDividend(inputValues) {
        var payoutRatio = parseFloat(inputValues[12]);
        var payoutRatioFCF = parseFloat(inputValues[13]);
        var dividendGrowth = parseFloat(inputValues[14]);
        if (isValidNumber(payoutRatio)) {
            if (payoutRatio < 30) { totalScore += 2; dividendScore += 2; }
            else if (payoutRatio < 50) { totalScore += 1; dividendScore += 1; }
        }
        if (isValidNumber(payoutRatioFCF)) {
            if (payoutRatioFCF < 30) { totalScore += 2; dividendScore += 2; }
            else if (payoutRatioFCF < 50) { totalScore += 1; dividendScore += 1; }
        }
        if (isValidNumber(dividendGrowth)) {
            if (dividendGrowth >= 10) { totalScore += 2; dividendScore += 2; }
            else if (dividendGrowth >= 5) { totalScore += 1; dividendScore += 1; }
        }
        return dividendScore;
    }

    function getFairPrice(gurufocusPrice, tipsrankPrice, safetyMargin) {
        const averagePrice = (gurufocusPrice + tipsrankPrice) / 2;
        fairPrice = averagePrice * (1 - safetyMargin);
        return fairPrice;
    }

    // --- GRAPHIQUES SCORE ---
    function createRadarChart(sectionScores) {
        const ctx = document.getElementById('radarChart').getContext('2d');
        if (radarChartInstance) {
            radarChartInstance.data.datasets[0].data = sectionScores;
            radarChartInstance.update();
        } else {
            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: sectionName,
                    datasets: [{
                        label: 'Score par Section',
                        data: sectionScores,
                        backgroundColor: 'rgba(53, 162, 235, 0.2)',
                        borderColor: 'rgba(53, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false }, title: { display: true, text: "ScoreCard de l'Action", font: { size: 16 } } },
                    scales: { r: { min: 0, max: 6, ticks: { stepSize: 1 } } },
                    elements: { line: { tension: 0 } }
                }
            });
        }
    }

    function createFairPriceChart(currentPrice, fairPrice) {
        const chartLabels = [currentTicker]; 
        const currentPriceData = [currentPrice];
        const fairPriceData = [fairPrice];
        const guruData = [gurufocusPrice];
        const tipsData = [tipsrankPrice];

        const ctx = document.getElementById('priceChart').getContext('2d');

        if (priceChartInstance) {
            priceChartInstance.data.labels = chartLabels;
            priceChartInstance.data.datasets[0].data = currentPriceData;
            priceChartInstance.data.datasets[1].data = fairPriceData;
            priceChartInstance.data.datasets[2].data = guruData;
            priceChartInstance.data.datasets[3].data = tipsData;
            priceChartInstance.update();
        } else {   
            priceChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartLabels,
                    datasets: [
                        {
                            label: "Prix Actuel",
                            type: 'bar',
                            data: currentPriceData,
                            backgroundColor: 'rgba(54, 162, 235, 0.5)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 2
                        },
                        {
                            label: "Prix Juste (Calcul√©)",
                            type: 'bar',
                            data: fairPriceData,
                            backgroundColor: 'rgba(255, 99, 132, 0.5)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2,
                        },
                        {
                            label: "Prix GuruFocus",
                            type: 'line',
                            data: guruData,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(75, 192, 192, 1)',
                            fill: false,
                            tension: 0.2,
                            pointRadius: 8
                        },
                        {
                            label: "Prix TipsRank",
                            type: 'line',
                            data: tipsData,
                            borderColor: 'rgba(255, 159, 64, 1)',
                            borderWidth: 2,
                            backgroundColor: 'rgba(255, 159, 64, 0.2)',
                            fill: false,
                            tension: 0.2,
                            pointRadius: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'bottom' },
                        title: { display: true, text: "Comparaison des Prix", font: { size: 16 } }
                    },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }
    }

    // --- EVENTS SCORE ---
    document.getElementById('gurufocusPrice').addEventListener('input', updatePrices);
    document.getElementById('tipsrankPrice').addEventListener('input', updatePrices);
    const slider = document.getElementById('safetyMarginSlider');
    slider.addEventListener('input', function() { safetyMargin = updateSafetyMarginDisplay(parseInt(this.value)); });
    slider.value = 2; 
    safetyMargin = updateSafetyMarginDisplay(2);

    document.getElementById('stockTicker').addEventListener('keypress', async function(e) {
        if (e.key === 'Enter') {
            const ticker = this.value.trim().toUpperCase();
            if (ticker) {
                this.placeholder = 'Chargement...';
                currentTicker = ticker;
                const price = await getStockPrice(ticker);
                const pe = await getPERatio(ticker);
                if (price) {
                    currentStockPrice = price;
                    currentPERatio = pe;
                    this.placeholder = `${ticker} charg√© (${price}$)`;
                } else {
                    this.placeholder = 'Erreur r√©cup√©ration prix';
                }
            }
        }
    });

    document.querySelector('.calculator-button').addEventListener('click', async function () {
        const tickerInput = document.getElementById('stockTicker');
        const tickerInputVal = tickerInput.value.trim().toUpperCase();

        if (tickerInputVal && (tickerInputVal !== currentTicker || currentStockPrice === null)) {
            currentTicker = tickerInputVal;
            tickerInput.placeholder = "Chargement...";
            const fetchedPrice = await getStockPrice(currentTicker);
            const fetchedPE = await getPERatio(currentTicker);
            if (fetchedPrice) {
                currentStockPrice = fetchedPrice;
                currentPERatio = fetchedPE;
                tickerInput.placeholder = `${currentTicker} charg√© (${fetchedPrice}$)`;
            }
        }

        if (currentStockPrice === null) currentStockPrice = 0;

        totalScore = 0; basisScore = 0; growthScore = 0; profitabilityScore = 0; solvencyScore = 0; dividendScore = 0;

        const inputValues = getData();
        calculateBasis(inputValues);
        calculateGrowth(inputValues);
        calculateProfitability(inputValues);
        calculateSolvency(inputValues);
        calculateDividend(inputValues);

        getFairPrice(gurufocusPrice, tipsrankPrice, safetyMargin);
        
        var sectionScores = [basisScore,growthScore,profitabilityScore,solvencyScore,dividendScore];

        const progressContainer = document.getElementById('progress-container-circle');
        progressContainer.style.display = 'block';
        const circleProgress = document.getElementById('circular-progress');
        circleProgress.setAttribute('value', totalScore); 
        circleProgress.setAttribute('max', 30); 
        const scoreText = document.getElementById('score-text');
        scoreText.textContent = `Le score de Qualit√© de votre action est de ${totalScore} sur 30 !`;

        document.getElementById('radar-chart-container').style.display = 'flex';
        createRadarChart(sectionScores);
        document.getElementById('bar-chart-container').style.display = 'flex';
        createFairPriceChart(currentStockPrice, fairPrice);
    });


    // ==========================================
    //       SCRIPT INT√âR√äTS COMPOS√âS (NOUVEAU)
    // ==========================================
    
    let compoundChartInstance = null;

    document.getElementById('btn-compound-calc').addEventListener('click', function() {
        // 1. R√©cup√©ration des valeurs
        const annualDeposit = parseFloat(document.getElementById('compound-deposit').value) || 0;
        const years = parseFloat(document.getElementById('compound-years').value) || 0;
        const rate = parseFloat(document.getElementById('compound-rate').value) || 0;

        if (years <= 0) {
            alert("Veuillez entrer une dur√©e valide (au moins 1 an).");
            return;
        }

        // 2. Calculs et pr√©paration des donn√©es pour le graphique
        const labels = [];
        const dataTotal = [];
        const dataInvested = [];
        
        let currentTotal = 0;
        let totalInvested = 0;

        for (let i = 1; i <= years; i++) {
            // On ajoute l'argent au d√©but de l'ann√©e (hypoth√®se simplifi√©e)
            totalInvested += annualDeposit;
            
            // On calcule les int√©r√™ts sur (Capital pr√©c√©dent + Nouveau d√©p√¥t)
            currentTotal = (currentTotal + annualDeposit) * (1 + (rate / 100));
            
            labels.push(`Ann√©e ${i}`);
            dataTotal.push(currentTotal);
            dataInvested.push(totalInvested);
        }

        const totalInterests = currentTotal - totalInvested;

        // 3. Affichage des r√©sultats textes (Format Mon√©taire)
        const formatter = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR', maximumFractionDigits: 0 });
        
        document.getElementById('res-years').textContent = years;
        document.getElementById('res-total').textContent = formatter.format(currentTotal);
        document.getElementById('res-invested').textContent = formatter.format(totalInvested);
        document.getElementById('res-interests').textContent = formatter.format(totalInterests);

        document.getElementById('compound-results-container').style.display = 'block';

        // 4. Cr√©ation / Mise √† jour du graphique
        const ctx = document.getElementById('compoundChart').getContext('2d');

        if (compoundChartInstance) {
            compoundChartInstance.destroy(); // On d√©truit l'ancien pour recr√©er proprement
        }

        compoundChartInstance = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Capital Investi (Vos d√©p√¥ts)',
                        data: dataInvested,
                        borderColor: 'rgba(52, 152, 219, 1)',
                        backgroundColor: 'rgba(52, 152, 219, 0.2)',
                        fill: true,
                        pointRadius: 0,
                        borderWidth: 2
                    },
                    {
                        label: 'Valeur Totale (Avec Int√©r√™ts)',
                        data: dataTotal,
                        borderColor: 'rgba(46, 204, 113, 1)',
                        backgroundColor: 'rgba(46, 204, 113, 0.2)', // Vert
                        fill: true, // Remplit l'espace sous la courbe
                        pointRadius: 0,
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Croissance de votre portefeuille',
                        font: { size: 16 }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(context.parsed.y);
                                }
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString('fr-FR') + ' ‚Ç¨';
                            }
                        }
                    }
                }
            }
        });

        // Scroll vers les r√©sultats
        document.getElementById('compound-results-container').scrollIntoView({ behavior: 'smooth' });
    });
</script>

</body>
</html>