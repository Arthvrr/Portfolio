<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Score de Qualit√© üìä</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="./media/Logo/Logo-Blue.png">
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5QFGNT3V2F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5QFGNT3V2F');
</script>
<body>
    <header>
        <a href="index.html" class="logo-title-link">
            <img src="./media/Logo/Logo-White.png" alt="Logo QualityInvest">
            <h1>StocksPickeur</h1>
        </a>
        <!-- MAX 3 ONGLETS -->
        <div class="onglets">
            <a href="calculator.html">Calculateur</a>
            <a href="wallet.html">Portefeuille</a>

        </div>
    </header>

    <!-- <h2 class="title-home">Calcule le score de Qualit√© d'une action</h2> -->

    <div class="calculator-home">

        <p class="calculator-text-home">Bienvenue sur mon outil de calcul du score de qualit√© d‚Äôune action ! Ce calcul repose sur une analyse approfondie de 15 crit√®res financiers et strat√©giques sp√©cifiques, qui permettent d‚Äô√©valuer solidit√©,croissance et rentabilit√© d‚Äôune action. Chaque crit√®re est pond√©r√© et contribue √† un score global sur 30 points. <br> Ce score vous permettra de mieux comprendre les forces et faiblesses d‚Äôune action afin de prendre des d√©cisions d‚Äôinvestissement plus √©clair√©es. Ce sont les 15 crit√®res que j'utilise √† l'heure actuelle pour analyser mes propres actions. Vous pouvez retrouver le score des actions de mon portefeuille ici : <a class="link-to-wallet" href="./wallet.html#quality">Score de qualit√© des actions de mon Portefeuille ‚öîÔ∏è</a> </p>

        <div class="ticker-input-container">
            <input type="text" id="stockTicker" class="ticker-input" placeholder="Entrez le ticker (ex: AAPL)" autocomplete="off">
            <div class="safety-margin-container">
                <label>Marge de s√©curit√©: <span id="safetyMarginValue">10</span>%</label>
                <div class="slider-container">
                    <div class="slider-track">
                        <div class="slider-fill"></div>
                        <input type="range" 
                               min="0" 
                               max="6" 
                               value="1" 
                               step="1" 
                               class="slider" 
                               list="markers"
                               id="safetyMarginSlider">
                        <div class="slider-marks">
                            <span class="mark" style="left: 0%">0%</span>
                            <span class="mark" style="left: 16.66%">5%</span>
                            <span class="mark" style="left: 33.33%">10%</span>
                            <span class="mark" style="left: 50%">15%</span>
                            <span class="mark" style="left: 66.66%">20%</span>
                            <span class="mark" style="left: 83.33%">30%</span>
                            <span class="mark" style="left: 100%">50%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section" id="bases">
            <h3 class="calculator-section">BASES</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">COURS DE L'ACTION BATS LE S&P500 SUR 5 ANS</p>
                    <input type="text" placeholder="Oui/Non">
                </div>
                <div class="input-group">
                    <p class="label-text">L'ENTREPRISE EFFECTUE DES RACHATS D'ACTIONS</p>
                    <input type="text" placeholder="Oui/Non">
                </div>
                <div class="input-group">
                    <p class="label-text">LE CHIFFRE D'AFFAIRES DE LA SOCI√âT√â EST DIVERSIFI√â</p>
                    <input type="text" placeholder="Oui/Non">
                </div>
            </div>
        </div>
    
        <div class="section" id="croissance">
            <h3 class="calculator-section">CROISSANCE</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">CROISSANCE DU CHIFFRE D'AFFAIRES SUR 10 ANS</p>
                    <input type="number" placeholder="Nombre d'ann√©es" min="0" max="10">
                </div>
                <div class="input-group">
                    <p class="label-text">CROISSANCE DU B√âN√âFICE PAR ACTION SUR 10 ANS</p>
                    <input type="number" placeholder="Nombre d'ann√©es" min="0" max="10">
                </div>
                <div class="input-group">
                    <p class="label-text">CROISSANCE DU FREE CASH FLOW SUR 10 ANS</p>
                    <input type="number" placeholder="Nombre d'ann√©es" min="0" max="10">
                </div>
            </div>
        </div>

        <div class="section" id="rentabilit√©">
            <h3 class="calculator-section">RENTABILIT√â</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">MARGE NETTE</p>
                    <input type="number" placeholder="En pourcentage (%)" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">FCF MARGIN</p>
                    <input type="number" placeholder="En pourcentage (%)" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">ROIC</p>
                    <input type="number" placeholder="En pourcentage (%)" step="0.01">
                </div>
            </div>
        </div>

        <div class="section" id="solvabilit√©">
            <h3 class="calculator-section">SOLVABILIT√â</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">DEBT-TO-EBITDA</p>
                    <input type="number" placeholder="En nombre flottant" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">DEBT-TO-EQUITY</p>
                    <input type="number" placeholder="En nombre flottant" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">COUVERTURE DES INT√âR√äTS</p>
                    <input type="number" placeholder="En nombre flottant" step="0.01">
                </div>
            </div>
        </div>

        <div class="section" id="dividende">
            <h3 class="calculator-section">DIVIDENDE</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">PAYOUT RATIO</p>
                    <input type="number" placeholder="En pourcentage (%)" min="0"  step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">PAYOUT RATIO DU FCF</p>
                    <input type="number" placeholder="En pourcentage (%)" min="0" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">CROISSANCE SUR 5 ANS</p>
                    <input type="number" placeholder="En pourcentage (%)" min="0" step="0.01">
                </div>
            </div>
        </div>
        <div class="section" id="valorisation">
            <h3 class="calculator-section">VALORISATION</h3>
            <div class="input-container">
                <div class="input-group">
                    <p class="label-text">PRIX JUSTE GURUFOCUS</p>
                    <input type="number" id="gurufocusPrice" placeholder="En nombre flottant" min="0" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">PRIX JUSTE TIPSRANKS</p>
                    <input type="number" id="tipsrankPrice" placeholder="En nombre flottant" min="0" step="0.01">
                </div>
                <div class="input-group">
                    <p class="label-text">PER HISTORIQUE 10 ANS</p>
                    <input type="number" id="historicalPER" placeholder="En nombre flottant" min="0" step="0.01">
                </div>
            </div>
        </div>

        <button class="calculator-button">G√©n√©rer l'Analyse</button>

        <div id="progress-container-circle" style="display: none;">
            <circle-progress id="circular-progress" max="30" value="0"></circle-progress>
            <p class="score-text" id="score-text">Le score total de votre action est de 0 sur 30 !</p>
        </div>

        <div id="radar-chart-container" style="display: none; align-items: center;">
            <canvas id="radarChart"></canvas>
        </div>

        <div id="bar-chart-container" style="display: none; align-items: center;">
            <canvas id="priceChart"></canvas>
        </div>

    </div>

    <div class="footer">
        <div class="copyright">
            <img src="./media/Logo/Logo-Black.png" alt="Logo QualityInvest">
            <span id="copyright-text" ><a href="https://x.com/StocksPickeur" class="reset-link">StocksPickeur &copy; 2025</a></span>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-circle-progress/dist/circle-progress.min.js" type="module"></script>

    
    
    <script>

//D√âCLARATION DE VARIABLES
var totalScore; //Score total de l'action
var basisScore; //Score bases
var growthScore; //Score croissance
var profitabilityScore; //Score rentabilit√©
var solvencyScore; //Score solvabilit√©
var dividendScore; //Score dividende

// Variables pour stocker les donn√©es de l'action
var currentTicker = "AAPL";
var currentStockPrice = null;
var fairPrice = 0;

// Variables pour les prix justes
var gurufocusPrice = null;
var tipsrankPrice = null;

// Fonction pour r√©cup√©rer les valeurs des champs
function updatePrices() {
    gurufocusPrice = parseFloat(document.getElementById('gurufocusPrice').value) || 0;
    tipsrankPrice = parseFloat(document.getElementById('tipsrankPrice').value) || 0;
    
    // Vous pouvez ajouter ici du code pour utiliser ces valeurs
    console.log('Prix Gurufocus:', gurufocusPrice);
    console.log('Prix TipRanks:', tipsrankPrice);
}

// Fonction pour mettre √† jour la valeur affich√©e de la marge de s√©curit√©
function updateSafetyMarginDisplay(value) {
    const marginValues = [0, 5, 10, 15, 20, 30, 50]; // Correspond aux valeurs pour 0 √† 6
    const marginValue = marginValues[value];
    document.getElementById('safetyMarginValue').textContent = marginValue;
    return marginValue / 100; // Convertit en d√©cimal pour les calculs
}

// Gestionnaire d'√©v√©nement pour le curseur de marge de s√©curit√©
document.getElementById('safetyMarginSlider').addEventListener('input', function() {
    safetyMargin = updateSafetyMarginDisplay(parseInt(this.value));
});

// Initialisation de la marge de s√©curit√© au chargement de la page
document.getElementById('safetyMarginSlider').value = 2; // Position √† 2 pour 10%
safetyMargin = updateSafetyMarginDisplay(2); // Valeur par d√©faut (10%)

// √âcouteurs d'√©v√©nements pour mettre √† jour les valeurs lors de la saisie
document.getElementById('gurufocusPrice').addEventListener('input', updatePrices);
document.getElementById('tipsrankPrice').addEventListener('input', updatePrices);
var currentPERatio = null;
var currentTicker = '';
var safetyMargin = 0.1; // Valeur par d√©faut 10%

//D√âCLARATION DES TABLEAUX

//Tableau des scores des sections (pour le graphique en radar)
var sectionScores = [];

var sectionName = ["Bases","Croissance","Rentabilit√©","Solvabilit√©","Dividende"];
var criteria = ["Beats S&P 500 5yrs","Share Buyback","Diversified Revenue","Revenue Growth","EPS Growth","FCF Per Shares Growth","Net Margin","FCF Margin", "ROIC","Debt/EBITDA","Debt/Equity","Interest Coverage","Payout Ratio","Payout Ratio FCF","Dividend Growth 5yrs"];
var resultCriteria = [];

let radarChartInstance = null;
let priceChartInstance = null;

// Fonction pour r√©cup√©rer les donn√©es des inputs
function getData() {
    const inputs = document.querySelectorAll('input');
    const inputValues = [];

    inputs.forEach(input => {
        inputValues.push(input.value.trim());
    });

    return inputValues;
}

function isValidNumber(value) {
    // V√©rifie si la valeur est un nombre valide
    return !isNaN(value) && value !== null && value !== '';
}

function calculateBasis(inputValues){

    var beatsINX = inputValues[0].toLowerCase();;
    var shareBuyback = inputValues[1].toLowerCase();;
    var diversifiedCA = inputValues[2].toLowerCase();;

    if (beatsINX == 'oui'){
        totalScore += 2;
        basisScore += 2;
        resultCriteria[0] = 2;
    }
    else {
        resultCriteria[0] = 0;
    }

    if (shareBuyback == 'oui'){
        totalScore += 2;
        basisScore += 2;
        resultCriteria[1] = 2;
    }
    else {
        resultCriteria[1] = 0;
    }

    if (diversifiedCA == 'oui'){
        totalScore += 2;
        basisScore += 2;
        resultCriteria[2] = 2; 
    }
    else {
        resultCriteria[2] = 0;
    }

    return basisScore;
}

function calculateGrowth(inputValues){
    var CAGrowth = inputValues[3];
    var EPSGrowth = inputValues[4];
    var FCFGrowth = inputValues[5];

    if (CAGrowth > 7){
        totalScore += 2;
        growthScore += 2;
        resultCriteria[3] = 2;
    }
    else {
        resultCriteria[3] = 0;
    }

    if (EPSGrowth > 7){
        totalScore += 2;
        growthScore += 2;
        resultCriteria[4] = 2;
    }
    else {
        resultCriteria[4] = 0;
    }

    if (FCFGrowth > 7){
        totalScore += 2;
        growthScore += 2;
        resultCriteria[5] = 2;
    }
    else {
        resultCriteria[5] = 0;
    }

    return growthScore;
}

function calculateProfitability(inputValues){
    var netMargin = inputValues[6];
    var fcfMargin = inputValues[7];
    var roic = inputValues[8];

    if (netMargin >= 35) {
        totalScore += 2;
        profitabilityScore += 2;
        resultCriteria[6] = 2;
    } else if (netMargin >= 20) {
        totalScore += 1;
        profitabilityScore += 1;
        resultCriteria[6] = 1;
    } else {
        totalScore += 0;
        profitabilityScore += 0;
        resultCriteria[6] = 0;
    }

    if (fcfMargin >= 35) {
        totalScore += 2;
        profitabilityScore += 2;
        resultCriteria[7] = 2;
    } else if (fcfMargin >= 20) {
        totalScore += 1;
        profitabilityScore += 1;
        resultCriteria[7] = 1;
    } else {
        totalScore += 0;
        profitabilityScore += 0;
        resultCriteria[7] = 0;
    }

    if (roic >= 30) {
        totalScore += 2;
        profitabilityScore += 2;
        resultCriteria[8] = 2;
    } else if (roic >= 15) {
        totalScore += 1;
        profitabilityScore += 1;
        resultCriteria[8] = 1;
    } else {
        totalScore += 0;
        profitabilityScore += 0;
        resultCriteria[8] = 0;
    }

    return profitabilityScore;

}

function calculateSolvency(inputValues) {
    var debtToEBITDA = parseFloat(inputValues[9]);
    var debtToEquity = parseFloat(inputValues[10]);
    var interestCoverageRatio = parseFloat(inputValues[11]);

    // V√©rifie si les valeurs sont des nombres valides avant de les comparer
    if (isValidNumber(debtToEBITDA)) {
        if (debtToEBITDA < 1) {
            totalScore += 2;
            solvencyScore += 2;
            resultCriteria[9] = 2;
        } else if (debtToEBITDA < 2) {
            totalScore += 1;
            solvencyScore += 1;
            resultCriteria[9] = 1;
        }
        else {
            resultCriteria[9] = 0;
        }
    }
    else {
        resultCriteria[9] = 0;
    }

    if (isValidNumber(debtToEquity)) {
        if (debtToEquity < 1) {
            totalScore += 2;
            solvencyScore += 2;
            resultCriteria[10] = 2;
        } else if (debtToEquity < 2) {
            totalScore += 1;
            solvencyScore += 1;
            resultCriteria[10] = 1;
        }
        else {
            resultCriteria[10] = 0;
        }
    }
    else {
        resultCriteria[10] = 0;
    }

    if (isValidNumber(interestCoverageRatio)) {
        if (interestCoverageRatio >= 30) {
            totalScore += 2;
            solvencyScore += 2;
            resultCriteria[11] = 2;
        } else if (interestCoverageRatio >= 15) {
            totalScore += 1;
            solvencyScore += 1;
            resultCriteria[11] = 1;
        }
        else {
            resultCriteria[11] = 0;
        }
    }
    else {
        resultCriteria[11] = 0;
    }

    return solvencyScore;
}

function calculateDividend(inputValues) {
    var payoutRatio = parseFloat(inputValues[12]);
    var payoutRatioFCF = parseFloat(inputValues[13]);
    var dividendGrowth = parseFloat(inputValues[14]);

    // V√©rifie si les valeurs sont des nombres valides avant de les comparer
    if (isValidNumber(payoutRatio)) {
        if (payoutRatio < 30) {
            totalScore += 2;
            dividendScore += 2;
            resultCriteria[12] = 2;
        } else if (payoutRatio < 50) {
            totalScore += 1;
            dividendScore += 1;
            resultCriteria[12] = 1;
        }
        else {
            resultCriteria[12] = 0;
        }
    }
    else {
        resultCriteria[12] = 0;
    }

    if (isValidNumber(payoutRatioFCF)) {
        if (payoutRatioFCF < 30) {
            totalScore += 2;
            dividendScore += 2;
            resultCriteria[13] = 2;
        } else if (payoutRatioFCF < 50) {
            totalScore += 1;
            dividendScore += 1;
            resultCriteria[13] = 1;
        }
        else {
            resultCriteria[13] = 0;
        }
    }
    else {
        resultCriteria[13] = 0;
    }

    if (isValidNumber(dividendGrowth)) {
        if (dividendGrowth >= 10) {
            totalScore += 2;
            dividendScore += 2;
            resultCriteria[14] = 2;
        } else if (dividendGrowth >= 5) {
            totalScore += 1;
            dividendScore += 1;
            resultCriteria[14] = 1;
        }
        else {
            resultCriteria[14] = 0;
        }
    }
    else {
        resultCriteria[14] = 0;
    }

    return dividendScore;
}

function createRadarChart(sectionScores) {
    // Si le graphique radar existe d√©j√†, on met √† jour ses donn√©es
    if (radarChartInstance) {
        radarChartInstance.data.datasets[0].data = sectionScores;
        radarChartInstance.update(); // Mise √† jour des donn√©es du graphique existant
    } else {
        const ctx = document.getElementById('radarChart').getContext('2d');

        radarChartInstance = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: sectionName,
                datasets: [{
                    label: 'Score par Section',
                    data: sectionScores,
                    backgroundColor: 'rgba(53, 162, 235, 0.2)', // Couleur de fond des zones
                    borderColor: 'rgba(53, 162, 235, 1)', // Couleur de la bordure
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,  // Rendre le graphique responsive
                plugins: {
                    legend: {
                        display: false  // Cacher la l√©gende
                    },
                    title: {
                    display: true,
                    text: "ScoreCard de l'Action",
                    font: {
                        size: 16
                    }
                }
                },
                scales: {
                    r: {  // Utilisation de 'r' pour l'axe radar
                        min: 0,  // Minimum de l'√©chelle
                        max: 6,  // Maximum de l'√©chelle
                        ticks: {
                            stepSize: 1  // Les intervalles entre chaque tick (chaque unit√©)
                        }
                    },
                },
                elements: {
                    line: {
                        tension: 0 // Cr√©e des lignes l√©g√®rement courb√©es
                    }
                }
            }
        });
    }
}

function createFairPriceChart(currentStockPrice,fairPrice) {

    if (priceChartInstance) {
        // Met √† jour les donn√©es du graphique existant
        priceChartInstance.data.labels = currentTicker; // Met √† jour les labels
        priceChartInstance.data.datasets[0].data = currentStockPrice; // Prix actuel
        priceChartInstance.data.datasets[1].data = fairPrice; // Prix juste
        priceChartInstance.data.datasets[2].data = gurufocusPrice; // Prix GuruFocus
        priceChartInstance.data.datasets[3].data = tipsrankPrice; // Prix TipsRank

        priceChartInstance.update(); // Met √† jour le graphique avec les nouvelles
    }    

    const ctx = document.getElementById('priceChart').getContext('2d');

    priceChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: currentTicker,
            datasets: [
                {
                    label: "Prix Actuel de l'action",
                    type: 'bar', // Barres pour le prix actuel
                    data: currentStockPrice,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                },
                {
                    label: "Prix Juste de l'action",
                    type: 'bar', // Ligne pour le prix juste
                    data: fairPrice,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                },
                {
                label: "Prix GuruFocus",
                    type: 'line', // Ligne pour GuruFocus
                    data: gurufocusPrice,
                    borderColor: 'rgba(75, 192, 192, 1)', // Vert-bleu
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(75, 192, 192, 1)', // Couleur des points
                    fill: false, // Pas de remplissage sous la ligne
                    tension: 0.2 // Douceur de la courbe
                },
                {
                    label: "Prix TipsRank",
                    type: 'line', // Ligne pour TipsRank
                    data: tipsrankPrice,
                    borderColor: 'rgba(255, 159, 64, 1)', // Orange vif
                    borderWidth:2,
                    backgroundColor: 'rgba(255, 159, 64, 0.2)', // Couleur de remplissage sous la ligne
                    fill: false, // Pas de remplissage sous la ligne
                    tension: 0.2 // Douceur de la courbe
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true, // Affiche la l√©gende
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: "Prix actuel de l'action vs son prix juste",
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true // Commence l'axe Y √† 0
                }
            }
        }
    });
}


// Cl√© API Finnhub
const FINNHUB_API_KEY = 'cfeip41r01qoicaf4hk0cfeip41r01qoicaf4hkg';

async function getStockPrice(symbol) {
    try {
        const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${FINNHUB_API_KEY}`);
        const data = await response.json();

        if (data.c) {
            return data.c;
        }
        console.error(`Erreur: Impossible de r√©cup√©rer le prix pour ${symbol}`);
        return null;
    } catch (error) {
        console.error('Erreur lors de la r√©cup√©ration du prix:', error);
        return null;
    }
}

async function getPERatio(symbol) {
    try {
        const response = await fetch(`https://finnhub.io/api/v1/stock/metric?symbol=${symbol}&metric=valuation&token=${FINNHUB_API_KEY}`);
        const data = await response.json();

        if (data.metric?.peNormalizedAnnual) {
            return parseFloat(data.metric.peNormalizedAnnual.toFixed(2));
        }
        console.error(`Erreur: Impossible de r√©cup√©rer le P/E pour ${symbol}`);
        return null;
    } catch (error) {
        console.error('Erreur lors de la r√©cup√©ration du P/E:', error);
        return null;
    }
}

// Gestion de la saisie du ticker
document.getElementById('stockTicker').addEventListener('keypress', async function(e) {
    if (e.key === 'Enter') {
        const ticker = this.value.trim().toUpperCase();
        if (ticker) {
            currentTicker = ticker;
            console.log('Ticker saisi:', ticker);
            
            // Afficher un indicateur de chargement
            this.placeholder = 'Chargement...';
            
            try {
                // R√©cup√©rer les donn√©es en parall√®le
                const [price, peRatio] = await Promise.all([
                    getStockPrice(ticker),
                    getPERatio(ticker)
                ]);

                console.log(`Prix actuel de l'action : ${currentStockPrice}`);
                
                // Stocker les valeurs dans les variables globales
                currentStockPrice = price;
                currentPERatio = peRatio;
                currentTicker = ticker;
                
                // Mettre √† jour le placeholder pour indiquer que le ticker est charg√©
                this.placeholder = `${ticker} charg√© (${price}$)`;
                
                
            } catch (error) {
                console.error('Erreur lors de la r√©cup√©ration des donn√©es:', error);
                alert('Une erreur est survenue lors de la r√©cup√©ration des donn√©es.');
            } finally {
                // R√©initialiser le placeholder si n√©cessaire
                if (!currentStockPrice) {
                    this.placeholder = 'Entrez le ticker (ex: AAPL)';
                }
            }
        }
    }
});
        
function getFairPrice(currentPrice, gurufocusPrice, tipsrankPrice,safetyMargin) {
    const averagePrice = (gurufocusPrice + tipsrankPrice) / 2;
    fairPrice = averagePrice * (1 - safetyMargin);
    console.log(`Prix juste pour ${currentTicker}:`, fairPrice);
    return fairPrice;
}


function main() {

    

    //attendre cliquage du bouton
    document.querySelector('.calculator-button').addEventListener('click', function () {
        
        //on r√©initialise √† 0
        totalScore = 0;
        totalScore = 0;
        basisScore = 0;
        growthScore = 0;
        profitabilityScore = 0;
        solvencyScore = 0;
        dividendScore = 0;

        // R√©cup√©rer les donn√©es des inputs
        const inputValues = getData();

        // Calculer les scores en fonction des donn√©es des inputs
        calculateBasis(inputValues);
        calculateGrowth(inputValues);
        calculateProfitability(inputValues);
        calculateSolvency(inputValues);
        calculateDividend(inputValues);

        // Calculer le prix juste
        getFairPrice(currentStockPrice, gurufocusPrice, tipsrankPrice, safetyMargin);
        
        var sectionScores = [basisScore,growthScore,profitabilityScore,solvencyScore,dividendScore];

        // R√©v√®le le conteneur du cercle
        const progressContainer = document.getElementById('progress-container-circle');
        progressContainer.style.display = 'block';

        // Met √† jour le cercle de progression avec le nouveau score
        const circleProgress = document.getElementById('circular-progress');
        circleProgress.setAttribute('value', totalScore); // Score actuel
        circleProgress.setAttribute('animation-duration', '3000');
        
        // Faire une transition fluide vers le cercle de progression
        setTimeout(() => {
            progressContainer.scrollIntoView({
                behavior: 'smooth'
            });
        }, 100); // Attendre un court instant pour √™tre s√ªr que l'affichage est mis √† jour

        const scoreText = document.getElementById('score-text');
        scoreText.textContent = `Le score de Qualit√© de votre action est de ${totalScore} sur 30 !`;

        const radarChartContainer = document.getElementById('radar-chart-container');
        radarChartContainer.style.display = 'flex';
        createRadarChart(sectionScores);
        
        const priceChartContainer = document.getElementById('bar-chart-container');
        priceChartContainer.style.display = 'flex';
        createFairPriceChart(currentStockPrice,fairPrice);


        


    });


}


main();

    </script>

</body>
</html>